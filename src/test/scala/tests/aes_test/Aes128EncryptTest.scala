// Copyright 2020 Anish Singhani
//
// SPDX-License-Identifier: Apache-2.0
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     https://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
package tests.aes_test

import aes.{AesCombined, AesEncrypt}
import chisel3.iotesters.PeekPokeTester
import sha256.Sha256Accel

import scala.util.Random
import scala.util.control.Breaks.{break, breakable}

class Aes128EncryptTest(dut: AesCombined) extends PeekPokeTester(dut) {

    def setKey(key: BigInt): Unit = {
        while(peek(dut.io.encReady) == 0) step(1)

        poke(dut.io.encDataValid, false)
        poke(dut.io.keyValid, false)
        expect(dut.io.encReady, true)

        poke(dut.io.keyIn, key)
        poke(dut.io.keyValid, true)
        step(1)
        poke(dut.io.keyIn, 0)
        poke(dut.io.keyValid, false)

        while(peek(dut.io.encReady) == 0) step(1)
    }

    def runTest(plaintext: BigInt, ciphertext: BigInt, iv: BigInt = BigInt(0)): Unit = {
        poke(dut.io.encIvIn, iv)
        poke(dut.io.encDataIn, plaintext)
        poke(dut.io.encDataValid, true)
        step(1)
        poke(dut.io.encDataIn, 0)
        poke(dut.io.encDataValid, false)

        expect(dut.io.encReady, false)

        while(peek(dut.io.encOutputValid) == 0) step(1)

        expect(dut.io.encDataOut, ciphertext)
        expect(dut.io.encIvOut, ciphertext)
    }

    poke(dut.io.aes256, false)
    poke(dut.io.keyValid, false)
    poke(dut.io.keyShift, false)
    poke(dut.io.encDataValid, false)
    poke(dut.io.decDataValid, false)

    setKey(BigInt("129445976579865719297921356551604413220"))
    runTest(BigInt("138766332635719238849554048983485396278"), BigInt("30614575354952859734368363414031006605"))

    setKey(BigInt("114849718896073566083416993308083054187"))
    runTest(BigInt("54758945827980741386470298169332301409"), BigInt("289445855507223381064146989315641296578"))
    runTest(BigInt("54758945827980741386470298169332301409"), BigInt("63241459423936053969797744104158954336"), iv=BigInt("94605682877008349257125771496548550738"))
    runTest(BigInt("63009363580684677640861982505439019373"), BigInt("307084774739159377437930299938971018023"))
    runTest(BigInt("63009363580684677640861982505439019373"), BigInt("121285145432821926259489755756437457204"), iv=BigInt("60013523246785301651415126051136829294"))
    runTest(BigInt("65558960394507562676116818757822741623"), BigInt("263688908005839110432491559432072638113"))
    runTest(BigInt("65558960394507562676116818757822741623"), BigInt("292458752579585649052525818149840375761"), iv=BigInt("149077117949227956397498265561073205290"))
    runTest(BigInt("63036415400463229995541035617174648702"), BigInt("16295005142645389383086784455485558759"))
    runTest(BigInt("63036415400463229995541035617174648702"), BigInt("93669816153615164512395952751800033039"), iv=BigInt("146673491003412119423160181958932249174"))
    runTest(BigInt("115893530272870037403253388774378124663"), BigInt("78307793813593636465505717142472701120"))
    runTest(BigInt("115893530272870037403253388774378124663"), BigInt("57873011419295910906973876109488840100"), iv=BigInt("137369721399049440708519569169693105014"))
    runTest(BigInt("74885239361085007638178609790930468671"), BigInt("278131917818815872483937984457317959494"))
    runTest(BigInt("74885239361085007638178609790930468671"), BigInt("311368125752202963993246456614958734547"), iv=BigInt("44406274741320136577355402206418977136"))
    runTest(BigInt("128059330284264555516976583467700727859"), BigInt("255713931439712555356268428614113493553"))
    runTest(BigInt("128059330284264555516976583467700727859"), BigInt("18061530258208880058015395462138920157"), iv=BigInt("105177264018733420109340008042707890023"))
    runTest(BigInt("91894982425384513464560866790118930277"), BigInt("226721071789772648829417960070004902270"))
    runTest(BigInt("91894982425384513464560866790118930277"), BigInt("312299458229100604829357361833912669191"), iv=BigInt("103909547893119949727157940596638836083"))
    runTest(BigInt("143823083554295233553712770931659778670"), BigInt("279042500898354141763089714981182998954"))
    runTest(BigInt("143823083554295233553712770931659778670"), BigInt("324972730258358763675490376643286932230"), iv=BigInt("89459874180124671017484013183434317612"))
    runTest(BigInt("162811246138409284816498799940274761829"), BigInt("42222800082732283618955268195002743790"))
    runTest(BigInt("162811246138409284816498799940274761829"), BigInt("77131328890983426372738961978491418639"), iv=BigInt("153246795423957082397098253318296122919"))
    setKey(BigInt("150375537023698276332429336253045492317"))
    runTest(BigInt("131917632380324906031364144786648675141"), BigInt("170292759109317841066097274944938321159"))
    runTest(BigInt("131917632380324906031364144786648675141"), BigInt("112167255100654352863238945935189571860"), iv=BigInt("62922733827283287692655060117120896301"))
    runTest(BigInt("94911458986576837840656542655062876716"), BigInt("247187020939281202376911763142781568588"))
    runTest(BigInt("94911458986576837840656542655062876716"), BigInt("122997894445739937552041976368816786321"), iv=BigInt("158413066331821386130257589808800150065"))
    runTest(BigInt("121142802401266718723148881335230750041"), BigInt("169085546614119189002056208543197677228"))
    runTest(BigInt("121142802401266718723148881335230750041"), BigInt("224132732134121775206571892445081942405"), iv=BigInt("153085489591529054920480194021576703289"))
    runTest(BigInt("155774774603344437617973070833834544729"), BigInt("139081820949474834856950572204895069203"))
    runTest(BigInt("155774774603344437617973070833834544729"), BigInt("187536718819203153736713879645950097692"), iv=BigInt("62906773554088312450755547371957417844"))
    runTest(BigInt("112259453374852286972239969208098642792"), BigInt("293849242638205620275945183550881642669"))
    runTest(BigInt("112259453374852286972239969208098642792"), BigInt("320569232568461075436430857594428437574"), iv=BigInt("112046306257151104069285832733281444955"))
    runTest(BigInt("56347662475028556581909598444035195706"), BigInt("65188326630462532214664894890352521388"))
    runTest(BigInt("56347662475028556581909598444035195706"), BigInt("144131154779794123663846241833505248646"), iv=BigInt("63992409257720499593732520136147815805"))
    runTest(BigInt("54950875812352572363673249878716336462"), BigInt("115569122748205408158709250424564840907"))
    runTest(BigInt("54950875812352572363673249878716336462"), BigInt("313498321229282317040064004915093796287"), iv=BigInt("90752411386687238677939013411353601101"))
    runTest(BigInt("101257117924681795934224680735287290493"), BigInt("299233668630045139033450637074303152567"))
    runTest(BigInt("101257117924681795934224680735287290493"), BigInt("105360146491707757847230682101494695387"), iv=BigInt("121512226625689582582634193326050075515"))
    runTest(BigInt("97648675063137130282423473273397406544"), BigInt("139798511823658863754062988372416305034"))
    runTest(BigInt("97648675063137130282423473273397406544"), BigInt("61651760464561346265927770823637320996"), iv=BigInt("167671708355577768017991528907965754151"))
    runTest(BigInt("94822581071567543835688068651079265620"), BigInt("57717491230236807714012292601954036538"))
    runTest(BigInt("94822581071567543835688068651079265620"), BigInt("9469776572634117428403465667251787712"), iv=BigInt("75985034862426792577288679340978107505"))
    setKey(BigInt("75077192073141450471139287546387379758"))
    runTest(BigInt("86723940019308063397066404979038646108"), BigInt("271863373610084661747062635679610536984"))
    runTest(BigInt("86723940019308063397066404979038646108"), BigInt("338418550890773069045085052764399749957"), iv=BigInt("70730244661120701929044827882263103580"))
    runTest(BigInt("94559033346039526895361716370833941076"), BigInt("211135283079234738221329551242530770542"))
    runTest(BigInt("94559033346039526895361716370833941076"), BigInt("140748058233075897473467838892247573540"), iv=BigInt("56197555354044598155386660176433657919"))
    runTest(BigInt("61733351320594316474785351783609301111"), BigInt("19312815967531353490924332227315911686"))
    runTest(BigInt("61733351320594316474785351783609301111"), BigInt("65759304779084216496848929614811355487"), iv=BigInt("137208622971392958681057005430507126309"))
    runTest(BigInt("136179291462022793018743273672086549598"), BigInt("129991418332923599179821458080402688929"))
    runTest(BigInt("136179291462022793018743273672086549598"), BigInt("226425234268540606531120302267951028547"), iv=BigInt("56073403880085415315484855231933456432"))
    runTest(BigInt("44369521327139901195294319751204910155"), BigInt("151265744604435864916013947652033377993"))
    runTest(BigInt("44369521327139901195294319751204910155"), BigInt("313703041520543152001655832526718294040"), iv=BigInt("118666830032415306224386720092910155611"))
    runTest(BigInt("154773793653685375405755126480078971230"), BigInt("265205493287784193917729467286794820991"))
    runTest(BigInt("154773793653685375405755126480078971230"), BigInt("220165467483891490111133637107714978492"), iv=BigInt("56051660887803015003882283248326683746"))
    runTest(BigInt("68321159158875178900681812703835353456"), BigInt("99745649016848784874449477591374203399"))
    runTest(BigInt("68321159158875178900681812703835353456"), BigInt("151455374259523443462904894601583660551"), iv=BigInt("109288462028855763759570454107561476985"))
    runTest(BigInt("61629646241222861018668998236924224563"), BigInt("184911291737299005647224058580208475164"))
    runTest(BigInt("61629646241222861018668998236924224563"), BigInt("132949170783190929759204870807840918298"), iv=BigInt("46706116006215560184391359985203763284"))
    runTest(BigInt("96324107670472738687200504521008175689"), BigInt("124919619107039677279719129514877450604"))
    runTest(BigInt("96324107670472738687200504521008175689"), BigInt("159607119750275123760085197403810535113"), iv=BigInt("75067195222030002163844677874552810277"))
    runTest(BigInt("138422543255374081067805584686065875544"), BigInt("198963095458980071098689716983372967546"))
    runTest(BigInt("138422543255374081067805584686065875544"), BigInt("81646713544491491652316583595564601302"), iv=BigInt("82881051669412068718217661622094870138"))
    setKey(BigInt("52043067346729826521811211907861075017"))
    runTest(BigInt("105644766749862872588828738772990909773"), BigInt("179086695170187973060942383725777284673"))
    runTest(BigInt("105644766749862872588828738772990909773"), BigInt("16537257872184348805630966777050793024"), iv=BigInt("155915941132660933510245226962397963617"))
    runTest(BigInt("67075881954434244466111157871100787747"), BigInt("149052965627728194765512571136254688932"))
    runTest(BigInt("67075881954434244466111157871100787747"), BigInt("295380550482792116818696352615885420707"), iv=BigInt("44473795731839809249343149707265915742"))
    runTest(BigInt("97632122010722489081555962258729036923"), BigInt("164904470545547448311236040900408105352"))
    runTest(BigInt("97632122010722489081555962258729036923"), BigInt("142892718513370804434877244800403341797"), iv=BigInt("157483952891866604535985138818544721978"))
    runTest(BigInt("96297218976892843200706072443294285354"), BigInt("240063892006345963022062997828984707841"))
    runTest(BigInt("96297218976892843200706072443294285354"), BigInt("248028794481108843578542851582640669303"), iv=BigInt("78903367568287106915321517763065118040"))
    runTest(BigInt("114932978748224306887671123231372688955"), BigInt("239891667906234038200252194413283620440"))
    runTest(BigInt("114932978748224306887671123231372688955"), BigInt("290785974419681308445590372007020580307"), iv=BigInt("160095759047671885666966906908651250528"))
    runTest(BigInt("104320285237419782670791175069483156862"), BigInt("316380428303623217933246520078794612619"))
    runTest(BigInt("104320285237419782670791175069483156862"), BigInt("262438929974292374310147850456399063187"), iv=BigInt("73632998938590213645943713762260108401"))
    runTest(BigInt("105291347817480445792588315852479822130"), BigInt("131787141614612842463075274656764232070"))
    runTest(BigInt("105291347817480445792588315852479822130"), BigInt("220878027419271809974849976171908546473"), iv=BigInt("141283501589733281545889470601737495109"))
    runTest(BigInt("125410913042801679323365774772481960485"), BigInt("305055988983700000457011981372583152132"))
    runTest(BigInt("125410913042801679323365774772481960485"), BigInt("23366205020582496613410934573770015709"), iv=BigInt("102726540633097823417416596294796067440"))
    runTest(BigInt("148002289910274228365321013951634501689"), BigInt("99045787161214144812054673918387553669"))
    runTest(BigInt("148002289910274228365321013951634501689"), BigInt("223653776749024648758246896332295950721"), iv=BigInt("77476539260749405843584334370385975152"))
    runTest(BigInt("138666273786430233215497454954600626483"), BigInt("199697335788033082778349603643747764218"))
    runTest(BigInt("138666273786430233215497454954600626483"), BigInt("260864632348503482009173171766682595007"), iv=BigInt("159737631427444679564584185658779792682"))
    setKey(BigInt("137296969653456059804961651722017006964"))
    runTest(BigInt("52100326088784669781917981148238914937"), BigInt("136189182276794235108589834639614585751"))
    runTest(BigInt("52100326088784669781917981148238914937"), BigInt("153165168379076655710531832717902847591"), iv=BigInt("62995347089353693964380477395564832361"))
    runTest(BigInt("73369309398080928337661956417784339035"), BigInt("221969221820149081272316335032109181570"))
    runTest(BigInt("73369309398080928337661956417784339035"), BigInt("305842852456671801667171840825482788043"), iv=BigInt("149430980383234320222802842635753192565"))
    runTest(BigInt("64423125401433518571239049291466825801"), BigInt("232949595804493890665067861467920067336"))
    runTest(BigInt("64423125401433518571239049291466825801"), BigInt("334215675834066335268359444459524704574"), iv=BigInt("127830721062060304974299058588957179437"))
    runTest(BigInt("141449574345539509169973914853209100109"), BigInt("313780915694482792622079796633055299196"))
    runTest(BigInt("141449574345539509169973914853209100109"), BigInt("187818954470299803521783614039791797816"), iv=BigInt("106994990525265381842071829671001942388"))
    runTest(BigInt("65362442456005217833003411063938832481"), BigInt("3416494887697969098734882671491337008"))
    runTest(BigInt("65362442456005217833003411063938832481"), BigInt("96813608544479078069097590345948328706"), iv=BigInt("66962283512411800100937141991515255915"))
    runTest(BigInt("137509203273606027508833359686972685140"), BigInt("182093913304591860736149231247282092014"))
    runTest(BigInt("137509203273606027508833359686972685140"), BigInt("122949253086467852721297905510470867806"), iv=BigInt("42765834166592619736015906129319058025"))
    runTest(BigInt("97441038818066320757503238718620984115"), BigInt("106674712811633457369499667865428762227"))
    runTest(BigInt("97441038818066320757503238718620984115"), BigInt("89928961988013786794726349135430081946"), iv=BigInt("153045347771444060895807491901236732496"))
    runTest(BigInt("126506221550422470060666114398429276260"), BigInt("127302809102461821109826013573506053079"))
    runTest(BigInt("126506221550422470060666114398429276260"), BigInt("196864818779798521176365335934257841164"), iv=BigInt("69759206950159495176290517666355834466"))
    runTest(BigInt("77672730922450537721884914823597204342"), BigInt("58242657461705247643540668633843771810"))
    runTest(BigInt("77672730922450537721884914823597204342"), BigInt("129349153908090146795861465593009942115"), iv=BigInt("88270854687117847134953779132979634734"))
    runTest(BigInt("139867359907514219423487665637445281643"), BigInt("307218033422023005677979497608273708565"))
    runTest(BigInt("139867359907514219423487665637445281643"), BigInt("137236773295009862252582049698583381884"), iv=BigInt("138610845220411970829625405780918229293"))
    setKey(BigInt("118556977713159770430011055868944209955"))
    runTest(BigInt("42755039960169586870139531009950886510"), BigInt("62104998097134814687112627294329159288"))
    runTest(BigInt("42755039960169586870139531009950886510"), BigInt("55785048370103564705977425400803222069"), iv=BigInt("158414248571000928851691067312726821673"))
    runTest(BigInt("103925737466118831789259617901589583217"), BigInt("242538534750899411200391160319696155008"))
    runTest(BigInt("103925737466118831789259617901589583217"), BigInt("26664040479328258047616333366497016555"), iv=BigInt("45543628432376178419762587448771897181"))
    runTest(BigInt("48107957956095376195252697761034283312"), BigInt("201237563454176581052165856426859146670"))
    runTest(BigInt("48107957956095376195252697761034283312"), BigInt("222313801693165083873234525986160200173"), iv=BigInt("77450495787397637017743059851619085387"))
    runTest(BigInt("151984968185576281221645915486645071140"), BigInt("65542976918914053448696140411429808969"))
    runTest(BigInt("151984968185576281221645915486645071140"), BigInt("123356747727654911428710745273887892417"), iv=BigInt("118797058854874585040111615957565850177"))
    runTest(BigInt("89349739597621819994452472020861274476"), BigInt("74382591910079927095072060383018782814"))
    runTest(BigInt("89349739597621819994452472020861274476"), BigInt("24267843591789037954723515485376579799"), iv=BigInt("80052200396716011191484431606576996419"))
    runTest(BigInt("70944021748659120914186812439871645815"), BigInt("280098262171076340642940757121414291168"))
    runTest(BigInt("70944021748659120914186812439871645815"), BigInt("320917558399905633504246061429785864685"), iv=BigInt("106563258763023091672748806869700725855"))
    runTest(BigInt("98955551131972522517974904088735132027"), BigInt("235851582601734083854276837311544074134"))
    runTest(BigInt("98955551131972522517974904088735132027"), BigInt("278689502569254904586670593082422137373"), iv=BigInt("101382094024827244605593335734884579681"))
    runTest(BigInt("72288944587495486941983259800453398344"), BigInt("211293221096103359338422285306915607031"))
    runTest(BigInt("72288944587495486941983259800453398344"), BigInt("247652739775902516336320499588737070328"), iv=BigInt("80320498414086321518080001653682548313"))
    runTest(BigInt("65460306734637110742177602722417297233"), BigInt("131565652484860445099009298710384815044"))
    runTest(BigInt("65460306734637110742177602722417297233"), BigInt("115125559065507668964563677617042321973"), iv=BigInt("135869005145324888045638359976411948151"))
    runTest(BigInt("70896704846990912211783903892575181415"), BigInt("242240556012454415125725461384046528896"))
    runTest(BigInt("70896704846990912211783903892575181415"), BigInt("198083326836927138804493392591911952980"), iv=BigInt("53394383831050051913097921091615741265"))
    setKey(BigInt("111994015269031136592359828842080254068"))
    runTest(BigInt("146657078827959692372596569952670604335"), BigInt("308486197595366702835087491506253515850"))
    runTest(BigInt("146657078827959692372596569952670604335"), BigInt("98437577556889106124435891839595513815"), iv=BigInt("143775845200900591552622811287376962088"))
    runTest(BigInt("55080703223183421407022513996489971504"), BigInt("246123730723129563299236623825598070276"))
    runTest(BigInt("55080703223183421407022513996489971504"), BigInt("69566497606709050987871732963550689724"), iv=BigInt("113198848628549888178079623485078906954"))
    runTest(BigInt("90664712149722268428691982170953628500"), BigInt("253900476959412171761269748898634037224"))
    runTest(BigInt("90664712149722268428691982170953628500"), BigInt("56821157857729324814060793128371839933"), iv=BigInt("77642086282861212854626708794471686503"))
    runTest(BigInt("118474733895958769818867324513921497210"), BigInt("22529447966977729450869850686103198211"))
    runTest(BigInt("118474733895958769818867324513921497210"), BigInt("188935618806905203014876903670610155202"), iv=BigInt("85461375795935211149580289450020848710"))
    runTest(BigInt("83046940875501562582407989242623894080"), BigInt("262378166730248065198635370084478690319"))
    runTest(BigInt("83046940875501562582407989242623894080"), BigInt("8432130280037807510337570174414331787"), iv=BigInt("117561193882484014531329053138459245931"))
    runTest(BigInt("66763393087227360980921977276246812995"), BigInt("14513586706244427217085072070081793400"))
    runTest(BigInt("66763393087227360980921977276246812995"), BigInt("136300811786112692094170701838240618585"), iv=BigInt("96334228664671239254314653794738646853"))
    runTest(BigInt("133401979837743501488586213423924267637"), BigInt("197570711105380558319956788100301907615"))
    runTest(BigInt("133401979837743501488586213423924267637"), BigInt("156420612108814165051669438910636828254"), iv=BigInt("83981105874392200304788414557180228713"))
    runTest(BigInt("77480534652830493226410819197934326579"), BigInt("302091611418538227099164472972552211894"))
    runTest(BigInt("77480534652830493226410819197934326579"), BigInt("184014656366940511651728318766090311665"), iv=BigInt("60320585622222224217567269234639978288"))
    runTest(BigInt("57380725056817474135214440720040808290"), BigInt("277811159440043091464139761654627426633"))
    runTest(BigInt("57380725056817474135214440720040808290"), BigInt("70271046786765517376024987823141476095"), iv=BigInt("50840341369742101735484634761702550139"))
    runTest(BigInt("64319095565816915200461555537842040929"), BigInt("162433904302197721310322024268951781737"))
    runTest(BigInt("64319095565816915200461555537842040929"), BigInt("59339923311547660219146116110910699956"), iv=BigInt("160095616018831564766597517440107620986"))
    setKey(BigInt("65335509227691950755253342708080779326"))
    runTest(BigInt("72226034657482063194378654622694004596"), BigInt("18633994098734630257809055134561627699"))
    runTest(BigInt("72226034657482063194378654622694004596"), BigInt("185005907208054481731750516414958934414"), iv=BigInt("78788693034080562243872170385630967141"))
    runTest(BigInt("76110800477730581521940101764931929921"), BigInt("317352928810155578073031987713201390924"))
    runTest(BigInt("76110800477730581521940101764931929921"), BigInt("115651798177725055690340163606604348930"), iv=BigInt("91992985984949171134499929654884461925"))
    runTest(BigInt("92066184196946804087250374658333824637"), BigInt("323163915726333229714565528750106615407"))
    runTest(BigInt("92066184196946804087250374658333824637"), BigInt("314912789710035965799874685804391644070"), iv=BigInt("123926356977306398759735644858905943609"))
    runTest(BigInt("65356583701108751057018166573405382523"), BigInt("121520496704722700708175726843370175661"))
    runTest(BigInt("65356583701108751057018166573405382523"), BigInt("261297953101808993533077080933576062306"), iv=BigInt("109440544130634783151934707045766624566"))
    runTest(BigInt("53336269715191295173593655741019218224"), BigInt("222040194284886427156706301218250066733"))
    runTest(BigInt("53336269715191295173593655741019218224"), BigInt("12894920958361989477769111931126466920"), iv=BigInt("144005136343309628149662852999081523049"))
    runTest(BigInt("54920734176652338219690314357960684335"), BigInt("61511928506023179334485191227377204465"))
    runTest(BigInt("54920734176652338219690314357960684335"), BigInt("132607004118375258147699015687995599113"), iv=BigInt("104174926113821471576372533557017664624"))
    runTest(BigInt("158486413445734587853903741511524508508"), BigInt("132759537009905281428790941672864100118"))
    runTest(BigInt("158486413445734587853903741511524508508"), BigInt("334570560589369757520722911022207609175"), iv=BigInt("56239272391486465564546281606211199611"))
    runTest(BigInt("45455583925500959853109600483006955565"), BigInt("24689664526548759320921027574676297987"))
    runTest(BigInt("45455583925500959853109600483006955565"), BigInt("71674452348348530560273487044110825196"), iv=BigInt("122919316864171973935418943591877852729"))
    runTest(BigInt("85680425645983930467682080047028382334"), BigInt("69479349487605394382447049283821684221"))
    runTest(BigInt("85680425645983930467682080047028382334"), BigInt("2931865051942311599485186172093136745"), iv=BigInt("129434815946915721996441302007799952485"))
    runTest(BigInt("58720626417433707807053247923347276127"), BigInt("314971329074673246596482528794275843037"))
    runTest(BigInt("58720626417433707807053247923347276127"), BigInt("259932986941202031547596923091070264975"), iv=BigInt("133194667550736640128115182063836484698"))
    setKey(BigInt("86827075270622593409819524343863859761"))
    runTest(BigInt("58969592210743870063285156888865157723"), BigInt("34445959912195374720291194579163502738"))
    runTest(BigInt("58969592210743870063285156888865157723"), BigInt("69130398036106899280699320475117573951"), iv=BigInt("113297811504676015438898247227970508370"))
    runTest(BigInt("90965698820630213166994289669365519396"), BigInt("204326765483663107115405994780398329495"))
    runTest(BigInt("90965698820630213166994289669365519396"), BigInt("321541266545999478803201861322376605213"), iv=BigInt("128094702975275155929937112909655730225"))
    runTest(BigInt("74605240072561564204060370263150506580"), BigInt("114316182370891260659519907878684695684"))
    runTest(BigInt("74605240072561564204060370263150506580"), BigInt("129416346144803868019166907674914641037"), iv=BigInt("164031622486103800548796609917051485256"))
    runTest(BigInt("88234270445505063544773351946799499361"), BigInt("140819026982539376265949603485155741227"))
    runTest(BigInt("88234270445505063544773351946799499361"), BigInt("77632782935796824482769233326957714641"), iv=BigInt("154421366743392535228447486155557658462"))
    runTest(BigInt("44380334624219522542253740501960632661"), BigInt("288791642284250204713661254870252284592"))
    runTest(BigInt("44380334624219522542253740501960632661"), BigInt("316804242608174920769766559842210722072"), iv=BigInt("105457722456344753191157455023958534718"))
    runTest(BigInt("139995748177119672660211662608055747183"), BigInt("130035906473209420777267489690463285980"))
    runTest(BigInt("139995748177119672660211662608055747183"), BigInt("182331948215564093165882028255428454358"), iv=BigInt("79017840441416716113368962294071642964"))
    runTest(BigInt("49722757544526738644221644134196854879"), BigInt("92544765029102526621803542895474635053"))
    runTest(BigInt("49722757544526738644221644134196854879"), BigInt("323266700259871211996968417109190452543"), iv=BigInt("70923656147317493635232955284148475429"))
    runTest(BigInt("90555183315759195534198719963960793178"), BigInt("51227518762036690891411822881444235903"))
    runTest(BigInt("90555183315759195534198719963960793178"), BigInt("172129719962259346122394412644426318634"), iv=BigInt("54843380405372014107929802967280660325"))
    runTest(BigInt("64048871207477721583765611841108652908"), BigInt("270848234941166011063223421627685661043"))
    runTest(BigInt("64048871207477721583765611841108652908"), BigInt("315641162556587499119058310994474702631"), iv=BigInt("52121945375215471456261131422868724015"))
    runTest(BigInt("46949443533834829242817821549180321345"), BigInt("278978698474589186165084397859027925842"))
    runTest(BigInt("46949443533834829242817821549180321345"), BigInt("327439949334307999693273371630060955698"), iv=BigInt("48367227229216044282357240439047084118"))
    setKey(BigInt("145073710499889515903589391959220699715"))
    runTest(BigInt("118558114086105424063693440916297108806"), BigInt("222766975056746085558710973013271295757"))
    runTest(BigInt("118558114086105424063693440916297108806"), BigInt("52078724034952849958530049747220475935"), iv=BigInt("85587133704463767980526619383913868907"))
    runTest(BigInt("101205132835282183969052089563508077114"), BigInt("128363551350568186318909603982967642124"))
    runTest(BigInt("101205132835282183969052089563508077114"), BigInt("8183447390651277247852762455179559841"), iv=BigInt("48098222872682107829121686505805535325"))
    runTest(BigInt("116106966899812963825848681334617035369"), BigInt("6013778424976673419758654963537349487"))
    runTest(BigInt("116106966899812963825848681334617035369"), BigInt("64887112073690181376024549059090311328"), iv=BigInt("92096725522724656564618218217154619203"))
    runTest(BigInt("116100435249681158838289428360128592701"), BigInt("272774020786214218748131961458905996775"))
    runTest(BigInt("116100435249681158838289428360128592701"), BigInt("124048653057363919563270914853178509538"), iv=BigInt("119928291965217740601032504450291228719"))
    runTest(BigInt("82902350419730534914869321416170874488"), BigInt("30673710023723521543571791893727533619"))
    runTest(BigInt("82902350419730534914869321416170874488"), BigInt("153507428440932190115882450186970303575"), iv=BigInt("150650077426825027067962485045999839852"))
    runTest(BigInt("49526543760498454127656415991227039085"), BigInt("230773182515415264192381251920383614323"))
    runTest(BigInt("49526543760498454127656415991227039085"), BigInt("39629048708667529715152525111564446105"), iv=BigInt("160163667384592196205640250503507884153"))
    runTest(BigInt("161382431126769941799710483810157821559"), BigInt("207009268736714707804890037218375941490"))
    runTest(BigInt("161382431126769941799710483810157821559"), BigInt("16566468028243249000361720605538088778"), iv=BigInt("140026514137366742681009856404946890295"))
    runTest(BigInt("66889284965837463591075609439180445986"), BigInt("36676335155222094588048373007685381439"))
    runTest(BigInt("66889284965837463591075609439180445986"), BigInt("13409057115595487548819884135245807929"), iv=BigInt("154488525658936537837706605038640053100"))
    runTest(BigInt("130831368252686802948992976561958058580"), BigInt("117837775701166844826421225832727675189"))
    runTest(BigInt("130831368252686802948992976561958058580"), BigInt("211753058416579184094207760022265766269"), iv=BigInt("138408263804049034615517341636609921143"))
    runTest(BigInt("52397664623499573511462614000227086910"), BigInt("247268737662119261364321410779108028625"))
    runTest(BigInt("52397664623499573511462614000227086910"), BigInt("31648102336010827272570357957627325398"), iv=BigInt("149321988335800431316839071525097121624"))

}