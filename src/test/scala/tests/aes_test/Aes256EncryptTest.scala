// Copyright 2020 Anish Singhani
//
// SPDX-License-Identifier: Apache-2.0
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     https://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
package tests.aes_test

import aes.AesCombined
import chisel3.iotesters.PeekPokeTester

class Aes256EncryptTest(dut: AesCombined) extends PeekPokeTester(dut) {

    def setTopKey(key: BigInt): Unit = {
        while(peek(dut.io.decReady) == 0) step(1)

        poke(dut.io.decDataValid, false)
        poke(dut.io.keyShift, false)
        expect(dut.io.decReady, true)

        poke(dut.io.keyIn, key)
        poke(dut.io.keyShift, true)
        step(1)
        poke(dut.io.keyIn, 0)
        poke(dut.io.keyShift, false)

        while(peek(dut.io.decReady) == 0) step(1)
    }

    def setKey(key: BigInt): Unit = {
        while(peek(dut.io.decReady) == 0) step(1)

        poke(dut.io.decDataValid, false)
        poke(dut.io.keyValid, false)
        expect(dut.io.decReady, true)

        poke(dut.io.keyIn, key)
        poke(dut.io.keyValid, true)
        step(1)
        poke(dut.io.keyIn, 0)
        poke(dut.io.keyValid, false)

        while(peek(dut.io.decReady) == 0) step(1)
    }

    def runTest(plaintext: BigInt, ciphertext: BigInt, iv: BigInt = BigInt(0)): Unit = {
        poke(dut.io.encIvIn, iv)
        poke(dut.io.encDataIn, plaintext)
        poke(dut.io.encDataValid, true)
        step(1)
        poke(dut.io.encDataIn, 0)
        poke(dut.io.encDataValid, false)

        expect(dut.io.encReady, false)

        while(peek(dut.io.encOutputValid) == 0) step(1)

        expect(dut.io.encDataOut, ciphertext)
        expect(dut.io.encIvOut, ciphertext)
    }

    poke(dut.io.aes256, true)
    poke(dut.io.keyValid, false)
    poke(dut.io.keyShift, false)
    poke(dut.io.encDataValid, false)
    poke(dut.io.decDataValid, false)

    setTopKey(BigInt("129445976579865719297921356551604413220"))
    setKey(BigInt("162796526750907890493247941453607545396"))
    runTest(BigInt("138766332635719238849554048983485396278"), BigInt("59925632134564593020758952134513872930"))
    runTest(BigInt("138766332635719238849554048983485396278"), BigInt("59925632134564593020758952134513872930"))
    runTest(BigInt("138766332635719238849554048983485396278"), BigInt("59925632134564593020758952134513872930"))

    setTopKey(BigInt("155942060440058053758819739426757301582"))
    setKey(BigInt("93245118018952436165071229728695337033"))
    runTest(BigInt("100150689033302723460115453035444853817"), BigInt("271343258084288310804823707461290630315"))
    runTest(BigInt("100150689033302723460115453035444853817"), BigInt("16373763419191918968464602156142265800"), iv=BigInt("81464506251740002623659650424106138424"))
    runTest(BigInt("121173858584392189351055999811689669920"), BigInt("145060896124891378618441686816738281622"))
    runTest(BigInt("121173858584392189351055999811689669920"), BigInt("42552230783367846769346951610622773468"), iv=BigInt("74702898509361630447363215795339482712"))
    runTest(BigInt("91968238836576059696228196335285007469"), BigInt("10705309747165143802354981056804168043"))
    runTest(BigInt("91968238836576059696228196335285007469"), BigInt("141698518591601429063262008504826221872"), iv=BigInt("150786149657944740718808817843406725411"))
    runTest(BigInt("68254753050702216133854393611911508856"), BigInt("8705355456815839109375335677222279216"))
    runTest(BigInt("68254753050702216133854393611911508856"), BigInt("330157131119761651014720223753632860930"), iv=BigInt("157452253705629389116969273073007621938"))
    runTest(BigInt("45578941534186746759899815851849165904"), BigInt("62204245473522414802671628309911281973"))
    runTest(BigInt("45578941534186746759899815851849165904"), BigInt("33355387093086476462461192953296008490"), iv=BigInt("56447510787614060499921002608183685193"))
    runTest(BigInt("53731050581302453749591680539349900124"), BigInt("82129049062603697197391954833556139398"))
    runTest(BigInt("53731050581302453749591680539349900124"), BigInt("168192912685356868035680281912077814940"), iv=BigInt("93338115077635061162666715977952160616"))
    runTest(BigInt("89246036177135309689901015255610714923"), BigInt("257869467788644996387096846976507336822"))
    runTest(BigInt("89246036177135309689901015255610714923"), BigInt("167291952206917983972536119918601383697"), iv=BigInt("137306300912228239472286003525930744870"))
    runTest(BigInt("60091757649000293501196932139058419540"), BigInt("316816701055377709326283820349136711550"))
    runTest(BigInt("60091757649000293501196932139058419540"), BigInt("112949786009953091144699837610549912635"), iv=BigInt("121351387575947511075278404760606814047"))
    runTest(BigInt("94713561792251246156736050723346078759"), BigInt("202964998745206190334157041141013420213"))
    runTest(BigInt("94713561792251246156736050723346078759"), BigInt("31427092648600967949440529522389908575"), iv=BigInt("82757004477111994721532094677924916259"))
    runTest(BigInt("150801119995433719251698717743788621392"), BigInt("72720597702865736524847807730788148173"))
    runTest(BigInt("150801119995433719251698717743788621392"), BigInt("19593596337821083051706254029881222868"), iv=BigInt("104003215881176645242417474420967681081"))
    setTopKey(BigInt("78717008107243445104419149364645943634"))
    setKey(BigInt("133314603876022187002233588217563281953"))
    runTest(BigInt("112150883302818191150768721841524734500"), BigInt("11932630615126449964700271908126599987"))
    runTest(BigInt("112150883302818191150768721841524734500"), BigInt("29106053094344884533142578347654931153"), iv=BigInt("164021340594075855767317399524966486305"))
    runTest(BigInt("161030900215738957103885371041987439154"), BigInt("198789327208968123245936749628877602769"))
    runTest(BigInt("161030900215738957103885371041987439154"), BigInt("189098953514948611872354627633718081454"), iv=BigInt("115888443676515740582412306783928134780"))
    runTest(BigInt("73379064122064470749046137909574971189"), BigInt("89553784124285708245157188038388167328"))
    runTest(BigInt("73379064122064470749046137909574971189"), BigInt("169063085192838142153901448425504005200"), iv=BigInt("45792714483261802448459978324885000514"))
    runTest(BigInt("124046253045653159187995872937397600058"), BigInt("320602201871773459987242200868682374303"))
    runTest(BigInt("124046253045653159187995872937397600058"), BigInt("284129854837285816047638929597717535601"), iv=BigInt("76011582171576216472119950109224549187"))
    runTest(BigInt("60378144862439706987713495251652257088"), BigInt("648422736438128080534247891377869884"))
    runTest(BigInt("60378144862439706987713495251652257088"), BigInt("213209460072725136335235180049177465652"), iv=BigInt("126677991619449226707753737620385327652"))
    runTest(BigInt("54956996830151171937586253955228987469"), BigInt("269875004059367417179141752427087856402"))
    runTest(BigInt("54956996830151171937586253955228987469"), BigInt("286028882336785996125531394922246698721"), iv=BigInt("78598362819144978737892129770331521339"))
    runTest(BigInt("82693517045238065835388287077118205749"), BigInt("156207796549532399729182464357408290111"))
    runTest(BigInt("82693517045238065835388287077118205749"), BigInt("277218192851361046478154683610897904569"), iv=BigInt("129139991086957940558878843988406139706"))
    runTest(BigInt("129314974326202812761776635608183431257"), BigInt("299277274511444235615215088410995254910"))
    runTest(BigInt("129314974326202812761776635608183431257"), BigInt("290344368712704217253225504508389502316"), iv=BigInt("111936736101327085354451989176468590693"))
    runTest(BigInt("121148990538232653275952742264800096858"), BigInt("157514679937413239825775054303450374032"))
    runTest(BigInt("121148990538232653275952742264800096858"), BigInt("261660646289350536107466692452963745018"), iv=BigInt("64090739641937466629916859496542518607"))
    runTest(BigInt("88197476973487720416485896921284894276"), BigInt("148552073306447655570339765395310716881"))
    runTest(BigInt("88197476973487720416485896921284894276"), BigInt("182804866128777062834696979323299561137"), iv=BigInt("143854578593739929811464300660360309280"))
    setTopKey(BigInt("48456389234851202142098243808995534125"))
    setKey(BigInt("135982631495551788311031751248638068268"))
    runTest(BigInt("78830349462109766951018240863292778603"), BigInt("314441909846474501678537294355986907235"))
    runTest(BigInt("78830349462109766951018240863292778603"), BigInt("252060693170396132705558391432272463079"), iv=BigInt("162426914844831731555964786688696871527"))
    runTest(BigInt("55004422969479893448670720514075352694"), BigInt("203550518721841067287882040238150147551"))
    runTest(BigInt("55004422969479893448670720514075352694"), BigInt("83228161835063211244865124964851424462"), iv=BigInt("161165815231082948446865555462699173948"))
    runTest(BigInt("136009364882594095200467784167805957754"), BigInt("208224123101083265490809538147024384400"))
    runTest(BigInt("136009364882594095200467784167805957754"), BigInt("92474180989260030136475626254181464271"), iv=BigInt("70803991015394669881036442459495627564"))
    runTest(BigInt("68093940549084806148554331982031320156"), BigInt("130775643725962132558694014013365867531"))
    runTest(BigInt("68093940549084806148554331982031320156"), BigInt("63642693662453834717230635498373133743"), iv=BigInt("141081445065119817389718924277582361160"))
    runTest(BigInt("137374997917288160877392170936084481325"), BigInt("105769321349793171924154469416749399497"))
    runTest(BigInt("137374997917288160877392170936084481325"), BigInt("186130280578339494506978078639256908828"), iv=BigInt("49493973851779320308148953619409763681"))
    runTest(BigInt("106541472269817656843147649649606280550"), BigInt("133424662550576032998239510613883833227"))
    runTest(BigInt("106541472269817656843147649649606280550"), BigInt("32470879372967704640084611437068258010"), iv=BigInt("142831612269475498070977804451621323296"))
    runTest(BigInt("62807141845181547149269901978324968781"), BigInt("168380444895814097395587984228626255521"))
    runTest(BigInt("62807141845181547149269901978324968781"), BigInt("113921482431786244169641417015272070939"), iv=BigInt("118936215834268459917727911058518080053"))
    runTest(BigInt("84188579633246702444149348490672288059"), BigInt("105430871344835315838980192980427103905"))
    runTest(BigInt("84188579633246702444149348490672288059"), BigInt("268882195973691184800647077246445048359"), iv=BigInt("67049370304540331365916666280802145643"))
    runTest(BigInt("106750097382285375018619153448121149565"), BigInt("317997365477957972538774219372067165726"))
    runTest(BigInt("106750097382285375018619153448121149565"), BigInt("39647524262064008724286409389453049445"), iv=BigInt("73654685608295303006255566445716076859"))
    runTest(BigInt("84152233811751759225680420941102337844"), BigInt("184786327542033511750966274150367668145"))
    runTest(BigInt("84152233811751759225680420941102337844"), BigInt("289224963823308828758620933686348617066"), iv=BigInt("113640340292095688545313078669923932710"))
    setTopKey(BigInt("73561445787092232946096087032366902364"))
    setKey(BigInt("151705248709923984285320890536499625510"))
    runTest(BigInt("83940154503678393258806592388310383921"), BigInt("36641664162103580819374195998938869604"))
    runTest(BigInt("83940154503678393258806592388310383921"), BigInt("323172439820077468039404567192296414280"), iv=BigInt("159872411372144899677002121248223350878"))
    runTest(BigInt("56186558084590067661089894494472643444"), BigInt("139604174890132075434668269775480124258"))
    runTest(BigInt("56186558084590067661089894494472643444"), BigInt("19503324853953422578118256539500411899"), iv=BigInt("108084172869341626069609999473261636933"))
    runTest(BigInt("129503373021762103685479980381916191828"), BigInt("80959603757754289258213694062903371658"))
    runTest(BigInt("129503373021762103685479980381916191828"), BigInt("219622815273009075188207776680978475669"), iv=BigInt("70964223336802825464074987306900092497"))
    runTest(BigInt("150811669915100889137229235338179273799"), BigInt("35379926394824860582403072783427910449"))
    runTest(BigInt("150811669915100889137229235338179273799"), BigInt("84632201101019943494649151303712594083"), iv=BigInt("157234150455272611814688741547312764205"))
    runTest(BigInt("85680468750771047208973528274691520048"), BigInt("314973248805859260112773252889834897286"))
    runTest(BigInt("85680468750771047208973528274691520048"), BigInt("319944503250500510056977950352057787071"), iv=BigInt("154660272363770999501976801838505550145"))
    runTest(BigInt("108275720420700363552639889877399140648"), BigInt("84401240013013676085013171048536422671"))
    runTest(BigInt("108275720420700363552639889877399140648"), BigInt("216619529213583581393667744302718533886"), iv=BigInt("167978476954257428816717394118277685341"))
    runTest(BigInt("127825128105388225597438833773976502373"), BigInt("258146898814983563216865687387740226708"))
    runTest(BigInt("127825128105388225597438833773976502373"), BigInt("271780016548487756275282693458064486172"), iv=BigInt("138823689309058428062449639030338453117"))
    runTest(BigInt("152037072017522853445668761960693647425"), BigInt("35328248715709043691247075660285748873"))
    runTest(BigInt("152037072017522853445668761960693647425"), BigInt("7210566846545572024731344170009619888"), iv=BigInt("154669544207825247286455470415326508664"))
    runTest(BigInt("97543286794111051662881381956503302219"), BigInt("234872507317254644376012810044032905737"))
    runTest(BigInt("97543286794111051662881381956503302219"), BigInt("301234389580701742373641800673935781493"), iv=BigInt("112093013631452073316869056146116452407"))
    runTest(BigInt("43060636993911499741904110574253914153"), BigInt("45312229540281752989214387997451521984"))
    runTest(BigInt("43060636993911499741904110574253914153"), BigInt("164310730066660600367757017341513038036"), iv=BigInt("52459423999917944706165938380302941037"))
    setTopKey(BigInt("92321299424046459133172344659989112674"))
    setKey(BigInt("58751674277994357570503574331020165716"))
    runTest(BigInt("53498190770096707662155558213590720614"), BigInt("151986126541638063247679325201167157797"))
    runTest(BigInt("53498190770096707662155558213590720614"), BigInt("81808509196182651138808025402600863327"), iv=BigInt("100305485159620099715054184854541383284"))
    runTest(BigInt("102601393499464610747220781595573964323"), BigInt("254657579408704890737137331148887475238"))
    runTest(BigInt("102601393499464610747220781595573964323"), BigInt("122539748485445416848995831868805880247"), iv=BigInt("97294200270951190522086605944838042192"))
    runTest(BigInt("145297326917028848157639865778880797768"), BigInt("132543940579796800229768668807948481865"))
    runTest(BigInt("145297326917028848157639865778880797768"), BigInt("332146092938957970863026528607801478342"), iv=BigInt("156020228833335877928114937431547927357"))
    runTest(BigInt("77684067303858357552335581363817816429"), BigInt("149561924047141969814865845529444874814"))
    runTest(BigInt("77684067303858357552335581363817816429"), BigInt("125512294397055851542830459798285170991"), iv=BigInt("154617542697775914962870894361854427225"))
    runTest(BigInt("113411228209740317275870989242738680410"), BigInt("267952962308711417292498902296661544444"))
    runTest(BigInt("113411228209740317275870989242738680410"), BigInt("44463684980686011346116956635048565710"), iv=BigInt("109194900618323070360448876343359208511"))
    runTest(BigInt("101333741851045755168061556451474691177"), BigInt("164145835948936147263605436687369976964"))
    runTest(BigInt("101333741851045755168061556451474691177"), BigInt("143657903085887979588489863660680354964"), iv=BigInt("141450426771844252046833975297181901360"))
    runTest(BigInt("67075109630934969854164139873830980703"), BigInt("10614972079812037076652442019526211582"))
    runTest(BigInt("67075109630934969854164139873830980703"), BigInt("242457167576324409102878635500384382565"), iv=BigInt("155905211272759349947556032698240885088"))
    runTest(BigInt("74749648278114764324132366530844648227"), BigInt("14240772105520467293227417412600112069"))
    runTest(BigInt("74749648278114764324132366530844648227"), BigInt("264864099871992024716645001362591352844"), iv=BigInt("54764539430889047166445227954737667401"))
    runTest(BigInt("142597882467089047914870832382350669428"), BigInt("51975121749648397795047286949762643413"))
    runTest(BigInt("142597882467089047914870832382350669428"), BigInt("189465821041576258969369979844261621659"), iv=BigInt("161441127694688787768465500210039242538"))
    runTest(BigInt("48020437560788213130480607771600247647"), BigInt("55208184620380937692471894050003143501"))
    runTest(BigInt("48020437560788213130480607771600247647"), BigInt("55411173474405857349216461844537951255"), iv=BigInt("48394342352319048808212733300405789305"))
    setTopKey(BigInt("159763043153360013009646269176050317436"))
    setKey(BigInt("54993769069956249949458707726467998067"))
    runTest(BigInt("112253145158535255727790291816227283825"), BigInt("291057746009438856139105668897831163533"))
    runTest(BigInt("112253145158535255727790291816227283825"), BigInt("334896219678369595623273106244186767033"), iv=BigInt("155686750466154992981954204209830639415"))
    runTest(BigInt("108121109365825500205972174135321714759"), BigInt("237537172305726077283658402241278566968"))
    runTest(BigInt("108121109365825500205972174135321714759"), BigInt("275190717167220935041132157865911526835"), iv=BigInt("162509828951165008531194540197990583086"))
    runTest(BigInt("140063353414436998288778982305387073142"), BigInt("318021669540232408383711662397698685721"))
    runTest(BigInt("140063353414436998288778982305387073142"), BigInt("162919856352788619473934514529462549899"), iv=BigInt("69666618452211352853780621754418028900"))
    runTest(BigInt("150395835701345478888899286081140835134"), BigInt("217844967448371963798717273996233456838"))
    runTest(BigInt("150395835701345478888899286081140835134"), BigInt("93561783757530629255122425079987178170"), iv=BigInt("144206988845765772719830176147636502129"))
    runTest(BigInt("63077937752962523207951816084389978162"), BigInt("162784976730643034495836469722223025189"))
    runTest(BigInt("63077937752962523207951816084389978162"), BigInt("107184628583317974454191619832622721634"), iv=BigInt("133490472793609592867379026766853338150"))
    runTest(BigInt("46907901973387631828234608271406425446"), BigInt("212689517195344106078840185866023376211"))
    runTest(BigInt("46907901973387631828234608271406425446"), BigInt("70508519954655467584391854034577460525"), iv=BigInt("126471313548947327700997938867931007287"))
    runTest(BigInt("110851992481892123195101593959514729295"), BigInt("60709651802812432916371621471632085867"))
    runTest(BigInt("110851992481892123195101593959514729295"), BigInt("167818434908510584028113334192187272861"), iv=BigInt("81692824769631923104626281814621629293"))
    runTest(BigInt("145390648489994000182139253619470597463"), BigInt("167930293870110664548448249920167509328"))
    runTest(BigInt("145390648489994000182139253619470597463"), BigInt("325325682904774716361352224172659803657"), iv=BigInt("85576282602974203870976038453256342132"))
    runTest(BigInt("130650991703933350549328711062532736361"), BigInt("51069732995933573481551726047162257358"))
    runTest(BigInt("130650991703933350549328711062532736361"), BigInt("272224986161286092147087089646609465579"), iv=BigInt("68181150482880779146633970470736175445"))
    runTest(BigInt("140006601656068401563042948177718558010"), BigInt("81010256650438699205369368697190102627"))
    runTest(BigInt("140006601656068401563042948177718558010"), BigInt("334002016120335623338310579887416526023"), iv=BigInt("87938730928892616111319236031328832092"))
    setTopKey(BigInt("61707293078667613542018796157226590241"))
    setKey(BigInt("149265333405208659899700467192792436090"))
    runTest(BigInt("69485552470114824931084265416806979924"), BigInt("330231470547536011965472945067504159382"))
    runTest(BigInt("69485552470114824931084265416806979924"), BigInt("64125557929477559322919666780244701093"), iv=BigInt("93619386540402035840555090501823066193"))
    runTest(BigInt("133136640620198628523101561231132864621"), BigInt("180164873309247642617296810958604071907"))
    runTest(BigInt("133136640620198628523101561231132864621"), BigInt("634704977003190107903560277498004563"), iv=BigInt("93645618529211535951860810112665874545"))
    runTest(BigInt("116018595508040794846238613368827365239"), BigInt("153887896625237656011477736478144494134"))
    runTest(BigInt("116018595508040794846238613368827365239"), BigInt("61761582582497718307465238714768582853"), iv=BigInt("45480351684027777011330662031821076853"))
    runTest(BigInt("161300149430659974304541290725805143363"), BigInt("242193002871517747341465143719215072892"))
    runTest(BigInt("161300149430659974304541290725805143363"), BigInt("52515876580786825534762754434558881050"), iv=BigInt("154394534463848063472599535676865476659"))
    runTest(BigInt("94854406469182689574457138274375920722"), BigInt("197279459517378584256026100115882852042"))
    runTest(BigInt("94854406469182689574457138274375920722"), BigInt("193257102530750369555987126814322528962"), iv=BigInt("54878426098844539394531931463312883031"))
    runTest(BigInt("102783123099349468929927648905773984318"), BigInt("295314170546083843720053528668530844861"))
    runTest(BigInt("102783123099349468929927648905773984318"), BigInt("307283759448291401738097837397684019316"), iv=BigInt("125483458787607073593297044274852812905"))
    runTest(BigInt("139981614684468028367831028559318114922"), BigInt("34834816215785101446675074529665873850"))
    runTest(BigInt("139981614684468028367831028559318114922"), BigInt("91085694789537876141046715429640066321"), iv=BigInt("159980613506018189484854991474629695865"))
    runTest(BigInt("42748999129038818640921748059470307636"), BigInt("47937744019700941485070841577498858485"))
    runTest(BigInt("42748999129038818640921748059470307636"), BigInt("241907252764200861431024318728155938718"), iv=BigInt("124263896901347950456708319371659915563"))
    runTest(BigInt("163859832296246273198478626733957006655"), BigInt("77558872812141918097640268112101900109"))
    runTest(BigInt("163859832296246273198478626733957006655"), BigInt("39989759007997654624241676418760622613"), iv=BigInt("106963696665961675804098436899651738965"))
    runTest(BigInt("157021410495778332141778426778960938076"), BigInt("64884443285046141655185445701117617421"))
    runTest(BigInt("157021410495778332141778426778960938076"), BigInt("290730393952113513351578242274747996884"), iv=BigInt("58907810638378081377762725044647702093"))
    setTopKey(BigInt("73596617292765269912818337106439331141"))
    setKey(BigInt("50902224566510932386356134937102019445"))
    runTest(BigInt("53528896064766903476247660780811660578"), BigInt("4766181184071275034531331449850036948"))
    runTest(BigInt("53528896064766903476247660780811660578"), BigInt("129570184494722436238714817881111625947"), iv=BigInt("104138131846065368814263585165612495725"))
    runTest(BigInt("153283339813429075943512796761413539135"), BigInt("200958991741106442518641528005131798885"))
    runTest(BigInt("153283339813429075943512796761413539135"), BigInt("134875361780739545141309182258294805563"), iv=BigInt("68025628274444111159985128975333336399"))
    runTest(BigInt("151782002119176281335908367810041494895"), BigInt("284079105070577494583018041179397466248"))
    runTest(BigInt("151782002119176281335908367810041494895"), BigInt("304379068565292176793425007359335364346"), iv=BigInt("60423903168573174758984702190889759321"))
    runTest(BigInt("99881199422750980741261461304015270969"), BigInt("324525422001385208919555620295390731290"))
    runTest(BigInt("99881199422750980741261461304015270969"), BigInt("209064266495518954983723303564420136582"), iv=BigInt("109164637993115081628047750449436910972"))
    runTest(BigInt("160075656715907193712401417683197323890"), BigInt("79284296238985460269063299315105605348"))
    runTest(BigInt("160075656715907193712401417683197323890"), BigInt("279199033605094913990515587372159987017"), iv=BigInt("101536546316988459633476278810771677496"))
    runTest(BigInt("84148782695601361820064193783267811154"), BigInt("294856050681357815815646181330786424608"))
    runTest(BigInt("84148782695601361820064193783267811154"), BigInt("217324247318216134779078959263274761116"), iv=BigInt("160163703753749476889810395745036808778"))
    runTest(BigInt("100114728954249441266086039892781713722"), BigInt("72482286702351341366205962736328710363"))
    runTest(BigInt("100114728954249441266086039892781713722"), BigInt("87354040956204059154737371467833551854"), iv=BigInt("94626289570263069113244968069302017399"))
    runTest(BigInt("130687437441660565626402706856960751484"), BigInt("61978036972657165781529474013517436294"))
    runTest(BigInt("130687437441660565626402706856960751484"), BigInt("213510992562346590673512859335365217547"), iv=BigInt("116101931260827101092744411424001119776"))
    runTest(BigInt("102689706989366756899894939367521404005"), BigInt("318631311726678919903821503231503141427"))
    runTest(BigInt("102689706989366756899894939367521404005"), BigInt("57550802345629682947099189072656371818"), iv=BigInt("100062074715881158885993870222429336141"))
    runTest(BigInt("165443643047952914121630258801478760803"), BigInt("195915035466806628922487112859174674262"))
    runTest(BigInt("165443643047952914121630258801478760803"), BigInt("198120041048180671539793360118914366640"), iv=BigInt("153164388095468368271490017856083085402"))
    setTopKey(BigInt("88219566487711136154952937018719282213"))
    setKey(BigInt("121517360755464516123247965775193983835"))
    runTest(BigInt("101209110893139482146645729815639959138"), BigInt("116580208456912722051127021184311508541"))
    runTest(BigInt("101209110893139482146645729815639959138"), BigInt("152028802840363552225617841498147771839"), iv=BigInt("105234740640961110757336135995969317927"))
    runTest(BigInt("101490487023528368274444488323971231525"), BigInt("178806161176315219866519394483918489745"))
    runTest(BigInt("101490487023528368274444488323971231525"), BigInt("283720221393517288623676303724887361976"), iv=BigInt("56472824990133148668084508527429647662"))
    runTest(BigInt("165033839168280659640393464404975172917"), BigInt("184870236735145059315577384866874088075"))
    runTest(BigInt("165033839168280659640393464404975172917"), BigInt("8644530346557335446069583278417840662"), iv=BigInt("45413987713796820142291043093414563367"))
    runTest(BigInt("76032144103622199401204361374807381076"), BigInt("8228111661316264948853661071609886578"))
    runTest(BigInt("76032144103622199401204361374807381076"), BigInt("305323611823507911182347099028622401157"), iv=BigInt("93379815177219932974520917581965580638"))
    runTest(BigInt("73743416223918120054826600841829559847"), BigInt("54228822722000835436661803447359290302"))
    runTest(BigInt("73743416223918120054826600841829559847"), BigInt("42143112991187626058674595170089149641"), iv=BigInt("57480480200082417692188091484440113512"))
    runTest(BigInt("93363872727347802267996760105990703146"), BigInt("309033683896874576103905618243229446107"))
    runTest(BigInt("93363872727347802267996760105990703146"), BigInt("176603039171366936767363657351835978139"), iv=BigInt("133247244065988855030934123844611362917"))
    runTest(BigInt("98997883049031963505526291230343511841"), BigInt("60766943804385712889859485871127185743"))
    runTest(BigInt("98997883049031963505526291230343511841"), BigInt("337555088558874872049000293711579477505"), iv=BigInt("117409294331412066804258569403177205040"))
    runTest(BigInt("92341336130039863538914655048698655580"), BigInt("90113222208317952956143470805436883987"))
    runTest(BigInt("92341336130039863538914655048698655580"), BigInt("276573407390961399452332519931205351959"), iv=BigInt("110925562271470935587890320589220952101"))
    runTest(BigInt("141507822906648042960017852005462984512"), BigInt("45559905305913729917731049310705245257"))
    runTest(BigInt("141507822906648042960017852005462984512"), BigInt("122585592814841280488332310130768320231"), iv=BigInt("139908982485803942248465350368303543419"))
    runTest(BigInt("145473681102745911635151971076463688227"), BigInt("165203144810717428496040498824371512149"))
    runTest(BigInt("145473681102745911635151971076463688227"), BigInt("299607409214984346352284284619211129689"), iv=BigInt("125239948174823881825662806025540426296"))
    setTopKey(BigInt("106558286329235740135266738119737962365"))
    setKey(BigInt("127956271725524677220924434828844418676"))
    runTest(BigInt("52059941992076816328245106753884865137"), BigInt("248965115558768519225846826942709710444"))
    runTest(BigInt("52059941992076816328245106753884865137"), BigInt("305865673646382967354143155496541977530"), iv=BigInt("157084023243363496926172212512637996153"))
    runTest(BigInt("137451499916067899886797429544397065002"), BigInt("51907145418991570442017030593475479278"))
    runTest(BigInt("137451499916067899886797429544397065002"), BigInt("68704445954006211767980640297994049354"), iv=BigInt("97470715859613447585992349064545983070"))
    runTest(BigInt("65472032498956007331521712728643153757"), BigInt("194860084249800308794450146417449322401"))
    runTest(BigInt("65472032498956007331521712728643153757"), BigInt("320839574596961815176579048070092146378"), iv=BigInt("124018851563565677282831124704283076441"))
    runTest(BigInt("106817191371688762203797586564854659425"), BigInt("74843449589235533429056685416166505436"))
    runTest(BigInt("106817191371688762203797586564854659425"), BigInt("160722944809348828060913958253813704892"), iv=BigInt("106787215069847481999590429866885671278"))
    runTest(BigInt("44369682332428545127003503682535312708"), BigInt("225175921485501777820371872848853432456"))
    runTest(BigInt("44369682332428545127003503682535312708"), BigInt("65799253335741589485370484490569809599"), iv=BigInt("159935003177532167965007753739608672058"))
    runTest(BigInt("154389507510651905963930794334961887853"), BigInt("300787533839278349702169802083148214955"))
    runTest(BigInt("154389507510651905963930794334961887853"), BigInt("61074987344634510330210453715488110506"), iv=BigInt("46738084800276873601092304948590628412"))
    runTest(BigInt("142758070401002070300363784468680439365"), BigInt("212858397013591517001539318660170772754"))
    runTest(BigInt("142758070401002070300363784468680439365"), BigInt("272222886485329232190008173829619551288"), iv=BigInt("90705193940854831417511220258235632170"))
    runTest(BigInt("59090005566718849624645672979146487338"), BigInt("187176437672506416357979189154741633495"))
    runTest(BigInt("59090005566718849624645672979146487338"), BigInt("332794376513127347539585530745126255274"), iv=BigInt("94614811804846295137391244495868018768"))
    runTest(BigInt("149295559331705969920596398295875410481"), BigInt("303271853144315555303618904641619385339"))
    runTest(BigInt("149295559331705969920596398295875410481"), BigInt("163145847619249507241755748797054607429"), iv=BigInt("103967515829048754442178675172489778030"))
    runTest(BigInt("154628330491722760310202863494497185898"), BigInt("19549579705863866641953953971558668021"))
    runTest(BigInt("154628330491722760310202863494497185898"), BigInt("144555853978131143835068208710737819888"), iv=BigInt("108184047510374556240764681370096258168"))

}
