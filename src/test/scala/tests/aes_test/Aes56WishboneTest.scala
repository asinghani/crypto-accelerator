// Copyright 2020 Anish Singhani
//
// SPDX-License-Identifier: Apache-2.0
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     https://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
package tests.aes_test

import aes.{AesWishbone, Aes56Wishbone}
import chisel3.iotesters.PeekPokeTester

class Aes56WishboneTest(dut: Aes56Wishbone) extends PeekPokeTester(dut) {
    assert(dut.LIMIT_KEY_LENGTH)

    poke(dut.io.bus.stb, false)
    poke(dut.io.bus.cyc, false)
    poke(dut.io.bus.we, false)
    poke(dut.io.bus.sel, 0xF)

    def assertError(func: => Unit): Unit = {
        var error = false
        try {
            func
        } catch {
            case e: AssertionError => error = true
        }

        assert(error)
    }

    // 0x00 = status    // RW
    // 0x04 = encStart  // WO
    // 0x08 = decStart  // WO
    // 0x10 = data[0]   // RW
    // 0x14 = data[4]   // RW
    // 0x18 = data[8]   // RW
    // 0x1C = data[C]   // RW
    // 0x20 = iv[0]     // RW
    // 0x24 = iv[4]     // RW
    // 0x28 = iv[8]     // RW
    // 0x2C = iv[C]     // RW
    // 0x30 = out[0]    // RO
    // 0x34 = out[4]    // RO
    // 0x38 = out[8]    // RO
    // 0x3C = out[C]    // RO
    // 0x40 = key[0]    // RW
    // 0x44 = key[4]    // RW
    // 0x48 = key[8]    // RW
    // 0x4C = key[C]    // RW

    def wishboneWrite(addr: Long, data: Long) : Unit = {
        poke(dut.io.bus.addr, addr)
        poke(dut.io.bus.data_wr, data)
        poke(dut.io.bus.we, true)
        poke(dut.io.bus.cyc, true)
        poke(dut.io.bus.stb, true)
        while(peek(dut.io.bus.ack) != 1) step(1)
        poke(dut.io.bus.cyc, false)
        poke(dut.io.bus.stb, false)
        step(1)
        expect(dut.io.bus.ack, 0)
    }

    def wishboneRead(addr: Long) : Long = {
        poke(dut.io.bus.addr, addr)
        poke(dut.io.bus.we, false)
        poke(dut.io.bus.cyc, true)
        poke(dut.io.bus.stb, true)
        while(peek(dut.io.bus.ack) != 1) step(1)
        poke(dut.io.bus.cyc, false)
        poke(dut.io.bus.stb, false)
        val data_out = peek(dut.io.bus.data_rd).toLong
        step(1)
        expect(dut.io.bus.ack, 0)
        return data_out
    }

    def setKey(key: BigInt): Unit = {
        wishboneWrite(0x40, ((key >> 96) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x40, ((key >> 64) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x40, ((key >> 32) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x40, ((key >> 0)  & 0xFFFFFFFFl).toLong)

        wishboneWrite(0x0C, 1)

        step(1)
        while ((wishboneRead(0x00) & 0x3) != 0x3) step(1)
    }

    def setIv(iv: BigInt = BigInt(0)): Unit = {
        wishboneWrite(0x00, 0x0)

        wishboneWrite(0x10, ((iv >> 96) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((iv >> 64) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((iv >> 32) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((iv >> 0)  & 0xFFFFFFFFl).toLong)

        wishboneWrite(0x08, 1)
        step(1)
        assert((wishboneRead(0x00) & 0x4) != 0x4)
        while ((wishboneRead(0x00) & 0x4) != 0x4) step(1)

        wishboneWrite(0x00, 0x8)
    }

    def runSingleDecryptTest(ciphertext: BigInt, plaintext: BigInt, iv: BigInt = BigInt(0)): Unit = {
        if (iv != 0) setIv(iv)
        wishboneWrite(0x00, if (iv != 0) { 0x8 } else { 0x0 })

        wishboneWrite(0x10, ((ciphertext >> 96) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((ciphertext >> 64) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((ciphertext >> 32) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((ciphertext >> 0)  & 0xFFFFFFFFl).toLong)

        wishboneWrite(0x08, 1)
        step(1)
        assert((wishboneRead(0x00) & 0x4) != 0x4)
        while ((wishboneRead(0x00) & 0x4) != 0x4) step(1)

        val out = (BigInt(wishboneRead(0x30)) << 96) | (BigInt(wishboneRead(0x34)) << 64) |
            (BigInt(wishboneRead(0x38)) << 32) | (BigInt(wishboneRead(0x3C)) << 0)

        assert(out == plaintext)
    }

    def runSingleEncryptTest(plaintext: BigInt, ciphertext: BigInt, iv: BigInt = BigInt(0)): Unit = {
        if (iv != 0) setIv(iv)
        wishboneWrite(0x00, if (iv != 0) { 0x8 } else { 0x0 })

        wishboneWrite(0x10, ((plaintext >> 96) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((plaintext >> 64) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((plaintext >> 32) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((plaintext >> 0)  & 0xFFFFFFFFl).toLong)

        wishboneWrite(0x04, 1)
        step(2)
        assert((wishboneRead(0x00) & 0x4) != 0x4)
        while ((wishboneRead(0x00) & 0x4) != 0x4) step(1)

        val out = (BigInt(wishboneRead(0x30)) << 96) | (BigInt(wishboneRead(0x34)) << 64) |
            (BigInt(wishboneRead(0x38)) << 32) | (BigInt(wishboneRead(0x3C)) << 0)

        assert(out == ciphertext)
    }


    setKey(BigInt("129398247407752897397544612226629132633"))
    runSingleEncryptTest(BigInt("165172891330934591086520181724919193936"), BigInt("243678112443251405947910048894144549013"))
    runSingleEncryptTest(BigInt("165172891330934591086520181724919193936"), BigInt("204279563832346585576113957250142919251"), iv=BigInt("114699768982221135679306289480750232887"))
    runSingleEncryptTest(BigInt("44488255983732017839097014021370760521"), BigInt("260876674760561480864495159374928971218"))
    runSingleEncryptTest(BigInt("44488255983732017839097014021370760521"), BigInt("338003370300509022458192389821504587935"), iv=BigInt("73535746864601228455627379385295469662"))
    setKey(BigInt("114491348438776448937197039322027218466"))
    runSingleDecryptTest(BigInt("134483010089486892341168050580774048488"), BigInt("121511355417064779528707274975349926195"))
    runSingleDecryptTest(BigInt("75538797231134421688292563954074040575"), BigInt("121511355417064779528707274975349926195"), iv=BigInt("110571285992890825646029736563987260767"))
    runSingleDecryptTest(BigInt("268924294246848259215596729461636319063"), BigInt("66903827862351497728002488290480244088"))
    runSingleDecryptTest(BigInt("29541044650230354360518609331213012605"), BigInt("66903827862351497728002488290480244088"), iv=BigInt("97487267338979026241344010303275811698"))

    setKey(BigInt("54800740842674637621495239366510127418"))
    runSingleEncryptTest(BigInt("134726136205166724496538859340310277453"), BigInt("126245778892647572034481013093399794607"))
    runSingleEncryptTest(BigInt("134726136205166724496538859340310277453"), BigInt("280649536924477012588935036035627061523"), iv=BigInt("109341847296447783041116304954808869968"))
    runSingleEncryptTest(BigInt("150682140920197231837429177456395044184"), BigInt("21752171968023118161712945743967782323"))
    runSingleEncryptTest(BigInt("150682140920197231837429177456395044184"), BigInt("166839751663267467662467270757636969487"), iv=BigInt("46742521110414198242411228737216277553"))
    runSingleEncryptTest(BigInt("147982052333852429402573794757387511333"), BigInt("286780448267288865094665500853585521931"))
    runSingleEncryptTest(BigInt("147982052333852429402573794757387511333"), BigInt("39693577231919602520554842619300651132"), iv=BigInt("111833930642223586070325116854345881442"))
    runSingleEncryptTest(BigInt("107990103844088464546910353110540035193"), BigInt("278563810154446623235839558689664684248"))
    runSingleEncryptTest(BigInt("107990103844088464546910353110540035193"), BigInt("261789605689242806736463723191102353475"), iv=BigInt("156154909666048098409885367534109729603"))
    runSingleEncryptTest(BigInt("53455410891735233525846679303684192306"), BigInt("108660090513472262190956490286120975796"))
    runSingleEncryptTest(BigInt("53455410891735233525846679303684192306"), BigInt("74482532023933587047412636228971002971"), iv=BigInt("97232522571612375842218698337992602431"))
    runSingleEncryptTest(BigInt("153287641757195701773701044943200731712"), BigInt("86837549163912203834098194901347315222"))
    runSingleEncryptTest(BigInt("153287641757195701773701044943200731712"), BigInt("322523843477864450693729575308528453934"), iv=BigInt("72206376422419345043372769313427113002"))
    runSingleEncryptTest(BigInt("60221321667005043408185676106381537634"), BigInt("102660113534763862295937417925820538690"))
    runSingleEncryptTest(BigInt("60221321667005043408185676106381537634"), BigInt("38688631502786617920347651664202086565"), iv=BigInt("135967927386231099856889659206068947744"))
    runSingleEncryptTest(BigInt("57486034480729537178192497784614303307"), BigInt("317441612912270520448301292287425799382"))
    runSingleEncryptTest(BigInt("57486034480729537178192497784614303307"), BigInt("106110020147292545343948447725631960830"), iv=BigInt("113556937987697937722142686361602181706"))
    runSingleEncryptTest(BigInt("61514992470061259264228945568850800466"), BigInt("301256277522506870987189010274785609519"))
    runSingleEncryptTest(BigInt("61514992470061259264228945568850800466"), BigInt("307331869569950561165179914322909488541"), iv=BigInt("108000470927128213274140305426090717504"))
    runSingleEncryptTest(BigInt("158533509358688920310103549106087552588"), BigInt("182920272724636589172879012726192703735"))
    runSingleEncryptTest(BigInt("158533509358688920310103549106087552588"), BigInt("278396936888605431235747534150393684401"), iv=BigInt("89454617643784014075112433164574482267"))
    setKey(BigInt("49660008261373303634607809490915894620"))
    runSingleEncryptTest(BigInt("94796964302834619674221143614540109148"), BigInt("303215093607822543928172436711765851564"))
    runSingleEncryptTest(BigInt("94796964302834619674221143614540109148"), BigInt("304347428046626332057994458709675435949"), iv=BigInt("94558889472301317870004471659975489601"))
    runSingleEncryptTest(BigInt("57641172671848098447260563461101800017"), BigInt("199218203535999199075724328005884529082"))
    runSingleEncryptTest(BigInt("57641172671848098447260563461101800017"), BigInt("135283911449600699898506418996226513608"), iv=BigInt("61753029135511506030123028689024656183"))
    runSingleEncryptTest(BigInt("147872824837703644996628238487300763511"), BigInt("225482774176119447030625465859177720048"))
    runSingleEncryptTest(BigInt("147872824837703644996628238487300763511"), BigInt("42411887637799773436709840030462804602"), iv=BigInt("167915620513416205174989028236046590253"))
    runSingleEncryptTest(BigInt("114523635508466715512268252466257931367"), BigInt("69005319412826752299473358980983603129"))
    runSingleEncryptTest(BigInt("114523635508466715512268252466257931367"), BigInt("305366601821204793885896498392922406060"), iv=BigInt("153075083139491522126055556447412567625"))
    runSingleEncryptTest(BigInt("130447544074158340843940727141497923377"), BigInt("117816627119386675495964591511608417062"))
    runSingleEncryptTest(BigInt("130447544074158340843940727141497923377"), BigInt("519936856571031019780484299921323301"), iv=BigInt("131848971512524104701789536057097467961"))
    runSingleEncryptTest(BigInt("164051353880955350741784096746420398952"), BigInt("94285697767407631554735912444008346311"))
    runSingleEncryptTest(BigInt("164051353880955350741784096746420398952"), BigInt("33705106581287705873241236410827675467"), iv=BigInt("113251300050464853425767685256906431030"))
    runSingleEncryptTest(BigInt("140126284673224055129956659612292504694"), BigInt("30973357754388566889538479374652134015"))
    runSingleEncryptTest(BigInt("140126284673224055129956659612292504694"), BigInt("225302671315909492417258556299196132201"), iv=BigInt("50751156837383093074697926854092923722"))
    runSingleEncryptTest(BigInt("89678332124985469598237474018490724641"), BigInt("184801506211168447143819365036394188034"))
    runSingleEncryptTest(BigInt("89678332124985469598237474018490724641"), BigInt("169243757588487028746085137245059349607"), iv=BigInt("44369054127962197804620196119674124075"))
    runSingleEncryptTest(BigInt("127867211085306694882660600801556454178"), BigInt("20409383469804206542650280200351014040"))
    runSingleEncryptTest(BigInt("127867211085306694882660600801556454178"), BigInt("186923243500706922690068507166166285246"), iv=BigInt("130573106526894468778462275332410797393"))
    runSingleEncryptTest(BigInt("76318575450704608388818004011085814612"), BigInt("101862134169185473828104113400568350484"))
    runSingleEncryptTest(BigInt("76318575450704608388818004011085814612"), BigInt("91903599146369655013986816259795053376"), iv=BigInt("121381385425600256109765664848582764148"))
    setKey(BigInt("59017638318252845079006924856225508454"))
    runSingleEncryptTest(BigInt("71976637633622799739946436394945490476"), BigInt("184829390951685141752958292431529684908"))
    runSingleEncryptTest(BigInt("71976637633622799739946436394945490476"), BigInt("92080243854688164877397864839593047865"), iv=BigInt("57719851541248021877111634877663948365"))
    runSingleEncryptTest(BigInt("166664240671354522457875620324373848099"), BigInt("1927131017777379067306093350488982942"))
    runSingleEncryptTest(BigInt("166664240671354522457875620324373848099"), BigInt("167832630773904329719415944413667913505"), iv=BigInt("53451902135792392188825526123448459316"))
    runSingleEncryptTest(BigInt("59037902194679185385633900538197858619"), BigInt("138052321239870662569256452557888053980"))
    runSingleEncryptTest(BigInt("59037902194679185385633900538197858619"), BigInt("81815889222203971681035046958056187347"), iv=BigInt("168070230529371902900917795023412942437"))
    runSingleEncryptTest(BigInt("85725678552567179734288706671796233565"), BigInt("102416340145547237954358364618684031182"))
    runSingleEncryptTest(BigInt("85725678552567179734288706671796233565"), BigInt("45794754721033587579744894835298025157"), iv=BigInt("124050996580312570580041900295102147370"))
    runSingleEncryptTest(BigInt("94714378381711386586456958783038779759"), BigInt("127577317025292067841317604256608494158"))
    runSingleEncryptTest(BigInt("94714378381711386586456958783038779759"), BigInt("129708927567709015316953096235782125158"), iv=BigInt("74650980142467615425526817537225082726"))
    runSingleEncryptTest(BigInt("120219627620552216256250889687468046406"), BigInt("259559922914369505084788333025478400386"))
    runSingleEncryptTest(BigInt("120219627620552216256250889687468046406"), BigInt("94140850236090409719245804871430019888"), iv=BigInt("133277380802338208981152621811241417763"))
    runSingleEncryptTest(BigInt("112284624187098294292168825099847934798"), BigInt("90626625056278210497935871488933363343"))
    runSingleEncryptTest(BigInt("112284624187098294292168825099847934798"), BigInt("270281873009169998455198846647781162604"), iv=BigInt("66903890300693490172070281403482394428"))
    runSingleEncryptTest(BigInt("137452377835582652588156458073785597510"), BigInt("82622258797965545061751641772573344499"))
    runSingleEncryptTest(BigInt("137452377835582652588156458073785597510"), BigInt("144205278278424628190630581160212742030"), iv=BigInt("135838181756777176603331506410286240545"))
    runSingleEncryptTest(BigInt("162421868885486448744611877733876381816"), BigInt("217484121354488414573216535284912763988"))
    runSingleEncryptTest(BigInt("162421868885486448744611877733876381816"), BigInt("333291909968592675030246277885932075806"), iv=BigInt("105648927508076820852673842187137523790"))
    runSingleEncryptTest(BigInt("145131419573234372336187355359281108283"), BigInt("313420496509043024315240656298701554969"))
    runSingleEncryptTest(BigInt("145131419573234372336187355359281108283"), BigInt("199842376006132679864431441612494050176"), iv=BigInt("162728171783459332537280243887169546869"))
    setKey(BigInt("139913704259039112927562480288194980162"))
    runSingleEncryptTest(BigInt("53560759487934852990836944250083756613"), BigInt("239208878679802523664025048096558664741"))
    runSingleEncryptTest(BigInt("53560759487934852990836944250083756613"), BigInt("7687324263232564317443477286608190374"), iv=BigInt("146715551423068948704155391330720043885"))
    runSingleEncryptTest(BigInt("124180863582195445569201904554908005736"), BigInt("103099553421602640024670972617365002990"))
    runSingleEncryptTest(BigInt("124180863582195445569201904554908005736"), BigInt("280665591386687238928212668288221181315"), iv=BigInt("65492940190210527697059896038389020282"))
    runSingleEncryptTest(BigInt("44146310970150282956655583245546186326"), BigInt("89358368579013820490091098760362949649"))
    runSingleEncryptTest(BigInt("44146310970150282956655583245546186326"), BigInt("209208923355127612130220600831544716869"), iv=BigInt("80383187765098536279908059398310100530"))
    runSingleEncryptTest(BigInt("132166167564565527754576572415790044284"), BigInt("145909290217273542156790875623702582316"))
    runSingleEncryptTest(BigInt("132166167564565527754576572415790044284"), BigInt("168086761045233633072711144668192126920"), iv=BigInt("137186998974208388871277297194537149281"))
    runSingleEncryptTest(BigInt("110550536790481145588162202435071658611"), BigInt("234896714795307098399985285944314261956"))
    runSingleEncryptTest(BigInt("110550536790481145588162202435071658611"), BigInt("286084058895534679053265057259278280798"), iv=BigInt("156119309840315928608211123740093402414"))
    runSingleEncryptTest(BigInt("158485352513694576210506646718656815163"), BigInt("192732205643384502275357817599336198150"))
    runSingleEncryptTest(BigInt("158485352513694576210506646718656815163"), BigInt("269383332831106144158153188709561830018"), iv=BigInt("92273753253089149464754333596621415288"))
    runSingleEncryptTest(BigInt("66722562055473710379866039895635943991"), BigInt("296515089681409983670881008806687130895"))
    runSingleEncryptTest(BigInt("66722562055473710379866039895635943991"), BigInt("299175557858692978356006958981370098229"), iv=BigInt("49359826251254055446943230618543938644"))
    runSingleEncryptTest(BigInt("43019486909779422985979182677605825069"), BigInt("225791458733330481198117110586982858492"))
    runSingleEncryptTest(BigInt("43019486909779422985979182677605825069"), BigInt("331018535556577596320322217617883318275"), iv=BigInt("70976064601853485305267576596252870710"))
    runSingleEncryptTest(BigInt("105482958139521079927912378190990822239"), BigInt("217369678328581888731703835437082681972"))
    runSingleEncryptTest(BigInt("105482958139521079927912378190990822239"), BigInt("71455407842929890370351380271827393770"), iv=BigInt("151752125331601794973792531182661028699"))
    runSingleEncryptTest(BigInt("152167162060081982511499303598487458377"), BigInt("207920575380964095638206163577323186036"))
    runSingleEncryptTest(BigInt("152167162060081982511499303598487458377"), BigInt("239425673821319656002825536666968882703"), iv=BigInt("102705061316173026114575229881506936356"))
    setKey(BigInt("80015122793551231347296942647476698162"))
    runSingleEncryptTest(BigInt("113402042264534741144532480176296132160"), BigInt("183530279849577853746312633402952654226"))
    runSingleEncryptTest(BigInt("113402042264534741144532480176296132160"), BigInt("209313707597130987960308380582570165325"), iv=BigInt("55128976859970920938596656089166460461"))
    runSingleEncryptTest(BigInt("98541380210569049531566031516060252962"), BigInt("282612546153465027572581283292729899396"))
    runSingleEncryptTest(BigInt("98541380210569049531566031516060252962"), BigInt("66146859159851387617439359157249873126"), iv=BigInt("102777265902391193560792338167718229795"))
    runSingleEncryptTest(BigInt("106946903392278496401109756990707876473"), BigInt("184847334973807582112084580240421092261"))
    runSingleEncryptTest(BigInt("106946903392278496401109756990707876473"), BigInt("124010567567179266034055709929319593010"), iv=BigInt("100347879696569839921171628891551782474"))
    runSingleEncryptTest(BigInt("107901898670802650529081499392451824208"), BigInt("124446850753889403985472918086799281323"))
    runSingleEncryptTest(BigInt("107901898670802650529081499392451824208"), BigInt("224741157570293143496596813203355737536"), iv=BigInt("42708228377569388178113640728432438080"))
    runSingleEncryptTest(BigInt("125509135302158570408325163748826167933"), BigInt("240203982461002341361138064611877150901"))
    runSingleEncryptTest(BigInt("125509135302158570408325163748826167933"), BigInt("83460232711750530300413382645244423927"), iv=BigInt("77630952875558177178920004293957679664"))
    runSingleEncryptTest(BigInt("69324550640481039806132776729497595234"), BigInt("277949538298234406710274112502731291141"))
    runSingleEncryptTest(BigInt("69324550640481039806132776729497595234"), BigInt("189856443363237357113287093190535421868"), iv=BigInt("68326127633997543107901279957170083127"))
    runSingleEncryptTest(BigInt("72417886449228185954528023824694275945"), BigInt("228794063967922919441695548289453513942"))
    runSingleEncryptTest(BigInt("72417886449228185954528023824694275945"), BigInt("163006848953755930108228049838560553702"), iv=BigInt("149128893936607191469726824509734735961"))
    runSingleEncryptTest(BigInt("96136741077177324898198861912164094765"), BigInt("183500233140563916378920018458943246344"))
    runSingleEncryptTest(BigInt("96136741077177324898198861912164094765"), BigInt("299058736084273461333054024366152812636"), iv=BigInt("162708132042882118915479354800635453777"))
    runSingleEncryptTest(BigInt("93334076018181656504043969372442275939"), BigInt("85002678137924018853351040517519117959"))
    runSingleEncryptTest(BigInt("93334076018181656504043969372442275939"), BigInt("335987731681523025783264942158884990346"), iv=BigInt("121168966152248847565803230383145107794"))
    runSingleEncryptTest(BigInt("112005575373812146417156234934230136409"), BigInt("114458386635826748466312144147701412446"))
    runSingleEncryptTest(BigInt("112005575373812146417156234934230136409"), BigInt("47419243509029286994081972640987395398"), iv=BigInt("150625700738473274746613202062480662838"))
    setKey(BigInt("157115846494796813151890962918334690867"))
    runSingleEncryptTest(BigInt("68098463364830566409483924702702433098"), BigInt("108200846968804010715442635827653965296"))
    runSingleEncryptTest(BigInt("68098463364830566409483924702702433098"), BigInt("210570023350078178498046286444209714790"), iv=BigInt("48368277233894445587421622220242580532"))
    runSingleEncryptTest(BigInt("54988624170698190128417523551281635171"), BigInt("327835139346581635516292456744860374561"))
    runSingleEncryptTest(BigInt("54988624170698190128417523551281635171"), BigInt("326388605968083905163710728543449121085"), iv=BigInt("153299163359509144928805559995313824334"))
    runSingleEncryptTest(BigInt("54753509900426643835673800660093195371"), BigInt("156384948226271522626085717989041111026"))
    runSingleEncryptTest(BigInt("54753509900426643835673800660093195371"), BigInt("10893569418141104565816695846165516092"), iv=BigInt("89593760041228414628295380444555060287"))
    runSingleEncryptTest(BigInt("130748755221991907801930129221747701847"), BigInt("290737913252251360618393157338245417538"))
    runSingleEncryptTest(BigInt("130748755221991907801930129221747701847"), BigInt("232265537842288817870182585596025093659"), iv=BigInt("110643856621306276997415748539225947716"))
    runSingleEncryptTest(BigInt("145442673833326806915321488768173302611"), BigInt("47846071932358128588269484435818003791"))
    runSingleEncryptTest(BigInt("145442673833326806915321488768173302611"), BigInt("149532453285169425099971033800602150981"), iv=BigInt("130447604761145290725699654936707225688"))
    runSingleEncryptTest(BigInt("150734592656938063331204420844036646266"), BigInt("232392731409785400225275989987977951614"))
    runSingleEncryptTest(BigInt("150734592656938063331204420844036646266"), BigInt("132467169203620969139662716820361646153"), iv=BigInt("99891661912008522642218337938603256403"))
    runSingleEncryptTest(BigInt("110639333640285844574137012293646561898"), BigInt("107517484052164470627921459769237739579"))
    runSingleEncryptTest(BigInt("110639333640285844574137012293646561898"), BigInt("160563790054964292299317607795162952964"), iv=BigInt("128225437511701571287119055887773215610"))
    runSingleEncryptTest(BigInt("92309815610039252942348423703189926244"), BigInt("216586421142349287098130669000961894751"))
    runSingleEncryptTest(BigInt("92309815610039252942348423703189926244"), BigInt("135862049544848279351985781187864055357"), iv=BigInt("61390053221542313458431702038134617957"))
    runSingleEncryptTest(BigInt("50710124184285232762279720815140615256"), BigInt("200609637324564302280367033058732612181"))
    runSingleEncryptTest(BigInt("50710124184285232762279720815140615256"), BigInt("72496881599632472210852882012262104421"), iv=BigInt("104334950673992609687083619805319085926"))
    runSingleEncryptTest(BigInt("160034143850320306068907108836792803658"), BigInt("126213199672994408685108350979567427306"))
    runSingleEncryptTest(BigInt("160034143850320306068907108836792803658"), BigInt("82476160382664233906348525456604230070"), iv=BigInt("143937981050488765989682252397933044294"))
    setKey(BigInt("144202098580578919478184874624549547132"))
    runSingleEncryptTest(BigInt("162660125969128339589510702640203515474"), BigInt("290877676528401180803407717730381873263"))
    runSingleEncryptTest(BigInt("162660125969128339589510702640203515474"), BigInt("261693345402515466326784848876559596856"), iv=BigInt("81457526493466790792834324674286408818"))
    runSingleEncryptTest(BigInt("146694077978061048293652983028828428392"), BigInt("185468534350251786695041056600350951595"))
    runSingleEncryptTest(BigInt("146694077978061048293652983028828428392"), BigInt("249452472404993779362298502973068211007"), iv=BigInt("92372995632287018018015935492305730161"))
    runSingleEncryptTest(BigInt("48404503751661011659904736565417830976"), BigInt("143167925431933144730328007642925460786"))
    runSingleEncryptTest(BigInt("48404503751661011659904736565417830976"), BigInt("298876010616162009979823432065043611090"), iv=BigInt("139860610213390238594760789922351437107"))
    runSingleEncryptTest(BigInt("73524189129863793722644001323644633890"), BigInt("307370159353932622354450410934057591371"))
    runSingleEncryptTest(BigInt("73524189129863793722644001323644633890"), BigInt("89588583761157994512952058545256008632"), iv=BigInt("159695282709404733861986812277695347575"))
    runSingleEncryptTest(BigInt("48056948351378174457242639145176756529"), BigInt("172935009600455400161328958792606791538"))
    runSingleEncryptTest(BigInt("48056948351378174457242639145176756529"), BigInt("49864858816489595183828693088686691085"), iv=BigInt("117481926278278783340725079560224254842"))
    runSingleEncryptTest(BigInt("48471655727059045520403931063707706704"), BigInt("164750699092041236811541576998613106135"))
    runSingleEncryptTest(BigInt("48471655727059045520403931063707706704"), BigInt("88895657652793295177306440705864581512"), iv=BigInt("94796538947769998470311871790531378224"))
    runSingleEncryptTest(BigInt("110717728727627991306055188302836222323"), BigInt("123416024368185408450364517361416425527"))
    runSingleEncryptTest(BigInt("110717728727627991306055188302836222323"), BigInt("100540007128981686326652250037480952517"), iv=BigInt("53545222761637030787416590295816687412"))
    runSingleEncryptTest(BigInt("104236058092656057805384389019823856942"), BigInt("106004504762378838464714074124234447843"))
    runSingleEncryptTest(BigInt("104236058092656057805384389019823856942"), BigInt("110488183003501475925977620217828320870"), iv=BigInt("137353562507954595891216995527214257711"))
    runSingleEncryptTest(BigInt("84132902597533740882767158706481362756"), BigInt("224472248528628314749232959526778884360"))
    runSingleEncryptTest(BigInt("84132902597533740882767158706481362756"), BigInt("88308004128793557785114893702670629730"), iv=BigInt("76229214168058030277206389958196948301"))
    runSingleEncryptTest(BigInt("112057399704592716885904513854688092484"), BigInt("70177197063569926790228651335885023828"))
    runSingleEncryptTest(BigInt("112057399704592716885904513854688092484"), BigInt("221799804002761702509879356061642646204"), iv=BigInt("129207190827069379947501082474665758823"))
    setKey(BigInt("88079252711601298793306520049840374339"))
    runSingleEncryptTest(BigInt("143958887302953441957942908811057855019"), BigInt("89883035363553232570924393499334254528"))
    runSingleEncryptTest(BigInt("143958887302953441957942908811057855019"), BigInt("270810339639444417245172843165713416627"), iv=BigInt("42769708099713620407238726707433785657"))
    runSingleEncryptTest(BigInt("93556334176790521068627261903632888908"), BigInt("95502181254068199706863899208859836607"))
    runSingleEncryptTest(BigInt("93556334176790521068627261903632888908"), BigInt("18596526228439738214893917179610949105"), iv=BigInt("98613790941641415812686908842457723478"))
    runSingleEncryptTest(BigInt("161191497430180420682663749245072994152"), BigInt("313350893109054588523609350111261036929"))
    runSingleEncryptTest(BigInt("161191497430180420682663749245072994152"), BigInt("94915094319914883095843481080292035134"), iv=BigInt("154648328172541353521500385218259134016"))
    runSingleEncryptTest(BigInt("53601407493211539514934132606770500385"), BigInt("75862341436988046874874685957712953140"))
    runSingleEncryptTest(BigInt("53601407493211539514934132606770500385"), BigInt("124774387475771772812010201156569142897"), iv=BigInt("80363737186590155228254461035738709824"))
    runSingleEncryptTest(BigInt("110856804896475724004563252243875255143"), BigInt("98809558957259364485393780480603958060"))
    runSingleEncryptTest(BigInt("110856804896475724004563252243875255143"), BigInt("37817109739938162079317913963346177973"), iv=BigInt("142768904137256337512356088280080261925"))
    runSingleEncryptTest(BigInt("149326755023087308894212783978521783901"), BigInt("11959064773096735069321806759339633968"))
    runSingleEncryptTest(BigInt("149326755023087308894212783978521783901"), BigInt("261819380581618201365508670455151931524"), iv=BigInt("158419051677832606484014303530566176330"))
    runSingleEncryptTest(BigInt("161149433130739672842429274674259717158"), BigInt("119083491546344409846117512445844974140"))
    runSingleEncryptTest(BigInt("161149433130739672842429274674259717158"), BigInt("298209146313371058743429482635744041328"), iv=BigInt("65627939996738471449507594296546062157"))
    runSingleEncryptTest(BigInt("167801127104188628302268285082316335930"), BigInt("209774370582458890072879478074614455452"))
    runSingleEncryptTest(BigInt("167801127104188628302268285082316335930"), BigInt("194819532078474877302425296296197644064"), iv=BigInt("49410933947183128043520862152465725003"))
    runSingleEncryptTest(BigInt("150760150305128019166562950518909713699"), BigInt("89867611131009436560179480830550637614"))
    runSingleEncryptTest(BigInt("150760150305128019166562950518909713699"), BigInt("227331768880649052553360664171372401375"), iv=BigInt("114875700502502615582660185677975536432"))
    runSingleEncryptTest(BigInt("145364259664421204950131968881070715174"), BigInt("28853418206424706540285691065886369686"))
    runSingleEncryptTest(BigInt("145364259664421204950131968881070715174"), BigInt("283798770656627775972376145756625506624"), iv=BigInt("114513315231957122058798353874410754412"))
    setKey(BigInt("105440792096913599817237010834426580819"))
    runSingleEncryptTest(BigInt("86759816840612545533734015849188118651"), BigInt("131227837181044897271824829323594500125"))
    runSingleEncryptTest(BigInt("86759816840612545533734015849188118651"), BigInt("188083398909348730280257835833374146988"), iv=BigInt("88295929044670472430204295196580411758"))
    runSingleEncryptTest(BigInt("62838930641919664881681255787130611010"), BigInt("67833668928515435382442249638253650492"))
    runSingleEncryptTest(BigInt("62838930641919664881681255787130611010"), BigInt("125436653425497618833600934113494496112"), iv=BigInt("61343423969250145840172764848551250808"))
    runSingleEncryptTest(BigInt("137234803436712452735632996489782183753"), BigInt("167496169584515890405055960193356024035"))
    runSingleEncryptTest(BigInt("137234803436712452735632996489782183753"), BigInt("217274218068958240384333898053481823421"), iv=BigInt("61727007268797687630994547681985836069"))
    runSingleEncryptTest(BigInt("137409657523917013592075083007736427334"), BigInt("111048560525802399851024268930166413971"))
    runSingleEncryptTest(BigInt("137409657523917013592075083007736427334"), BigInt("188106812623076775609882619758124297096"), iv=BigInt("79074364346918482042568066989078563681"))
    runSingleEncryptTest(BigInt("52443586773581674650732114295230914172"), BigInt("97607703500014856628446781789004632355"))
    runSingleEncryptTest(BigInt("52443586773581674650732114295230914172"), BigInt("232907202564703433635219788670723347946"), iv=BigInt("141065764069066350239680277833179408995"))
    runSingleEncryptTest(BigInt("148163695826130860676889909025857749365"), BigInt("1513825062542995805057648336803034277"))
    runSingleEncryptTest(BigInt("148163695826130860676889909025857749365"), BigInt("231415145013885158408304609286540692711"), iv=BigInt("145101155924879762118651111868784003657"))
    runSingleEncryptTest(BigInt("129591179618526782945811712662337446764"), BigInt("53009819348696586614773105114225660906"))
    runSingleEncryptTest(BigInt("129591179618526782945811712662337446764"), BigInt("171471995788974892585735046573251437914"), iv=BigInt("150854298882055508272160671067743471420"))
    runSingleEncryptTest(BigInt("165449096805523613563098257566646027582"), BigInt("136400532173402202301048786686275605723"))
    runSingleEncryptTest(BigInt("165449096805523613563098257566646027582"), BigInt("273338465789795544146667773987265609496"), iv=BigInt("143952261691631247212679496526869245243"))
    runSingleEncryptTest(BigInt("106951589427913561027054858038334613351"), BigInt("196555430073047607931040582830589705458"))
    runSingleEncryptTest(BigInt("106951589427913561027054858038334613351"), BigInt("39357722220401096429417729421804524363"), iv=BigInt("74828282537683890512838977412487989315"))
    runSingleEncryptTest(BigInt("72408191614034987286749826254350800472"), BigInt("309537872397578628174184405977361741275"))
    runSingleEncryptTest(BigInt("72408191614034987286749826254350800472"), BigInt("229623120042219058548877935435616510852"), iv=BigInt("154627863532397078521231846764192228647"))
    setKey(BigInt("78976911984168848903377943568601004906"))
    runSingleEncryptTest(BigInt("84168825291980761851847059710822655810"), BigInt("67592996379260517849032352161361614310"))
    runSingleEncryptTest(BigInt("84168825291980761851847059710822655810"), BigInt("35026090915234644851624356325223181564"), iv=BigInt("85668763999542451982473046439571638097"))
    runSingleEncryptTest(BigInt("69370632992139774996769813120710504316"), BigInt("149315114283102476127487876240354181499"))
    runSingleEncryptTest(BigInt("69370632992139774996769813120710504316"), BigInt("283211598886617142568240034954142408747"), iv=BigInt("145183012072184498654066146905386872439"))
    runSingleEncryptTest(BigInt("96256614312652251238198318913284502595"), BigInt("272935020884342466349375254927159573128"))
    runSingleEncryptTest(BigInt("96256614312652251238198318913284502595"), BigInt("226998136554479357551253660535063122707"), iv=BigInt("126746506482296407843673348263491234134"))
    runSingleEncryptTest(BigInt("108192967966648367635434155919750888480"), BigInt("109998160491593818765316948585138572833"))
    runSingleEncryptTest(BigInt("108192967966648367635434155919750888480"), BigInt("21627889763756001559008566625823261376"), iv=BigInt("82802377870700602267333978424177818726"))
    runSingleEncryptTest(BigInt("94641201112243827979016433259369101921"), BigInt("16854507842436856621226323558871681929"))
    runSingleEncryptTest(BigInt("94641201112243827979016433259369101921"), BigInt("157178531045616460303083656057232115913"), iv=BigInt("145447883779544639718650166360430433141"))
    runSingleEncryptTest(BigInt("126786506084715826480665599139144947319"), BigInt("41703721971960471466905561784792280840"))
    runSingleEncryptTest(BigInt("126786506084715826480665599139144947319"), BigInt("220262443355068853848875305005329643368"), iv=BigInt("52188899049925473765639697406475194456"))
    runSingleEncryptTest(BigInt("145157947217707386629097550610397483109"), BigInt("102946381702066111782876413743530988708"))
    runSingleEncryptTest(BigInt("145157947217707386629097550610397483109"), BigInt("35388631065289727502609975948836714308"), iv=BigInt("94667605317639387488549751936383529259"))
    runSingleEncryptTest(BigInt("44105523291645787872975253335121740090"), BigInt("289032518063393165977791396855033060013"))
    runSingleEncryptTest(BigInt("44105523291645787872975253335121740090"), BigInt("178413188141858802107405151284537815130"), iv=BigInt("102591763871790532987802602232136299902"))
    runSingleEncryptTest(BigInt("61411393883219032861455182864155034171"), BigInt("250156820456728338062385403238577534608"))
    runSingleEncryptTest(BigInt("61411393883219032861455182864155034171"), BigInt("302895127726691103685580339576294260973"), iv=BigInt("57521224165839714330383361129090327142"))
    runSingleEncryptTest(BigInt("125546803454894411141697939106627287405"), BigInt("124405432932121082830575377311379262587"))
    runSingleEncryptTest(BigInt("125546803454894411141697939106627287405"), BigInt("289240099072120310280425959504352861756"), iv=BigInt("92103139036599856674540120905714582633"))
    setKey(BigInt("113417804212207820135325641278684484947"))
    runSingleDecryptTest(BigInt("230518268515072309513685916601547064777"), BigInt("52131454275561853609499849516283084152"))
    runSingleDecryptTest(BigInt("214972433893475461686449209017290224719"), BigInt("52131454275561853609499849516283084152"), iv=BigInt("74802445770888789796704655433555541291"))
    runSingleDecryptTest(BigInt("171338106181321344864156302804454971014"), BigInt("94860207391537786870105993952114605647"))
    runSingleDecryptTest(BigInt("66835300731490048644227919346218440808"), BigInt("94860207391537786870105993952114605647"), iv=BigInt("77699865229944822669252765893580568425"))
    runSingleDecryptTest(BigInt("199731942080837765802491391785342008495"), BigInt("149368293156504324639792369227434247997"))
    runSingleDecryptTest(BigInt("270064526174239498417000683430792999163"), BigInt("149368293156504324639792369227434247997"), iv=BigInt("80145076387304033878588001288852633641"))
    runSingleDecryptTest(BigInt("113041937169813706435331042461983845474"), BigInt("142705944456982884082995258285193319477"))
    runSingleDecryptTest(BigInt("24819379642635712622323113923798099123"), BigInt("142705944456982884082995258285193319477"), iv=BigInt("167672213357753420163094508441304908111"))
    runSingleDecryptTest(BigInt("35733387868800297694113568847094192219"), BigInt("59090514353545549769360967339257065506"))
    runSingleDecryptTest(BigInt("201876753758322815441431021107417126668"), BigInt("59090514353545549769360967339257065506"), iv=BigInt("153050261039976367847532108307592857160"))
    runSingleDecryptTest(BigInt("174165349047226104091568747358003560805"), BigInt("137332670507603092003577588889900965438"))
    runSingleDecryptTest(BigInt("250551483096890660733321489793019385231"), BigInt("137332670507603092003577588889900965438"), iv=BigInt("133209417872485918593943665500059750219"))
    runSingleDecryptTest(BigInt("7788892881902450430170999047949394448"), BigInt("58971272102809699278678802524153001597"))
    runSingleDecryptTest(BigInt("22543662321170691475157793315616247325"), BigInt("58971272102809699278678802524153001597"), iv=BigInt("162468111586006433223158902827109333102"))
    runSingleDecryptTest(BigInt("300687487571316680401148060291325054304"), BigInt("103909450448320552765303024851660923214"))
    runSingleDecryptTest(BigInt("23396188171109074431702664991025700820"), BigInt("103909450448320552765303024851660923214"), iv=BigInt("120104791397452534689081585767499446334"))
    runSingleDecryptTest(BigInt("163567096243028737350923295540399495591"), BigInt("110970522743796566943860260221221428789"))
    runSingleDecryptTest(BigInt("283884586901627749023795099594490175058"), BigInt("110970522743796566943860260221221428789"), iv=BigInt("114553151785896974321125802554386953040"))
    runSingleDecryptTest(BigInt("38075644779622652106602506647433475365"), BigInt("108064318052611359306750291607843123504"))
    runSingleDecryptTest(BigInt("225388594082765417765465051142992269905"), BigInt("108064318052611359306750291607843123504"), iv=BigInt("98857728286292834144175149918367134289"))
    setKey(BigInt("57334304465861878225200131989406690082"))
    runSingleDecryptTest(BigInt("169739963506951570706691283706762555885"), BigInt("153506020706950625556504508315311415895"))
    runSingleDecryptTest(BigInt("254805601592975292463028624657792266846"), BigInt("153506020706950625556504508315311415895"), iv=BigInt("75086804030766171378006453147204198982"))
    runSingleDecryptTest(BigInt("34345209931459279096199443801744088873"), BigInt("42910771941802336844247219015570182004"))
    runSingleDecryptTest(BigInt("155498739565430066850179079785644705620"), BigInt("42910771941802336844247219015570182004"), iv=BigInt("49623946244222128259129882544614306103"))
    runSingleDecryptTest(BigInt("284289882563140787078728957358591884536"), BigInt("62910826088247115422449418620287934056"))
    runSingleDecryptTest(BigInt("10491075217971228681665133885967409514"), BigInt("62910826088247115422449418620287934056"), iv=BigInt("145484084322496920650943567986461132635"))
    runSingleDecryptTest(BigInt("35454553608046298039483251905627847884"), BigInt("69485777334773425385531540741394297469"))
    runSingleDecryptTest(BigInt("276776759129761006380676874196178907785"), BigInt("69485777334773425385531540741394297469"), iv=BigInt("96193549716060871581119160973927467863"))
    runSingleDecryptTest(BigInt("281532439936542999246293082963809551010"), BigInt("69335284705865324632602829856050988412"))
    runSingleDecryptTest(BigInt("291175575255931881297400843778723403700"), BigInt("69335284705865324632602829856050988412"), iv=BigInt("137098997188367234201584217218185832291"))
    runSingleDecryptTest(BigInt("9554665761532100236857712072686792444"), BigInt("62947517741182842452858396391158019667"))
    runSingleDecryptTest(BigInt("152784310236065441038506577043158326122"), BigInt("62947517741182842452858396391158019667"), iv=BigInt("166570630384279487772628216799906456914"))
    runSingleDecryptTest(BigInt("71104711522246051257522658002979006164"), BigInt("125240015139039736104689192893832191808"))
    runSingleDecryptTest(BigInt("102019437165554977765353124407335467003"), BigInt("125240015139039736104689192893832191808"), iv=BigInt("89678459380041138010578014507391075672"))
    runSingleDecryptTest(BigInt("210553811011583536368824864005396205762"), BigInt("94905839982320374196140064630508896874"))
    runSingleDecryptTest(BigInt("6695299122745696448008595290043039995"), BigInt("94905839982320374196140064630508896874"), iv=BigInt("150837545754613228987898866366304184188"))
    runSingleDecryptTest(BigInt("228803320908878505700908664776015869629"), BigInt("61603160973915614683271946266850773053"))
    runSingleDecryptTest(BigInt("335540707348380064609727903310297991120"), BigInt("61603160973915614683271946266850773053"), iv=BigInt("135992610982393002144593704452115682888"))
    runSingleDecryptTest(BigInt("112281869023468595844836705653159959776"), BigInt("150589149006179209359485521861132035449"))
    runSingleDecryptTest(BigInt("196900750239960571391723285939206209494"), BigInt("150589149006179209359485521861132035449"), iv=BigInt("138714507503645677026781371143803517733"))
    setKey(BigInt("166725856648844295879077995785162227054"))
    runSingleDecryptTest(BigInt("164530618784456653034171398108687748202"), BigInt("142815509306363442662267688042680690991"))
    runSingleDecryptTest(BigInt("53780544668426712180654595693135959702"), BigInt("142815509306363442662267688042680690991"), iv=BigInt("130822153848702718268914924225390143325"))
    runSingleDecryptTest(BigInt("210721896579219483512593389508127658831"), BigInt("85347332717610770474644624882485508662"))
    runSingleDecryptTest(BigInt("313428829973030071864627417187004403454"), BigInt("85347332717610770474644624882485508662"), iv=BigInt("133351030911332124149254855151971742060"))
    runSingleDecryptTest(BigInt("194580382594351334097551104222854889892"), BigInt("121267742605158967405374009821379126826"))
    runSingleDecryptTest(BigInt("205570660314442739030052958442371464552"), BigInt("121267742605158967405374009821379126826"), iv=BigInt("60248435469445368940160634314645516581"))
    runSingleDecryptTest(BigInt("48972682912946227409036017775378453250"), BigInt("47033066480949903487871803629035407993"))
    runSingleDecryptTest(BigInt("223235246576231089364708790031516390458"), BigInt("47033066480949903487871803629035407993"), iv=BigInt("72044807063864720086671198941686802275"))
    runSingleDecryptTest(BigInt("191352375319131431764171756005465033994"), BigInt("47090349160497702813845037359755186260"))
    runSingleDecryptTest(BigInt("292456937053009063986662760883632377176"), BigInt("47090349160497702813845037359755186260"), iv=BigInt("101231301123118827666206876646438563624"))
    runSingleDecryptTest(BigInt("22146914759177199580983252733819360902"), BigInt("138641043122214877390024932588496772452"))
    runSingleDecryptTest(BigInt("89536493139013867886417536109274961323"), BigInt("138641043122214877390024932588496772452"), iv=BigInt("130572578092582505770010845908690886776"))
    runSingleDecryptTest(BigInt("127350635575983442356623056075985221245"), BigInt("45635913170479732232549744425049083240"))
    runSingleDecryptTest(BigInt("60412315605500906698584578923273023158"), BigInt("45635913170479732232549744425049083240"), iv=BigInt("108251018276421650565116416008590934319"))
    runSingleDecryptTest(BigInt("109784747716533079171396726563167803878"), BigInt("78747396451495456719988329075011961185"))
    runSingleDecryptTest(BigInt("185808958461553598038904501951400789487"), BigInt("78747396451495456719988329075011961185"), iv=BigInt("144040425739504760459559669556938481760"))
    runSingleDecryptTest(BigInt("137741106678866228350126188245358245626"), BigInt("105561737392432825622570389287876639797"))
    runSingleDecryptTest(BigInt("9563430848334742767719560583939413718"), BigInt("105561737392432825622570389287876639797"), iv=BigInt("102746169077111815948851024713974040878"))
    runSingleDecryptTest(BigInt("163064466121494256803857903628271930321"), BigInt("85628138478264356124133463170918607436"))
    runSingleDecryptTest(BigInt("57480400465470582871794426259620139295"), BigInt("85628138478264356124133463170918607436"), iv=BigInt("53528934648263063898801637916863639352"))
    setKey(BigInt("95918728548457244290220239710732830761"))
    runSingleDecryptTest(BigInt("293753517320060910738655771020281953083"), BigInt("129388354036999487575775058096421034351"))
    runSingleDecryptTest(BigInt("135164604101897142132864353474212634604"), BigInt("129388354036999487575775058096421034351"), iv=BigInt("141522163442390473466652272421675542389"))
    runSingleDecryptTest(BigInt("275560887593967189316220598287219521397"), BigInt("83924276934567190806722478774715901519"))
    runSingleDecryptTest(BigInt("260266249680492735925489675010772813996"), BigInt("83924276934567190806722478774715901519"), iv=BigInt("72158326502475708156971914911899940693"))
    runSingleDecryptTest(BigInt("304838599027048719952101295691193542302"), BigInt("96200166223597281203183293884842588471"))
    runSingleDecryptTest(BigInt("263181264501791235338634675795504833020"), BigInt("96200166223597281203183293884842588471"), iv=BigInt("149441714601840485541878613520205174063"))
    runSingleDecryptTest(BigInt("339767705381887871107985149644727770106"), BigInt("57438125365952597429749146007258357553"))
    runSingleDecryptTest(BigInt("253069126216628154540538844884688343094"), BigInt("57438125365952597429749146007258357553"), iv=BigInt("52190339967325833195512640888518698814"))
    runSingleDecryptTest(BigInt("74150953820224144310269138516465226643"), BigInt("81566995655059395185840606088001322357"))
    runSingleDecryptTest(BigInt("199166766429091020860820980744248607142"), BigInt("81566995655059395185840606088001322357"), iv=BigInt("138708746675125650882294080343247118123"))
    runSingleDecryptTest(BigInt("218965147604926753270621312722798079403"), BigInt("126621404889927875861036516996538190179"))
    runSingleDecryptTest(BigInt("52888857452772708033890974314245780084"), BigInt("126621404889927875861036516996538190179"), iv=BigInt("110924811982972299085525006322010307909"))
    runSingleDecryptTest(BigInt("86070354163091763243806278652909395418"), BigInt("117332185588781092488702300355464669817"))
    runSingleDecryptTest(BigInt("339569182235498698306292008144664768"), BigInt("117332185588781092488702300355464669817"), iv=BigInt("106537744505635278506734296238282783334"))
    runSingleDecryptTest(BigInt("87141267182623980574113500183651448268"), BigInt("110758776438785509697938340082484849747"))
    runSingleDecryptTest(BigInt("5895073554113533903184645564757211110"), BigInt("110758776438785509697938340082484849747"), iv=BigInt("53704659597447407777417428250621601325"))
    runSingleDecryptTest(BigInt("312491425491487928859224463802643047432"), BigInt("138677350221846106812200464524664389153"))
    runSingleDecryptTest(BigInt("16823489850420228905941489860182336298"), BigInt("138677350221846106812200464524664389153"), iv=BigInt("68140850905960968793202192021071155257"))
    runSingleDecryptTest(BigInt("209668677947563986950407711991361182893"), BigInt("102648612589629461327224613501162316086"))
    runSingleDecryptTest(BigInt("110855530554927523213398526204748139515"), BigInt("102648612589629461327224613501162316086"), iv=BigInt("77267973882579187823542844841152897586"))
    setKey(BigInt("82610750308817887289175053282831449638"))
    runSingleDecryptTest(BigInt("211075132327426841515168401688488819010"), BigInt("93275481245639152967593130730930859372"))
    runSingleDecryptTest(BigInt("251683588831167443851168937045381247496"), BigInt("93275481245639152967593130730930859372"), iv=BigInt("96234971466399287356808501629439067457"))
    runSingleDecryptTest(BigInt("202093668491491347314192908927690543455"), BigInt("53533478122141546172615367346038012765"))
    runSingleDecryptTest(BigInt("141271409904016223654592518439993470341"), BigInt("53533478122141546172615367346038012765"), iv=BigInt("135935577003837104999962254442489337914"))
    runSingleDecryptTest(BigInt("215485310564144266963803760410508186590"), BigInt("81697125294138905312437750929416344683"))
    runSingleDecryptTest(BigInt("9225259151658665881291332632013922926"), BigInt("81697125294138905312437750929416344683"), iv=BigInt("137540282663894041913232236101117425779"))
    runSingleDecryptTest(BigInt("331159468602519118272706953884536843598"), BigInt("48139777182602234055304165885642430069"))
    runSingleDecryptTest(BigInt("299895977468634930399503679372809491794"), BigInt("48139777182602234055304165885642430069"), iv=BigInt("109444377420599441534185208864285339433"))
    runSingleDecryptTest(BigInt("282334773939155540588396325355429084134"), BigInt("152146799320559693969968142527063677821"))
    runSingleDecryptTest(BigInt("219877406478389056241866715052648713342"), BigInt("152146799320559693969968142527063677821"), iv=BigInt("66769999295743267455543472702483823995"))
    runSingleDecryptTest(BigInt("81782758980918013499422763885005452793"), BigInt("108016593151043326653413162465464692780"))
    runSingleDecryptTest(BigInt("195286216636271892538786359228766741669"), BigInt("108016593151043326653413162465464692780"), iv=BigInt("128091314844852079200650010935570101826"))
    runSingleDecryptTest(BigInt("277145551025867633520382222682315009786"), BigInt("92368089524246683488618196248204292976"))
    runSingleDecryptTest(BigInt("198334583230259060145057860394726514322"), BigInt("92368089524246683488618196248204292976"), iv=BigInt("45584720197797151253135096748071743866"))
    runSingleDecryptTest(BigInt("36524450096751271140935595091767789703"), BigInt("137327250041055778851790484899880588849"))
    runSingleDecryptTest(BigInt("268939077404582486161807996925573303240"), BigInt("137327250041055778851790484899880588849"), iv=BigInt("86748684085243057197436836892678843734"))
    runSingleDecryptTest(BigInt("225252964669309540237370169338145890287"), BigInt("77580120801806815313457329334172867642"))
    runSingleDecryptTest(BigInt("252529751244798053888008433256601224212"), BigInt("77580120801806815313457329334172867642"), iv=BigInt("130733886395722254215925971641210458919"))
    runSingleDecryptTest(BigInt("173485495435620906333466514614749537348"), BigInt("153419215095480344358221076017782531631"))
    runSingleDecryptTest(BigInt("165427158609116518061562585972661494441"), BigInt("153419215095480344358221076017782531631"), iv=BigInt("146424665316055837899142386963716909894"))
    setKey(BigInt("78940261021360844165680799522102983523"))
    runSingleDecryptTest(BigInt("40552120992136922209037549811523246062"), BigInt("100316721779388442523126835056081579849"))
    runSingleDecryptTest(BigInt("15359837406532558822767544916653519722"), BigInt("100316721779388442523126835056081579849"), iv=BigInt("130592701174364365407207404812274050132"))
    runSingleDecryptTest(BigInt("254577563558612546058817433557091266228"), BigInt("85580720587356812353371290674065398863"))
    runSingleDecryptTest(BigInt("89116812529799163245967939537361780318"), BigInt("85580720587356812353371290674065398863"), iv=BigInt("109548482444422764280493192101809957959"))
    runSingleDecryptTest(BigInt("286919378785806160117199834506685554081"), BigInt("138470042187167997452140133512517338680"))
    runSingleDecryptTest(BigInt("221170492079784168790656469570108748156"), BigInt("138470042187167997452140133512517338680"), iv=BigInt("138614964610499412181009699677371855200"))
    runSingleDecryptTest(BigInt("191968426504413276697011534427367867572"), BigInt("81650698863453429297793501231847726130"))
    runSingleDecryptTest(BigInt("289111215735477815707181883864156765315"), BigInt("81650698863453429297793501231847726130"), iv=BigInt("97201199797096463196393634177921085752"))
    runSingleDecryptTest(BigInt("323554493981444434822673573510385014309"), BigInt("57730170211483123435997808595848883004"))
    runSingleDecryptTest(BigInt("80394015115320338110509169992318996345"), BigInt("57730170211483123435997808595848883004"), iv=BigInt("154737452645642128337377483710751652668"))
    runSingleDecryptTest(BigInt("338796028207336222070240225418086226628"), BigInt("132135000003825204340818925245254689899"))
    runSingleDecryptTest(BigInt("32179007336358793445373970120013315200"), BigInt("132135000003825204340818925245254689899"), iv=BigInt("161155757921800372661661687651123607923"))
    runSingleDecryptTest(BigInt("240865951113957263396033484228655029912"), BigInt("142452740744607820928799119520246016032"))
    runSingleDecryptTest(BigInt("319074011577855939221146969133686374875"), BigInt("142452740744607820928799119520246016032"), iv=BigInt("130489806277227734557601908736173223513"))
    runSingleDecryptTest(BigInt("339905546873882323612691705969003458404"), BigInt("50958076624338421242566961835371939192"))
    runSingleDecryptTest(BigInt("32891945765351633481944658628394548321"), BigInt("50958076624338421242566961835371939192"), iv=BigInt("140182548307693621733993098838534082866"))
    runSingleDecryptTest(BigInt("29685830596065284864324730597093877405"), BigInt("75061090634230646717832729334661604220"))
    runSingleDecryptTest(BigInt("296241609799854771002393744459646785808"), BigInt("75061090634230646717832729334661604220"), iv=BigInt("119948716263420230086991129435881294413"))
    runSingleDecryptTest(BigInt("137748669566847026822787073059439913532"), BigInt("53498470759974967841425869765655930735"))
    runSingleDecryptTest(BigInt("234090539887238387146064495503324073319"), BigInt("53498470759974967841425869765655930735"), iv=BigInt("166384400238166196421633975215015355515"))
    setKey(BigInt("149099224180335609175270702861178400811"))
    runSingleDecryptTest(BigInt("238042957759387400999253991643840249515"), BigInt("158647148310460110197706969268157687079"))
    runSingleDecryptTest(BigInt("196411612326228862121091278982856737108"), BigInt("158647148310460110197706969268157687079"), iv=BigInt("142711904777691486683877504929067704414"))
    runSingleDecryptTest(BigInt("256631527094788561185201264246352031338"), BigInt("150666139446233322571297209944100856425"))
    runSingleDecryptTest(BigInt("221130416953306081394938613757934211484"), BigInt("150666139446233322571297209944100856425"), iv=BigInt("48144420507491402846475441589720284014"))
    runSingleDecryptTest(BigInt("269218776272350799341556541761136513235"), BigInt("102948508147851581325209881578315599397"))
    runSingleDecryptTest(BigInt("254873183692447372510513928912063515440"), BigInt("102948508147851581325209881578315599397"), iv=BigInt("44260155502972821987923532171195398004"))
    runSingleDecryptTest(BigInt("321792421930479795292710087096055819479"), BigInt("142763588247000957641189042573970793812"))
    runSingleDecryptTest(BigInt("110095661839798781335627942702515230533"), BigInt("142763588247000957641189042573970793812"), iv=BigInt("129586414056587680615939682190646016893"))
    runSingleDecryptTest(BigInt("63869691828478728396407518192297080745"), BigInt("162613169792770587058348408699573327399"))
    runSingleDecryptTest(BigInt("20873510689818946292625728627395806999"), BigInt("162613169792770587058348408699573327399"), iv=BigInt("89366151380693069910217358890950621759"))
    runSingleDecryptTest(BigInt("180990282053847727920420653244733470014"), BigInt("52256983698660185393014469633253533775"))
    runSingleDecryptTest(BigInt("243856706892117194890997670000071764879"), BigInt("52256983698660185393014469633253533775"), iv=BigInt("81438100310682471375374792262526853725"))
    runSingleDecryptTest(BigInt("57878906038046454703390592700105219137"), BigInt("85279301938190857163099475594453066566"))
    runSingleDecryptTest(BigInt("136137372747582605502714348630290367689"), BigInt("85279301938190857163099475594453066566"), iv=BigInt("157505454164554846277966810246106130794"))
    runSingleDecryptTest(BigInt("212020207243703904142967974123526730595"), BigInt("105664522837186649934950975429320057191"))
    runSingleDecryptTest(BigInt("70236195600981771393078707293487940104"), BigInt("105664522837186649934950975429320057191"), iv=BigInt("117244466093170169348939274571013241140"))
    runSingleDecryptTest(BigInt("187990521870699625781643091452228199016"), BigInt("62864137318578349425490283281666688814"))
    runSingleDecryptTest(BigInt("319495510750446907039042953987907250717"), BigInt("62864137318578349425490283281666688814"), iv=BigInt("163937406820026224146029767208210094960"))
    runSingleDecryptTest(BigInt("122341590085540769538775035187828777258"), BigInt("93571178814703488639640122028634227508"))
    runSingleDecryptTest(BigInt("288877004120770814515045904354406882287"), BigInt("93571178814703488639640122028634227508"), iv=BigInt("117529128188058083564535711303798173753"))
    setKey(BigInt("53497173563041300744796119194667329599"))
    runSingleDecryptTest(BigInt("178234061508982884294815809417738829526"), BigInt("108162143611906495489861933780071439689"))
    runSingleDecryptTest(BigInt("194272038524395918513137226936934288571"), BigInt("108162143611906495489861933780071439689"), iv=BigInt("50932279054755263310290897800838200388"))
    runSingleDecryptTest(BigInt("53114291099819558662039507080217757943"), BigInt("82637739784765911650564015555526221388"))
    runSingleDecryptTest(BigInt("153817939225851084178321108123527306115"), BigInt("82637739784765911650564015555526221388"), iv=BigInt("78712064816505302780953174587348436262"))
    runSingleDecryptTest(BigInt("197384451692615712290446476489877898536"), BigInt("97663763743257992615443542539456558454"))
    runSingleDecryptTest(BigInt("117043280697649016311649642524916661101"), BigInt("97663763743257992615443542539456558454"), iv=BigInt("81260199476146687292292635367357178198"))
    runSingleDecryptTest(BigInt("67632358857588743811572704780835304859"), BigInt("52219621733933098017436911936992012834"))
    runSingleDecryptTest(BigInt("206069647606180523961303253321413165696"), BigInt("52219621733933098017436911936992012834"), iv=BigInt("102964916057425496462689839534683024217"))
    runSingleDecryptTest(BigInt("209952914303841665598901943998596450194"), BigInt("60196128067590742589525064430521371479"))
    runSingleDecryptTest(BigInt("79822771362873271694261592131615416104"), BigInt("60196128067590742589525064430521371479"), iv=BigInt("62760228064840246678736698438575737204"))
    runSingleDecryptTest(BigInt("230336549563345838075569044046199587677"), BigInt("88223069079112391582561899418725808488"))
    runSingleDecryptTest(BigInt("17084482589476583448397157611616780897"), BigInt("88223069079112391582561899418725808488"), iv=BigInt("60352259855297091862992223960072337737"))
    runSingleDecryptTest(BigInt("183721361815353852656776255538906751595"), BigInt("69422048250931475260587215325512825196"))
    runSingleDecryptTest(BigInt("34496817054360657701755679743266160423"), BigInt("69422048250931475260587215325512825196"), iv=BigInt("166389716205531796568483568508590449455"))
    runSingleDecryptTest(BigInt("311496679621582345868387833620626208353"), BigInt("147893333604319375002397972169978168115"))
    runSingleDecryptTest(BigInt("49262349919647600044452231119369523345"), BigInt("147893333604319375002397972169978168115"), iv=BigInt("105223749895483017914567081650165140518"))
    runSingleDecryptTest(BigInt("57361895263224092374420376382515345679"), BigInt("84127042495205029761044802979233606702"))
    runSingleDecryptTest(BigInt("87984558792741304095613740030799017567"), BigInt("84127042495205029761044802979233606702"), iv=BigInt("161041631110133750391767714694470123126"))
    runSingleDecryptTest(BigInt("71379950409023926470714192025911631122"), BigInt("165251544611195013499872535840074656593"))
    runSingleDecryptTest(BigInt("206376730220783662405116941690505403757"), BigInt("165251544611195013499872535840074656593"), iv=BigInt("145094282095946083547038306714661570118"))
    setKey(BigInt("130903891555869806715732439789398286971"))
    runSingleDecryptTest(BigInt("88281171097560537525976407905013534757"), BigInt("49770323189556077423837616875366469735"))
    runSingleDecryptTest(BigInt("124645603611369561824458330104219129322"), BigInt("49770323189556077423837616875366469735"), iv=BigInt("57740395165169951525379310455268453467"))
    runSingleDecryptTest(BigInt("189855197547155399447317442014379311251"), BigInt("70933493902307524960327177328598986555"))
    runSingleDecryptTest(BigInt("96850191510516203600639342919200550284"), BigInt("70933493902307524960327177328598986555"), iv=BigInt("131921950086398970039367737129048242750"))
    runSingleDecryptTest(BigInt("98282050841440164250532037709171724303"), BigInt("134855757679716319018625657843471774805"))
    runSingleDecryptTest(BigInt("129809769943835120208304220467039550598"), BigInt("134855757679716319018625657843471774805"), iv=BigInt("125275745849176608441916728092699678497"))
    runSingleDecryptTest(BigInt("307655337567494547879505894936994901904"), BigInt("159882247772831083215310082811230959195"))
    runSingleDecryptTest(BigInt("163611741456636343453921353912951828295"), BigInt("159882247772831083215310082811230959195"), iv=BigInt("61784406974482779241355990068511650159"))
    runSingleDecryptTest(BigInt("249980748672777460203060372816591471582"), BigInt("131767033673513362805058372859593912435"))
    runSingleDecryptTest(BigInt("288580992109846875873456294312505686375"), BigInt("131767033673513362805058372859593912435"), iv=BigInt("52251755973230668049723720359280067384"))
    runSingleDecryptTest(BigInt("217376538971516604412440312292419570943"), BigInt("143885769353149968782539002303125996395"))
    runSingleDecryptTest(BigInt("32197004006316480553034105077657946493"), BigInt("143885769353149968782539002303125996395"), iv=BigInt("121144016580891751708880555996668502394"))
    runSingleDecryptTest(BigInt("117556798462932956748434008341407740796"), BigInt("70980633618892184725644338388708371066"))
    runSingleDecryptTest(BigInt("284555559525920621969633142843720367838"), BigInt("70980633618892184725644338388708371066"), iv=BigInt("154452280676396893763424787422567216451"))
    runSingleDecryptTest(BigInt("87233100946352592806731617291392042697"), BigInt("133536795602830029228812621117410263415"))
    runSingleDecryptTest(BigInt("337482038416185834830966168935516564854"), BigInt("133536795602830029228812621117410263415"), iv=BigInt("133339505911446478874526133132463472197"))
    runSingleDecryptTest(BigInt("66164201572085475695701410861919345324"), BigInt("137124837611772190647852691330808368180"))
    runSingleDecryptTest(BigInt("72358862299727232459487242717132679323"), BigInt("137124837611772190647852691330808368180"), iv=BigInt("85441154314658797179030593646501897307"))
    runSingleDecryptTest(BigInt("337548582783940622804408444917458247400"), BigInt("130764497138916105395208935866345613360"))
    runSingleDecryptTest(BigInt("325251411477134486039840853535672512424"), BigInt("130764497138916105395208935866345613360"), iv=BigInt("107949055597782375819841651760763776842"))
    setKey(BigInt("158496569617773097636251144507873392445"))
    runSingleDecryptTest(BigInt("41212808468588781928869420703392523890"), BigInt("122857013830524663956449582748081084454"))
    runSingleDecryptTest(BigInt("270993690809453920888991620235301446937"), BigInt("122857013830524663956449582748081084454"), iv=BigInt("162489772338463590641553511169147424045"))
    runSingleDecryptTest(BigInt("223022497996508172785319609863286875294"), BigInt("129414009938182528967483391332790451314"))
    runSingleDecryptTest(BigInt("191137433935886871564184378411775070536"), BigInt("129414009938182528967483391332790451314"), iv=BigInt("68357488992896916393173109550728620411"))
    runSingleDecryptTest(BigInt("219574286273492095134079609082289463119"), BigInt("94839233335249497159173989952407494264"))
    runSingleDecryptTest(BigInt("64343832291160778873956254553491562694"), BigInt("94839233335249497159173989952407494264"), iv=BigInt("158719375467697903814943826281309425445"))
    runSingleDecryptTest(BigInt("326382932375812865873336276457769033576"), BigInt("77563876020871226864785042308079368271"))
    runSingleDecryptTest(BigInt("321121440156151671171939272081540864596"), BigInt("77563876020871226864785042308079368271"), iv=BigInt("111869018579454459251703272816124967799"))
    runSingleDecryptTest(BigInt("230828384854428704513477490814138610898"), BigInt("117472074568250536827399785537737095716"))
    runSingleDecryptTest(BigInt("24435956917323073033880004106097640324"), BigInt("117472074568250536827399785537737095716"), iv=BigInt("113157617821952572616753731929342493995"))
    runSingleDecryptTest(BigInt("62705036517920851618396369398361032551"), BigInt("97662889389013113329962830327361121146"))
    runSingleDecryptTest(BigInt("241880821853915669328303142956599712245"), BigInt("97662889389013113329962830327361121146"), iv=BigInt("153500894016881573707182075211886978350"))
    runSingleDecryptTest(BigInt("308534335444877742505083922262531332666"), BigInt("87974714546146774271537333122601990505"))
    runSingleDecryptTest(BigInt("125979503002605174525002055165774003509"), BigInt("87974714546146774271537333122601990505"), iv=BigInt("114689849451000642106229707240959404866"))
    runSingleDecryptTest(BigInt("311288784683351991373822047451705120304"), BigInt("137166558129370840695277689801664323645"))
    runSingleDecryptTest(BigInt("97870482838306019983973156323866925287"), BigInt("137166558129370840695277689801664323645"), iv=BigInt("59983124810539040008213899079514350880"))
    runSingleDecryptTest(BigInt("229850388580544984896001841191550876939"), BigInt("125135111017852248165310092282363862365"))
    runSingleDecryptTest(BigInt("322578084719486562488860312791837970111"), BigInt("125135111017852248165310092282363862365"), iv=BigInt("71052108903597576107229618326741866328"))
    runSingleDecryptTest(BigInt("18233013574573391658485828245677292227"), BigInt("64048978653202050692410942999239808801"))
    runSingleDecryptTest(BigInt("113629946262803001165706057087734995000"), BigInt("64048978653202050692410942999239808801"), iv=BigInt("101485315467745940433742504463054501421"))

    setKey(BigInt("77480659682196824781536209242280568617"))

    assertError { runSingleDecryptTest(BigInt("285620521974381805374183171356809032743"), BigInt("78732626654880918153396673645234369074"), iv=BigInt("147981112317427754652321488608020016728")) }
    assertError { runSingleDecryptTest(BigInt("193102151738919742469920448191206198811"), BigInt("138531862892119456316820873688573960762")) }
    assertError { runSingleDecryptTest(BigInt("173577793028898773428655398731547059119"), BigInt("138531862892119456316820873688573960762"), iv=BigInt("68078054275351338050152113982098793760")) }
    assertError { runSingleDecryptTest(BigInt("49706086182423641475700416514958935121"), BigInt("86919746956773577147522875398327975231")) }

}
