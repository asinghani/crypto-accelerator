// Copyright 2020 Anish Singhani
//
// SPDX-License-Identifier: Apache-2.0
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     https://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
package tests.aes

import aes128.Aes128Wishbone
import chisel3.iotesters.PeekPokeTester

class Aes128WishboneTest(dut: Aes128Wishbone) extends PeekPokeTester(dut) {
    assert(!dut.LIMIT_KEY_LENGTH)

    poke(dut.io.bus.stb, false)
    poke(dut.io.bus.cyc, false)
    poke(dut.io.bus.we, false)
    poke(dut.io.bus.sel, 0xF)

    // 0x00 = status    // RW
    // 0x04 = encStart  // WO
    // 0x08 = decStart  // WO
    // 0x10 = data[0]   // RW
    // 0x14 = data[4]   // RW
    // 0x18 = data[8]   // RW
    // 0x1C = data[C]   // RW
    // 0x20 = iv[0]     // RW
    // 0x24 = iv[4]     // RW
    // 0x28 = iv[8]     // RW
    // 0x2C = iv[C]     // RW
    // 0x30 = out[0]    // RO
    // 0x34 = out[4]    // RO
    // 0x38 = out[8]    // RO
    // 0x3C = out[C]    // RO
    // 0x40 = key[0]    // RW
    // 0x44 = key[4]    // RW
    // 0x48 = key[8]    // RW
    // 0x4C = key[C]    // RW

    def wishboneWrite(addr: Long, data: Long) : Unit = {
        poke(dut.io.bus.addr, addr)
        poke(dut.io.bus.data_wr, data)
        poke(dut.io.bus.we, true)
        poke(dut.io.bus.cyc, true)
        poke(dut.io.bus.stb, true)
        while(peek(dut.io.bus.ack) != 1) step(1)
        poke(dut.io.bus.cyc, false)
        poke(dut.io.bus.stb, false)
        step(1)
        expect(dut.io.bus.ack, 0)
    }

    def wishboneRead(addr: Long) : Long = {
        poke(dut.io.bus.addr, addr)
        poke(dut.io.bus.we, false)
        poke(dut.io.bus.cyc, true)
        poke(dut.io.bus.stb, true)
        while(peek(dut.io.bus.ack) != 1) step(1)
        poke(dut.io.bus.cyc, false)
        poke(dut.io.bus.stb, false)
        val data_out = peek(dut.io.bus.data_rd).toLong
        step(1)
        expect(dut.io.bus.ack, 0)
        return data_out
    }

    def setKey(key: BigInt): Unit = {
        wishboneWrite(0x40, ((key >> 96) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x40, ((key >> 64) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x40, ((key >> 32) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x40, ((key >> 0)  & 0xFFFFFFFFl).toLong)

        wishboneWrite(0x0C, 1)

        step(1)
        while ((wishboneRead(0x00) & 0x3) != 0x3) step(1)
    }

    def setIv(iv: BigInt = BigInt(0)): Unit = {
        wishboneWrite(0x00, 0x0)

        wishboneWrite(0x10, ((iv >> 96) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((iv >> 64) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((iv >> 32) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((iv >> 0)  & 0xFFFFFFFFl).toLong)

        wishboneWrite(0x08, 1)
        step(1)
        assert((wishboneRead(0x00) & 0x4) != 0x4)
        while ((wishboneRead(0x00) & 0x4) != 0x4) step(1)

        wishboneWrite(0x00, 0x8)
    }

    def runSingleDecryptTest(ciphertext: BigInt, plaintext: BigInt, iv: BigInt = BigInt(0)): Unit = {
        if (iv != 0) setIv(iv)
        wishboneWrite(0x00, if (iv != 0) { 0x8 } else { 0x0 })

        wishboneWrite(0x10, ((ciphertext >> 96) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((ciphertext >> 64) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((ciphertext >> 32) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((ciphertext >> 0)  & 0xFFFFFFFFl).toLong)

        wishboneWrite(0x08, 1)
        step(1)
        assert((wishboneRead(0x00) & 0x4) != 0x4)
        while ((wishboneRead(0x00) & 0x4) != 0x4) step(1)

        val out = (BigInt(wishboneRead(0x30)) << 96) | (BigInt(wishboneRead(0x34)) << 64) |
                  (BigInt(wishboneRead(0x38)) << 32) | (BigInt(wishboneRead(0x3C)) << 0)

        assert(out == plaintext)
    }

    def runSingleEncryptTest(plaintext: BigInt, ciphertext: BigInt, iv: BigInt = BigInt(0)): Unit = {
        if (iv != 0) setIv(iv)
        wishboneWrite(0x00, if (iv != 0) { 0x8 } else { 0x0 })

        wishboneWrite(0x10, ((plaintext >> 96) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((plaintext >> 64) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((plaintext >> 32) & 0xFFFFFFFFl).toLong)
        wishboneWrite(0x10, ((plaintext >> 0)  & 0xFFFFFFFFl).toLong)

        wishboneWrite(0x04, 1)
        step(2)
        assert((wishboneRead(0x00) & 0x4) != 0x4)
        while ((wishboneRead(0x00) & 0x4) != 0x4) step(1)

        val out = (BigInt(wishboneRead(0x30)) << 96) | (BigInt(wishboneRead(0x34)) << 64) |
            (BigInt(wishboneRead(0x38)) << 32) | (BigInt(wishboneRead(0x3C)) << 0)

        assert(out == ciphertext)
    }

    setKey(BigInt("129445976579865719297921356551604413220"))
    runSingleDecryptTest(BigInt("30614575354952859734368363414031006605"), BigInt("138766332635719238849554048983485396278"))

    setKey(BigInt("77480659682196824781536209242280568617"))
    runSingleDecryptTest(BigInt("108168270634000394736752434854797242083"), BigInt("141123105032041655060716409566795293791"))
    runSingleDecryptTest(BigInt("183741596611713424932424710302674779678"), BigInt("141123105032041655060716409566795293791"), iv=BigInt("82999517049282736278697283449288677672"))
    runSingleDecryptTest(BigInt("300612637423229317006463393945750264978"), BigInt("53533723263096188494879905935507858290"))
    runSingleDecryptTest(BigInt("191269884928480092850775886794089116221"), BigInt("53533723263096188494879905935507858290"), iv=BigInt("114569600669659166774737151663344146729"))
    runSingleDecryptTest(BigInt("103522583274007989084648569150893738254"), BigInt("78732626654880918153396673645234369074"))

    setKey(BigInt("129445976579865719297921356551604413220"))
    runSingleEncryptTest(BigInt("138766332635719238849554048983485396278"), BigInt("30614575354952859734368363414031006605"))

    setKey(BigInt("114849718896073566083416993308083054187"))
    runSingleEncryptTest(BigInt("54758945827980741386470298169332301409"), BigInt("289445855507223381064146989315641296578"))
    runSingleEncryptTest(BigInt("54758945827980741386470298169332301409"), BigInt("63241459423936053969797744104158954336"), iv=BigInt("94605682877008349257125771496548550738"))
    runSingleEncryptTest(BigInt("63009363580684677640861982505439019373"), BigInt("307084774739159377437930299938971018023"))
    runSingleEncryptTest(BigInt("63009363580684677640861982505439019373"), BigInt("121285145432821926259489755756437457204"), iv=BigInt("60013523246785301651415126051136829294"))
    runSingleEncryptTest(BigInt("65558960394507562676116818757822741623"), BigInt("263688908005839110432491559432072638113"))
    runSingleEncryptTest(BigInt("65558960394507562676116818757822741623"), BigInt("292458752579585649052525818149840375761"), iv=BigInt("149077117949227956397498265561073205290"))
    runSingleEncryptTest(BigInt("63036415400463229995541035617174648702"), BigInt("16295005142645389383086784455485558759"))
    runSingleEncryptTest(BigInt("63036415400463229995541035617174648702"), BigInt("93669816153615164512395952751800033039"), iv=BigInt("146673491003412119423160181958932249174"))
    runSingleEncryptTest(BigInt("115893530272870037403253388774378124663"), BigInt("78307793813593636465505717142472701120"))

    setKey(BigInt("77480659682196824781536209242280568617"))
    runSingleDecryptTest(BigInt("285620521974381805374183171356809032743"), BigInt("78732626654880918153396673645234369074"), iv=BigInt("147981112317427754652321488608020016728"))
    runSingleDecryptTest(BigInt("193102151738919742469920448191206198811"), BigInt("138531862892119456316820873688573960762"))
    runSingleDecryptTest(BigInt("173577793028898773428655398731547059119"), BigInt("138531862892119456316820873688573960762"), iv=BigInt("68078054275351338050152113982098793760"))
    runSingleDecryptTest(BigInt("49706086182423641475700416514958935121"), BigInt("86919746956773577147522875398327975231"))
    runSingleDecryptTest(BigInt("338193151935625951414209024766731325899"), BigInt("86919746956773577147522875398327975231"), iv=BigInt("154741751010537385352629634512842542156"))
    runSingleDecryptTest(BigInt("273970198091322108497940377693739940962"), BigInt("46702040923631624215828739081448146268"))
    runSingleDecryptTest(BigInt("299802157337694593480239856723942797290"), BigInt("46702040923631624215828739081448146268"), iv=BigInt("56436034915973938129463560814026651482"))
    runSingleDecryptTest(BigInt("305301111024692185405192604746316717627"), BigInt("138412016849774513588083447828832601662"))
    runSingleDecryptTest(BigInt("57413398763412829033508693823403602423"), BigInt("138412016849774513588083447828832601662"), iv=BigInt("81385342179464758397526960020967009100"))
    runSingleDecryptTest(BigInt("319918871893428942912044997871517501512"), BigInt("58798465798788617286187471253323784794"))
    runSingleDecryptTest(BigInt("338890068702378173717346556928957444045"), BigInt("58798465798788617286187471253323784794"), iv=BigInt("143776593973630143943154948444511161644"))
    runSingleDecryptTest(BigInt("44068720614617756832814590939415535974"), BigInt("54966635647002074000128691250454800421"))
    runSingleDecryptTest(BigInt("189306379488823371525733209166871985735"), BigInt("54966635647002074000128691250454800421"), iv=BigInt("161009620550989844366415300478312857177"))
    runSingleDecryptTest(BigInt("225953404709400016733905290486963264184"), BigInt("102688976646804611198872028837500956983"))
    runSingleDecryptTest(BigInt("235450239393449506642395731908503610305"), BigInt("102688976646804611198872028837500956983"), iv=BigInt("129119202813329063617632904645620280672"))
    setKey(BigInt("168133230406563450476682181076666438756"))
    runSingleDecryptTest(BigInt("121046064677213715129910243202851277968"), BigInt("93593226920763071136200314498274042728"))
    runSingleDecryptTest(BigInt("34875740548325074932055818403492029782"), BigInt("93593226920763071136200314498274042728"), iv=BigInt("155786311412828636019630530021726381664"))
    runSingleDecryptTest(BigInt("221439683172403484584374212531183795953"), BigInt("76152237288063830038288918103089040480"))
    runSingleDecryptTest(BigInt("192361180064584820718034311861542257461"), BigInt("76152237288063830038288918103089040480"), iv=BigInt("125166182556499340817510211802438925420"))
    runSingleDecryptTest(BigInt("74985410665911129249998168335280066645"), BigInt("149129281671248594025131726437087407404"))
    runSingleDecryptTest(BigInt("197011348921436014465592423086153160943"), BigInt("149129281671248594025131726437087407404"), iv=BigInt("92138146400676698925533676820066025825"))
    runSingleDecryptTest(BigInt("336411266834495581695211615251491155443"), BigInt("89370466470202898584265419397122909237"))
    runSingleDecryptTest(BigInt("183771092191819226371557049640011960929"), BigInt("89370466470202898584265419397122909237"), iv=BigInt("90851571057651678177950538685751314534"))
    runSingleDecryptTest(BigInt("155127082327735341207477873491389170058"), BigInt("66997751964841502287845889010601511772"))
    runSingleDecryptTest(BigInt("60429934501128318513677329122238751357"), BigInt("66997751964841502287845889010601511772"), iv=BigInt("65414000424156128282626910190637031746"))
    runSingleDecryptTest(BigInt("268674840304705095827250373774986920998"), BigInt("58783193458783079173709342353718273359"))
    runSingleDecryptTest(BigInt("313710977530523120309889064278111997927"), BigInt("58783193458783079173709342353718273359"), iv=BigInt("102570607952530102408400950689181353795"))
    runSingleDecryptTest(BigInt("248093015730979054343306269993792335245"), BigInt("97565152593092822743964834447279800693"))
    runSingleDecryptTest(BigInt("91602078687523601706676496344237769964"), BigInt("97565152593092822743964834447279800693"), iv=BigInt("117212818931004469074149527587674335309"))
    runSingleDecryptTest(BigInt("72297915303861513645483793112259038184"), BigInt("155780739454658642545025277187422105953"))
    runSingleDecryptTest(BigInt("244258284097259529814702152778571909950"), BigInt("155780739454658642545025277187422105953"), iv=BigInt("88057408475640289260295645753053619494"))
    runSingleDecryptTest(BigInt("272507431816944435304418032931387588226"), BigInt("60321314906378619420739591942395099737"))
    runSingleDecryptTest(BigInt("19423582617831845342411194426754739263"), BigInt("60321314906378619420739591942395099737"), iv=BigInt("97636745044926937982287502739840658474"))
    runSingleDecryptTest(BigInt("216963095002947821898717439135212282803"), BigInt("149233616386770394077341237991564465958"))
    runSingleDecryptTest(BigInt("252439460579078679035200523454012558168"), BigInt("149233616386770394077341237991564465958"), iv=BigInt("57573469417928949309095689639424175160"))
    setKey(BigInt("56160699756946168412993830783233307768"))
    runSingleDecryptTest(BigInt("91319044268507202941972982528125592367"), BigInt("157094285742560144584515691291308541754"))
    runSingleDecryptTest(BigInt("58272163462201180637127154925730537976"), BigInt("157094285742560144584515691291308541754"), iv=BigInt("128235963857592581060982012888764208212"))
    runSingleDecryptTest(BigInt("93057884392798539643087051781756304813"), BigInt("104112005263866868585125124246062529112"))
    runSingleDecryptTest(BigInt("311972801436445417688656002192656260735"), BigInt("104112005263866868585125124246062529112"), iv=BigInt("163679255727019089399495422332877816153"))
    runSingleDecryptTest(BigInt("258651071398957814557974115102203116336"), BigInt("57444799401210608595779731072236791360"))
    runSingleDecryptTest(BigInt("275541323168088084833767381193884547263"), BigInt("57444799401210608595779731072236791360"), iv=BigInt("120202408642463565744350490537146086434"))
    runSingleDecryptTest(BigInt("136788408867072678441724129977921913587"), BigInt("68248284768810829628712985356461289022"))
    runSingleDecryptTest(BigInt("207878078733511123905568932292321954326"), BigInt("68248284768810829628712985356461289022"), iv=BigInt("52199627951646742468175473887634272882"))
    runSingleDecryptTest(BigInt("183792194621724460666356200851159090030"), BigInt("93613122684860310092608537721687865919"))
    runSingleDecryptTest(BigInt("115152337288826154479938072803799486340"), BigInt("93613122684860310092608537721687865919"), iv=BigInt("64344915408007433018055461088765622325"))
    runSingleDecryptTest(BigInt("88736425531556991548727597981322491153"), BigInt("77517814516065971136599711406871033927"))
    runSingleDecryptTest(BigInt("317804638760997730754129928806850804779"), BigInt("77517814516065971136599711406871033927"), iv=BigInt("149269393755405451055286544068123588406"))
    runSingleDecryptTest(BigInt("89397704717243510510921253056554740032"), BigInt("157421825030499869138860910285727485790"))
    runSingleDecryptTest(BigInt("249133738111446420596201328580097382495"), BigInt("157421825030499869138860910285727485790"), iv=BigInt("153428788155735704736536101081824508016"))
    runSingleDecryptTest(BigInt("338986563476707887288117558118205449061"), BigInt("56094297204367439760313495640206164083"))
    runSingleDecryptTest(BigInt("295510221268681899058588624049565952104"), BigInt("56094297204367439760313495640206164083"), iv=BigInt("129418860844048651843991228230176043876"))
    runSingleDecryptTest(BigInt("31605631744150945753881720822189389965"), BigInt("158750469677049031070085030130279276605"))
    runSingleDecryptTest(BigInt("150894039406067137967702080703014866447"), BigInt("158750469677049031070085030130279276605"), iv=BigInt("132234544962886502111496939506174290479"))
    runSingleDecryptTest(BigInt("105615805802181541627712285310508083605"), BigInt("79942414420256167296090244935803495759"))
    runSingleDecryptTest(BigInt("322611424282754443442980255155913911907"), BigInt("79942414420256167296090244935803495759"), iv=BigInt("90965782266505390799396354484309348442"))
    setKey(BigInt("92185204046469248167003827905140175418"))
    runSingleDecryptTest(BigInt("121333428703124735283448471571176000052"), BigInt("89610853974444876801983955311365727278"))
    runSingleDecryptTest(BigInt("80677997667537793636786952970495308820"), BigInt("89610853974444876801983955311365727278"), iv=BigInt("145267027048016269350315243415662645071"))
    runSingleDecryptTest(BigInt("110300671096566269231507841908942543383"), BigInt("90903595680593655325194095164503500364"))
    runSingleDecryptTest(BigInt("85887943042005449039930077680577335597"), BigInt("90903595680593655325194095164503500364"), iv=BigInt("96146904914929916328884187100490589749"))
    runSingleDecryptTest(BigInt("17794887987274703494954470280535395636"), BigInt("85294983590046909548240364100500213332"))
    runSingleDecryptTest(BigInt("210937110046304912631179985577672115619"), BigInt("85294983590046909548240364100500213332"), iv=BigInt("96214421267512700119798726158332477006"))
    runSingleDecryptTest(BigInt("327608243532775836746813337676556230646"), BigInt("99979831846020748490039149995126058292"))
    runSingleDecryptTest(BigInt("110424568552530260426749559093847229479"), BigInt("99979831846020748490039149995126058292"), iv=BigInt("129394234188093885347187353772677811038"))
    runSingleDecryptTest(BigInt("22795105814766179509981416313128529676"), BigInt("120027332953859210947862750458489298010"))
    runSingleDecryptTest(BigInt("206707458266058554223446021465145452853"), BigInt("120027332953859210947862750458489298010"), iv=BigInt("106646680405312600645775565770074104170"))
    runSingleDecryptTest(BigInt("48611396679004374987780443224122376209"), BigInt("95882827649749833811538483133734221890"))
    runSingleDecryptTest(BigInt("36179591796360429103941314153602938116"), BigInt("95882827649749833811538483133734221890"), iv=BigInt("128178260318694797924493255468611039030"))
    runSingleDecryptTest(BigInt("241450782817719980663258134728749764619"), BigInt("152015774314141215589027466845731183472"))
    runSingleDecryptTest(BigInt("199505063410155823496416944532215927162"), BigInt("152015774314141215589027466845731183472"), iv=BigInt("85674002162058748982523778889529518689"))
    runSingleDecryptTest(BigInt("160241503893090258414264378041155139950"), BigInt("161326681352219763573856799211738905920"))
    runSingleDecryptTest(BigInt("36586087455337360815614763808496475851"), BigInt("161326681352219763573856799211738905920"), iv=BigInt("123838620099762686978568658919038477438"))
    runSingleDecryptTest(BigInt("171986383207850432375531714415643851411"), BigInt("88347670751910369777042739455739840041"))
    runSingleDecryptTest(BigInt("167019280346273728542065769352695656737"), BigInt("88347670751910369777042739455739840041"), iv=BigInt("134902247015043231754705314005773663807"))
    runSingleDecryptTest(BigInt("165479082659584696327259040417968417225"), BigInt("68264655281696867382167882676423253825"))
    runSingleDecryptTest(BigInt("253431055333524116072307691606499401385"), BigInt("68264655281696867382167882676423253825"), iv=BigInt("66645689756540608723665436680890633331"))
    setKey(BigInt("102626789528879492192772620190984791911"))
    runSingleDecryptTest(BigInt("340027509985239814787202406897403428177"), BigInt("116044251804824037003218315543461176126"))
    runSingleDecryptTest(BigInt("289809228400017368608673988316175467144"), BigInt("116044251804824037003218315543461176126"), iv=BigInt("52480988245921248213947951517437349754"))
    runSingleDecryptTest(BigInt("146941046726767688084672764659223598420"), BigInt("165163279218311259617260194692912529989"))
    runSingleDecryptTest(BigInt("152493513888076858240438578666155991296"), BigInt("165163279218311259617260194692912529989"), iv=BigInt("100342238972570657484514481395636989739"))
    runSingleDecryptTest(BigInt("260522343698694016771736622328821610073"), BigInt("46861985392670434336865244197061731360"))
    runSingleDecryptTest(BigInt("29759189951311839852009936175221063743"), BigInt("46861985392670434336865244197061731360"), iv=BigInt("69671584792788931437195231603032814460"))
    runSingleDecryptTest(BigInt("175776363727185919573801589330903663019"), BigInt("112129808557357201833726868714788699249"))
    runSingleDecryptTest(BigInt("159203627430800705964549725731511695120"), BigInt("112129808557357201833726868714788699249"), iv=BigInt("158808537245211502170455181388165967414"))
    runSingleDecryptTest(BigInt("10706083412761616853096240037900281360"), BigInt("163698520771175324425551156943618849893"))
    runSingleDecryptTest(BigInt("322934826597557629129663892003525096970"), BigInt("163698520771175324425551156943618849893"), iv=BigInt("132099419966868799468002745877621864762"))
    runSingleDecryptTest(BigInt("7023283209908365614806532471071544453"), BigInt("83940098573327227954855345153330333543"))
    runSingleDecryptTest(BigInt("247001799363256573516126099010558376311"), BigInt("83940098573327227954855345153330333543"), iv=BigInt("84147605207506277187239023219696414007"))
    runSingleDecryptTest(BigInt("331952614415069656888067185747093346471"), BigInt("154664816955179460876287686648014711117"))
    runSingleDecryptTest(BigInt("2378645741288509544359333222401680562"), BigInt("154664816955179460876287686648014711117"), iv=BigInt("45407434765153274576163109756005212494"))
    runSingleDecryptTest(BigInt("328430599425910004391420395034604220456"), BigInt("46727798219195563666307148627615837542"))
    runSingleDecryptTest(BigInt("49302299509724059971485467714373474338"), BigInt("46727798219195563666307148627615837542"), iv=BigInt("49420976039755159946977451604464386665"))
    runSingleDecryptTest(BigInt("137973728322967666630215072846187305231"), BigInt("102844501791966117325483077316203128901"))
    runSingleDecryptTest(BigInt("119054615975283245246129631046525920509"), BigInt("102844501791966117325483077316203128901"), iv=BigInt("114864929972559519287046553144577653337"))
    runSingleDecryptTest(BigInt("69704198091334296993393187962726420747"), BigInt("115913853024372848276413735932130178906"))
    runSingleDecryptTest(BigInt("145485800239449590050147346504636053884"), BigInt("115913853024372848276413735932130178906"), iv=BigInt("110691278327582271780158891759776908130"))
    setKey(BigInt("72371946312777826823047635421189984567"))
    runSingleDecryptTest(BigInt("47451509507606025795590126179312448566"), BigInt("98552175999019180291032691678900331617"))
    runSingleDecryptTest(BigInt("317259421617927864249237040730052016950"), BigInt("98552175999019180291032691678900331617"), iv=BigInt("113459035036743823786403003360551905615"))
    runSingleDecryptTest(BigInt("327288159176558439372270600859672150331"), BigInt("102792634975393036091043273828071711290"))
    runSingleDecryptTest(BigInt("27999808545786645475803131469809318453"), BigInt("102792634975393036091043273828071711290"), iv=BigInt("162666208457283418848216243288581349744"))
    runSingleDecryptTest(BigInt("67938622748223251327654443049609739260"), BigInt("63067894395886938209274346555409594429"))
    runSingleDecryptTest(BigInt("322260863064910983941213516932027842464"), BigInt("63067894395886938209274346555409594429"), iv=BigInt("65782838167350059262623551610450161761"))
    runSingleDecryptTest(BigInt("106413006702407876128703311662879916496"), BigInt("144035520339580726673100718378411044141"))
    runSingleDecryptTest(BigInt("232542914569568904331338194482279568220"), BigInt("144035520339580726673100718378411044141"), iv=BigInt("73737130903744852891797979020949594171"))
    runSingleDecryptTest(BigInt("124287245793617218272202872218311811971"), BigInt("142680165180699600875160873160048126003"))
    runSingleDecryptTest(BigInt("99082486401212266470980323429444112415"), BigInt("142680165180699600875160873160048126003"), iv=BigInt("93453422256024749548943282178983151394"))
    runSingleDecryptTest(BigInt("126532824287672057025056093116721567516"), BigInt("158610479933901662499852034630893320821"))
    runSingleDecryptTest(BigInt("303537528550198892453188901615636847745"), BigInt("158610479933901662499852034630893320821"), iv=BigInt("56394639303388908072475290276915914823"))
    runSingleDecryptTest(BigInt("311627793362371470943286400577240763714"), BigInt("65460674746939803404477981034465678195"))
    runSingleDecryptTest(BigInt("43973358587511645082874833171314577317"), BigInt("65460674746939803404477981034465678195"), iv=BigInt("143890778803731084414899009792022629496"))
    runSingleDecryptTest(BigInt("84526661177030380365137084589626508042"), BigInt("92086300143160381412550669101290902372"))
    runSingleDecryptTest(BigInt("64496679558146299957998602172244134319"), BigInt("92086300143160381412550669101290902372"), iv=BigInt("166483016464211654765576517618405364062"))
    runSingleDecryptTest(BigInt("167827896049480262857480608866464937122"), BigInt("153267219189220364391555576584894424933"))
    runSingleDecryptTest(BigInt("196945031861658272688438591641689103951"), BigInt("153267219189220364391555576584894424933"), iv=BigInt("166347793026878177739098938708770970998"))
    runSingleDecryptTest(BigInt("32307497040358300714072737686052246715"), BigInt("70855431564589664786409403706491807053"))
    runSingleDecryptTest(BigInt("235806789132579456315413839202320055937"), BigInt("70855431564589664786409403706491807053"), iv=BigInt("108052698290941312870903780463894747488"))
    setKey(BigInt("101298229501459450433158723037113507444"))
    runSingleDecryptTest(BigInt("256837608255796565526646012362046667241"), BigInt("126600883137701468943312594562149016885"))
    runSingleDecryptTest(BigInt("314190579764420591154332669004645914448"), BigInt("126600883137701468943312594562149016885"), iv=BigInt("69324635338755957891425311132660493121"))
    runSingleDecryptTest(BigInt("176116554619107839454858422135623184027"), BigInt("84262205512326469101980240326689581090"))
    runSingleDecryptTest(BigInt("38852464157961688743941700694315834986"), BigInt("84262205512326469101980240326689581090"), iv=BigInt("49385443879406162496985672220589241149"))
    runSingleDecryptTest(BigInt("244716643332153958120163237310711841320"), BigInt("50886949700810371637941141151163311174"))
    runSingleDecryptTest(BigInt("207315135854042161424280751809287250167"), BigInt("50886949700810371637941141151163311174"), iv=BigInt("84168924398756875247340801122803798071"))
    runSingleDecryptTest(BigInt("131492934948098474060611107051499609542"), BigInt("116194768669506161058449428263923885672"))
    runSingleDecryptTest(BigInt("210441415124088915355595341734280442043"), BigInt("116194768669506161058449428263923885672"), iv=BigInt("74905841922983967326855468090393452097"))
    runSingleDecryptTest(BigInt("103500455846648436573976737763827782214"), BigInt("165277202109631148755885064390715535927"))
    runSingleDecryptTest(BigInt("208052404622306747625968628867481187965"), BigInt("165277202109631148755885064390715535927"), iv=BigInt("117425199871773598792471226937616324166"))
    runSingleDecryptTest(BigInt("86056897790213298628391604401489189889"), BigInt("127980512919709846289811648672549662298"))
    runSingleDecryptTest(BigInt("180868647837612763955692350954411539692"), BigInt("127980512919709846289811648672549662298"), iv=BigInt("138433170915619705686720461023222647366"))
    runSingleDecryptTest(BigInt("303269279032061188322774249989328952947"), BigInt("81649766638020268243865897382754734153"))
    runSingleDecryptTest(BigInt("163574714225501438841096257570279775697"), BigInt("81649766638020268243865897382754734153"), iv=BigInt("112030343520359925939901082176394707039"))
    runSingleDecryptTest(BigInt("292703679822832360615760052737819590861"), BigInt("127970345573409053591349770153480904818"))
    runSingleDecryptTest(BigInt("283205457993435695454841245724228129028"), BigInt("127970345573409053591349770153480904818"), iv=BigInt("122663595306167681641673293065725432371"))
    runSingleDecryptTest(BigInt("295529016657626839923715058621428469084"), BigInt("154774122443740348039978585272750207531"))
    runSingleDecryptTest(BigInt("244550407000854470087451844617234509241"), BigInt("154774122443740348039978585272750207531"), iv=BigInt("128017873518730288378394163923757379137"))
    runSingleDecryptTest(BigInt("324960199637395794709697764942029435760"), BigInt("94963929836409858009552574665745775659"))
    runSingleDecryptTest(BigInt("146669575497660633028979986028739956755"), BigInt("94963929836409858009552574665745775659"), iv=BigInt("45558314970768968670011900336261777474"))
    setKey(BigInt("151778268097359500324393864993651958632"))
    runSingleDecryptTest(BigInt("328796744800758796582865650384446348643"), BigInt("45423960236857848167707537234490242154"))
    runSingleDecryptTest(BigInt("153368785437618761832833525981277989070"), BigInt("45423960236857848167707537234490242154"), iv=BigInt("134803654704993497951112651813754198637"))
    runSingleDecryptTest(BigInt("271572883651420180760934586847669852846"), BigInt("134503777526792601139941357986574522483"))
    runSingleDecryptTest(BigInt("324127614443984772269455054125368971651"), BigInt("134503777526792601139941357986574522483"), iv=BigInt("76172723053378107227274201275325315875"))
    runSingleDecryptTest(BigInt("337875252960369954026359401471074432294"), BigInt("120167135472892874716299241227017602377"))
    runSingleDecryptTest(BigInt("141906483173173506494034647488981664629"), BigInt("120167135472892874716299241227017602377"), iv=BigInt("138469683364347159375290058361821079076"))
    runSingleDecryptTest(BigInt("24969744755649791476781793233943259297"), BigInt("159913662772991504311349462948438176555"))
    runSingleDecryptTest(BigInt("191342019853984141186831496431347503343"), BigInt("159913662772991504311349462948438176555"), iv=BigInt("145152717144438698543392349737959768402"))
    runSingleDecryptTest(BigInt("224930683414374644275439462610310772086"), BigInt("130484635533821702032701657867462917462"))
    runSingleDecryptTest(BigInt("238429615178094310760580662429937316299"), BigInt("130484635533821702032701657867462917462"), iv=BigInt("62729851278259827936275771562815485276"))
    runSingleDecryptTest(BigInt("290935993246917664309957380021722860054"), BigInt("45604861494355918592175353226243171188"))
    runSingleDecryptTest(BigInt("310678747872641508969849831267002645966"), BigInt("45604861494355918592175353226243171188"), iv=BigInt("163792714729096551421276492927832507989"))
    runSingleDecryptTest(BigInt("54740073074467118009824422870338097327"), BigInt("106578753498258226152585011210371420477"))
    runSingleDecryptTest(BigInt("60403869948099898260410962648554515928"), BigInt("106578753498258226152585011210371420477"), iv=BigInt("54998840857301624892293277978869910872"))
    runSingleDecryptTest(BigInt("135782446389636432527237547295249495583"), BigInt("89245896336258371150337355278912683560"))
    runSingleDecryptTest(BigInt("330736219120584670256656390182234872333"), BigInt("89245896336258371150337355278912683560"), iv=BigInt("146502469354526604196059350010064023912"))
    runSingleDecryptTest(BigInt("184300654540174015815626003384858318470"), BigInt("122550545838212052862962181828670399842"))
    runSingleDecryptTest(BigInt("314231190461150535304630299605250915496"), BigInt("122550545838212052862962181828670399842"), iv=BigInt("155821767291921994923061601940779990308"))
    runSingleDecryptTest(BigInt("2466864203503170557826777364542462656"), BigInt("146559017731316283799586446672888615204"))
    runSingleDecryptTest(BigInt("55492619614748930380615305809026792151"), BigInt("146559017731316283799586446672888615204"), iv=BigInt("57568113903315826678869436216028123749"))
    setKey(BigInt("122544642614258461999990035278047240296"))
    runSingleDecryptTest(BigInt("265622692371007210627112904032060888790"), BigInt("145085642169790026724237839496092205637"))
    runSingleDecryptTest(BigInt("102764897089898617479158702884126448371"), BigInt("145085642169790026724237839496092205637"), iv=BigInt("76276974421161882521466857594460528486"))
    runSingleDecryptTest(BigInt("328758449572761206149128509196866545380"), BigInt("56229616936448104810736219418608889401"))
    runSingleDecryptTest(BigInt("329386688979954665993179468503850629169"), BigInt("56229616936448104810736219418608889401"), iv=BigInt("69458007314871913753942480703243635274"))
    runSingleDecryptTest(BigInt("118875775523949298939014156788778960909"), BigInt("102762761208714701754625762552136292733"))
    runSingleDecryptTest(BigInt("111148659917772639362428688996377983519"), BigInt("102762761208714701754625762552136292733"), iv=BigInt("95883255008617416412255539959019675979"))
    runSingleDecryptTest(BigInt("335031555026186349324846795105078935307"), BigInt("127773101345088384450597710485347649910"))
    runSingleDecryptTest(BigInt("108891005509366776281334765836414600001"), BigInt("127773101345088384450597710485347649910"), iv=BigInt("71976416422625886835176661647731873382"))
    runSingleDecryptTest(BigInt("174339460602451737817176534092843846589"), BigInt("97460251077183092241216075192635255163"))
    runSingleDecryptTest(BigInt("285512419633606014804101511530227713069"), BigInt("97460251077183092241216075192635255163"), iv=BigInt("78664279634306578873140340329176513614"))
    runSingleDecryptTest(BigInt("223204051926619220164087633514176470110"), BigInt("150563289248050676103322475974920321621"))
    runSingleDecryptTest(BigInt("329864119268078370883566594191851445733"), BigInt("150563289248050676103322475974920321621"), iv=BigInt("141414703357490261746213758272612947287"))
    runSingleDecryptTest(BigInt("114735096945341566339082304267345388801"), BigInt("53503034155721630111415570707627394656"))
    runSingleDecryptTest(BigInt("236005268172500719406205787956631702490"), BigInt("53503034155721630111415570707627394656"), iv=BigInt("74626028887466310397176942181640984670"))
    runSingleDecryptTest(BigInt("16180103529852854688426954060515704903"), BigInt("134434739312646205586833235363155110493"))
    runSingleDecryptTest(BigInt("156302178642738770077824260924142129131"), BigInt("134434739312646205586833235363155110493"), iv=BigInt("93390526735649452880053621959128592234"))
    runSingleDecryptTest(BigInt("311170235980418309730563324770381151640"), BigInt("80144085030649257436578456070751616546"))
    runSingleDecryptTest(BigInt("58083050751014652342071623299015594037"), BigInt("80144085030649257436578456070751616546"), iv=BigInt("104076352409486066658729080071692104052"))
    runSingleDecryptTest(BigInt("59906195094413251872856552144285723846"), BigInt("84054229514383031267729964054687542313"))
    runSingleDecryptTest(BigInt("233080732405349040224664440809462324323"), BigInt("84054229514383031267729964054687542313"), iv=BigInt("147893756849228520099643821629814045287"))
    setKey(BigInt("52079816379513698496168418014638996514"))
    runSingleDecryptTest(BigInt("213066691207088116118073527151968345637"), BigInt("125317287219454896044025154156890190963"))
    runSingleDecryptTest(BigInt("137907716521757683972959115525708562354"), BigInt("125317287219454896044025154156890190963"), iv=BigInt("50845166344109656055292568731053880908"))
    runSingleDecryptTest(BigInt("19373440445655058585154005924817389474"), BigInt("113188164337880968408561611100190171950"))
    runSingleDecryptTest(BigInt("145667346612196480976257510140047168756"), BigInt("113188164337880968408561611100190171950"), iv=BigInt("159909625550332513665317295682746857000"))
    runSingleDecryptTest(BigInt("287440588537841851727745602123595578276"), BigInt("157391059785790237752611573731341444979"))
    runSingleDecryptTest(BigInt("126356437332994045571529667056048927264"), BigInt("157391059785790237752611573731341444979"), iv=BigInt("86812023208966408689864336317314381890"))
    runSingleDecryptTest(BigInt("213526283591722379830939948295499334496"), BigInt("97389078603945013086722119420873028683"))
    runSingleDecryptTest(BigInt("20042552440624916306391919525058805324"), BigInt("97389078603945013086722119420873028683"), iv=BigInt("70716211069288671151242553044721626467"))
    runSingleDecryptTest(BigInt("131884007881189291852520540695452019329"), BigInt("80362931030128202144846786694629437289"))
    runSingleDecryptTest(BigInt("64983950955322363964431827975734759230"), BigInt("80362931030128202144846786694629437289"), iv=BigInt("70949049408731357541189397085199035984"))
    runSingleDecryptTest(BigInt("43365203886527483682457196963314377187"), BigInt("154789232033598153642149786175146765157"))
    runSingleDecryptTest(BigInt("74773503306927919193992226555220079110"), BigInt("154789232033598153642149786175146765157"), iv=BigInt("165412024368391335924410944632355119673"))
    runSingleDecryptTest(BigInt("338342245269569373307747901278775697916"), BigInt("97294641008858071605151749741242037569"))
    runSingleDecryptTest(BigInt("123230385979941268676221393707222860600"), BigInt("97294641008858071605151749741242037569"), iv=BigInt("84235611927222873697147125908010987598"))
    runSingleDecryptTest(BigInt("117715882346664645914366167339922367207"), BigInt("60233100838855978268718611088511750724"))
    runSingleDecryptTest(BigInt("13025089639313052236411655293914531177"), BigInt("60233100838855978268718611088511750724"), iv=BigInt("44074334470605085630953432628871713630"))
    runSingleDecryptTest(BigInt("291044802907760583242047431167292036648"), BigInt("108188489910181862414294570604104082722"))
    runSingleDecryptTest(BigInt("111021414059393632641153639994878115443"), BigInt("108188489910181862414294570604104082722"), iv=BigInt("78935104776335234454508588488548691063"))
    runSingleDecryptTest(BigInt("123174874366207863936385599532226021310"), BigInt("48088059960293530227446720088654305143"))
    runSingleDecryptTest(BigInt("201851808223422530896560535530939776840"), BigInt("48088059960293530227446720088654305143"), iv=BigInt("46824907959208716496977543540148042843"))



    setKey(BigInt("114849718896073566083416993308083054187"))
    runSingleEncryptTest(BigInt("115893530272870037403253388774378124663"), BigInt("57873011419295910906973876109488840100"), iv=BigInt("137369721399049440708519569169693105014"))
    runSingleEncryptTest(BigInt("74885239361085007638178609790930468671"), BigInt("278131917818815872483937984457317959494"))
    runSingleEncryptTest(BigInt("74885239361085007638178609790930468671"), BigInt("311368125752202963993246456614958734547"), iv=BigInt("44406274741320136577355402206418977136"))
    runSingleEncryptTest(BigInt("128059330284264555516976583467700727859"), BigInt("255713931439712555356268428614113493553"))
    runSingleEncryptTest(BigInt("128059330284264555516976583467700727859"), BigInt("18061530258208880058015395462138920157"), iv=BigInt("105177264018733420109340008042707890023"))
    runSingleEncryptTest(BigInt("91894982425384513464560866790118930277"), BigInt("226721071789772648829417960070004902270"))
    runSingleEncryptTest(BigInt("91894982425384513464560866790118930277"), BigInt("312299458229100604829357361833912669191"), iv=BigInt("103909547893119949727157940596638836083"))
    runSingleEncryptTest(BigInt("143823083554295233553712770931659778670"), BigInt("279042500898354141763089714981182998954"))
    runSingleEncryptTest(BigInt("143823083554295233553712770931659778670"), BigInt("324972730258358763675490376643286932230"), iv=BigInt("89459874180124671017484013183434317612"))
    runSingleEncryptTest(BigInt("162811246138409284816498799940274761829"), BigInt("42222800082732283618955268195002743790"))
    runSingleEncryptTest(BigInt("162811246138409284816498799940274761829"), BigInt("77131328890983426372738961978491418639"), iv=BigInt("153246795423957082397098253318296122919"))
    setKey(BigInt("150375537023698276332429336253045492317"))
    runSingleEncryptTest(BigInt("131917632380324906031364144786648675141"), BigInt("170292759109317841066097274944938321159"))
    runSingleEncryptTest(BigInt("131917632380324906031364144786648675141"), BigInt("112167255100654352863238945935189571860"), iv=BigInt("62922733827283287692655060117120896301"))
    runSingleEncryptTest(BigInt("94911458986576837840656542655062876716"), BigInt("247187020939281202376911763142781568588"))
    runSingleEncryptTest(BigInt("94911458986576837840656542655062876716"), BigInt("122997894445739937552041976368816786321"), iv=BigInt("158413066331821386130257589808800150065"))
    runSingleEncryptTest(BigInt("121142802401266718723148881335230750041"), BigInt("169085546614119189002056208543197677228"))
    runSingleEncryptTest(BigInt("121142802401266718723148881335230750041"), BigInt("224132732134121775206571892445081942405"), iv=BigInt("153085489591529054920480194021576703289"))
    runSingleEncryptTest(BigInt("155774774603344437617973070833834544729"), BigInt("139081820949474834856950572204895069203"))
    runSingleEncryptTest(BigInt("155774774603344437617973070833834544729"), BigInt("187536718819203153736713879645950097692"), iv=BigInt("62906773554088312450755547371957417844"))
    runSingleEncryptTest(BigInt("112259453374852286972239969208098642792"), BigInt("293849242638205620275945183550881642669"))
    runSingleEncryptTest(BigInt("112259453374852286972239969208098642792"), BigInt("320569232568461075436430857594428437574"), iv=BigInt("112046306257151104069285832733281444955"))
    runSingleEncryptTest(BigInt("56347662475028556581909598444035195706"), BigInt("65188326630462532214664894890352521388"))
    runSingleEncryptTest(BigInt("56347662475028556581909598444035195706"), BigInt("144131154779794123663846241833505248646"), iv=BigInt("63992409257720499593732520136147815805"))
    runSingleEncryptTest(BigInt("54950875812352572363673249878716336462"), BigInt("115569122748205408158709250424564840907"))
    runSingleEncryptTest(BigInt("54950875812352572363673249878716336462"), BigInt("313498321229282317040064004915093796287"), iv=BigInt("90752411386687238677939013411353601101"))
    runSingleEncryptTest(BigInt("101257117924681795934224680735287290493"), BigInt("299233668630045139033450637074303152567"))
    runSingleEncryptTest(BigInt("101257117924681795934224680735287290493"), BigInt("105360146491707757847230682101494695387"), iv=BigInt("121512226625689582582634193326050075515"))
    runSingleEncryptTest(BigInt("97648675063137130282423473273397406544"), BigInt("139798511823658863754062988372416305034"))
    runSingleEncryptTest(BigInt("97648675063137130282423473273397406544"), BigInt("61651760464561346265927770823637320996"), iv=BigInt("167671708355577768017991528907965754151"))
    runSingleEncryptTest(BigInt("94822581071567543835688068651079265620"), BigInt("57717491230236807714012292601954036538"))
    runSingleEncryptTest(BigInt("94822581071567543835688068651079265620"), BigInt("9469776572634117428403465667251787712"), iv=BigInt("75985034862426792577288679340978107505"))
    setKey(BigInt("75077192073141450471139287546387379758"))
    runSingleEncryptTest(BigInt("86723940019308063397066404979038646108"), BigInt("271863373610084661747062635679610536984"))
    runSingleEncryptTest(BigInt("86723940019308063397066404979038646108"), BigInt("338418550890773069045085052764399749957"), iv=BigInt("70730244661120701929044827882263103580"))
    runSingleEncryptTest(BigInt("94559033346039526895361716370833941076"), BigInt("211135283079234738221329551242530770542"))
    runSingleEncryptTest(BigInt("94559033346039526895361716370833941076"), BigInt("140748058233075897473467838892247573540"), iv=BigInt("56197555354044598155386660176433657919"))
    runSingleEncryptTest(BigInt("61733351320594316474785351783609301111"), BigInt("19312815967531353490924332227315911686"))
    runSingleEncryptTest(BigInt("61733351320594316474785351783609301111"), BigInt("65759304779084216496848929614811355487"), iv=BigInt("137208622971392958681057005430507126309"))
    runSingleEncryptTest(BigInt("136179291462022793018743273672086549598"), BigInt("129991418332923599179821458080402688929"))
    runSingleEncryptTest(BigInt("136179291462022793018743273672086549598"), BigInt("226425234268540606531120302267951028547"), iv=BigInt("56073403880085415315484855231933456432"))
    runSingleEncryptTest(BigInt("44369521327139901195294319751204910155"), BigInt("151265744604435864916013947652033377993"))
    runSingleEncryptTest(BigInt("44369521327139901195294319751204910155"), BigInt("313703041520543152001655832526718294040"), iv=BigInt("118666830032415306224386720092910155611"))
    runSingleEncryptTest(BigInt("154773793653685375405755126480078971230"), BigInt("265205493287784193917729467286794820991"))
    runSingleEncryptTest(BigInt("154773793653685375405755126480078971230"), BigInt("220165467483891490111133637107714978492"), iv=BigInt("56051660887803015003882283248326683746"))
    runSingleEncryptTest(BigInt("68321159158875178900681812703835353456"), BigInt("99745649016848784874449477591374203399"))
    runSingleEncryptTest(BigInt("68321159158875178900681812703835353456"), BigInt("151455374259523443462904894601583660551"), iv=BigInt("109288462028855763759570454107561476985"))
    runSingleEncryptTest(BigInt("61629646241222861018668998236924224563"), BigInt("184911291737299005647224058580208475164"))
    runSingleEncryptTest(BigInt("61629646241222861018668998236924224563"), BigInt("132949170783190929759204870807840918298"), iv=BigInt("46706116006215560184391359985203763284"))
    runSingleEncryptTest(BigInt("96324107670472738687200504521008175689"), BigInt("124919619107039677279719129514877450604"))
    runSingleEncryptTest(BigInt("96324107670472738687200504521008175689"), BigInt("159607119750275123760085197403810535113"), iv=BigInt("75067195222030002163844677874552810277"))
    runSingleEncryptTest(BigInt("138422543255374081067805584686065875544"), BigInt("198963095458980071098689716983372967546"))
    runSingleEncryptTest(BigInt("138422543255374081067805584686065875544"), BigInt("81646713544491491652316583595564601302"), iv=BigInt("82881051669412068718217661622094870138"))
    setKey(BigInt("52043067346729826521811211907861075017"))
    runSingleEncryptTest(BigInt("105644766749862872588828738772990909773"), BigInt("179086695170187973060942383725777284673"))
    runSingleEncryptTest(BigInt("105644766749862872588828738772990909773"), BigInt("16537257872184348805630966777050793024"), iv=BigInt("155915941132660933510245226962397963617"))
    runSingleEncryptTest(BigInt("67075881954434244466111157871100787747"), BigInt("149052965627728194765512571136254688932"))
    runSingleEncryptTest(BigInt("67075881954434244466111157871100787747"), BigInt("295380550482792116818696352615885420707"), iv=BigInt("44473795731839809249343149707265915742"))
    runSingleEncryptTest(BigInt("97632122010722489081555962258729036923"), BigInt("164904470545547448311236040900408105352"))
    runSingleEncryptTest(BigInt("97632122010722489081555962258729036923"), BigInt("142892718513370804434877244800403341797"), iv=BigInt("157483952891866604535985138818544721978"))
    runSingleEncryptTest(BigInt("96297218976892843200706072443294285354"), BigInt("240063892006345963022062997828984707841"))
    runSingleEncryptTest(BigInt("96297218976892843200706072443294285354"), BigInt("248028794481108843578542851582640669303"), iv=BigInt("78903367568287106915321517763065118040"))
    runSingleEncryptTest(BigInt("114932978748224306887671123231372688955"), BigInt("239891667906234038200252194413283620440"))
    runSingleEncryptTest(BigInt("114932978748224306887671123231372688955"), BigInt("290785974419681308445590372007020580307"), iv=BigInt("160095759047671885666966906908651250528"))
    runSingleEncryptTest(BigInt("104320285237419782670791175069483156862"), BigInt("316380428303623217933246520078794612619"))
    runSingleEncryptTest(BigInt("104320285237419782670791175069483156862"), BigInt("262438929974292374310147850456399063187"), iv=BigInt("73632998938590213645943713762260108401"))
    runSingleEncryptTest(BigInt("105291347817480445792588315852479822130"), BigInt("131787141614612842463075274656764232070"))
    runSingleEncryptTest(BigInt("105291347817480445792588315852479822130"), BigInt("220878027419271809974849976171908546473"), iv=BigInt("141283501589733281545889470601737495109"))
    runSingleEncryptTest(BigInt("125410913042801679323365774772481960485"), BigInt("305055988983700000457011981372583152132"))
    runSingleEncryptTest(BigInt("125410913042801679323365774772481960485"), BigInt("23366205020582496613410934573770015709"), iv=BigInt("102726540633097823417416596294796067440"))
    runSingleEncryptTest(BigInt("148002289910274228365321013951634501689"), BigInt("99045787161214144812054673918387553669"))
    runSingleEncryptTest(BigInt("148002289910274228365321013951634501689"), BigInt("223653776749024648758246896332295950721"), iv=BigInt("77476539260749405843584334370385975152"))
    runSingleEncryptTest(BigInt("138666273786430233215497454954600626483"), BigInt("199697335788033082778349603643747764218"))
    runSingleEncryptTest(BigInt("138666273786430233215497454954600626483"), BigInt("260864632348503482009173171766682595007"), iv=BigInt("159737631427444679564584185658779792682"))
    setKey(BigInt("137296969653456059804961651722017006964"))
    runSingleEncryptTest(BigInt("52100326088784669781917981148238914937"), BigInt("136189182276794235108589834639614585751"))
    runSingleEncryptTest(BigInt("52100326088784669781917981148238914937"), BigInt("153165168379076655710531832717902847591"), iv=BigInt("62995347089353693964380477395564832361"))
    runSingleEncryptTest(BigInt("73369309398080928337661956417784339035"), BigInt("221969221820149081272316335032109181570"))
    runSingleEncryptTest(BigInt("73369309398080928337661956417784339035"), BigInt("305842852456671801667171840825482788043"), iv=BigInt("149430980383234320222802842635753192565"))
    runSingleEncryptTest(BigInt("64423125401433518571239049291466825801"), BigInt("232949595804493890665067861467920067336"))
    runSingleEncryptTest(BigInt("64423125401433518571239049291466825801"), BigInt("334215675834066335268359444459524704574"), iv=BigInt("127830721062060304974299058588957179437"))
    runSingleEncryptTest(BigInt("141449574345539509169973914853209100109"), BigInt("313780915694482792622079796633055299196"))
    runSingleEncryptTest(BigInt("141449574345539509169973914853209100109"), BigInt("187818954470299803521783614039791797816"), iv=BigInt("106994990525265381842071829671001942388"))
    runSingleEncryptTest(BigInt("65362442456005217833003411063938832481"), BigInt("3416494887697969098734882671491337008"))
    runSingleEncryptTest(BigInt("65362442456005217833003411063938832481"), BigInt("96813608544479078069097590345948328706"), iv=BigInt("66962283512411800100937141991515255915"))
    runSingleEncryptTest(BigInt("137509203273606027508833359686972685140"), BigInt("182093913304591860736149231247282092014"))
    runSingleEncryptTest(BigInt("137509203273606027508833359686972685140"), BigInt("122949253086467852721297905510470867806"), iv=BigInt("42765834166592619736015906129319058025"))
    runSingleEncryptTest(BigInt("97441038818066320757503238718620984115"), BigInt("106674712811633457369499667865428762227"))
    runSingleEncryptTest(BigInt("97441038818066320757503238718620984115"), BigInt("89928961988013786794726349135430081946"), iv=BigInt("153045347771444060895807491901236732496"))
    runSingleEncryptTest(BigInt("126506221550422470060666114398429276260"), BigInt("127302809102461821109826013573506053079"))
    runSingleEncryptTest(BigInt("126506221550422470060666114398429276260"), BigInt("196864818779798521176365335934257841164"), iv=BigInt("69759206950159495176290517666355834466"))
    runSingleEncryptTest(BigInt("77672730922450537721884914823597204342"), BigInt("58242657461705247643540668633843771810"))
    runSingleEncryptTest(BigInt("77672730922450537721884914823597204342"), BigInt("129349153908090146795861465593009942115"), iv=BigInt("88270854687117847134953779132979634734"))
    runSingleEncryptTest(BigInt("139867359907514219423487665637445281643"), BigInt("307218033422023005677979497608273708565"))
    runSingleEncryptTest(BigInt("139867359907514219423487665637445281643"), BigInt("137236773295009862252582049698583381884"), iv=BigInt("138610845220411970829625405780918229293"))
    setKey(BigInt("118556977713159770430011055868944209955"))
    runSingleEncryptTest(BigInt("42755039960169586870139531009950886510"), BigInt("62104998097134814687112627294329159288"))
    runSingleEncryptTest(BigInt("42755039960169586870139531009950886510"), BigInt("55785048370103564705977425400803222069"), iv=BigInt("158414248571000928851691067312726821673"))
    runSingleEncryptTest(BigInt("103925737466118831789259617901589583217"), BigInt("242538534750899411200391160319696155008"))
    runSingleEncryptTest(BigInt("103925737466118831789259617901589583217"), BigInt("26664040479328258047616333366497016555"), iv=BigInt("45543628432376178419762587448771897181"))
    runSingleEncryptTest(BigInt("48107957956095376195252697761034283312"), BigInt("201237563454176581052165856426859146670"))
    runSingleEncryptTest(BigInt("48107957956095376195252697761034283312"), BigInt("222313801693165083873234525986160200173"), iv=BigInt("77450495787397637017743059851619085387"))
    runSingleEncryptTest(BigInt("151984968185576281221645915486645071140"), BigInt("65542976918914053448696140411429808969"))
    runSingleEncryptTest(BigInt("151984968185576281221645915486645071140"), BigInt("123356747727654911428710745273887892417"), iv=BigInt("118797058854874585040111615957565850177"))
    runSingleEncryptTest(BigInt("89349739597621819994452472020861274476"), BigInt("74382591910079927095072060383018782814"))
    runSingleEncryptTest(BigInt("89349739597621819994452472020861274476"), BigInt("24267843591789037954723515485376579799"), iv=BigInt("80052200396716011191484431606576996419"))
    runSingleEncryptTest(BigInt("70944021748659120914186812439871645815"), BigInt("280098262171076340642940757121414291168"))
    runSingleEncryptTest(BigInt("70944021748659120914186812439871645815"), BigInt("320917558399905633504246061429785864685"), iv=BigInt("106563258763023091672748806869700725855"))
    runSingleEncryptTest(BigInt("98955551131972522517974904088735132027"), BigInt("235851582601734083854276837311544074134"))
    runSingleEncryptTest(BigInt("98955551131972522517974904088735132027"), BigInt("278689502569254904586670593082422137373"), iv=BigInt("101382094024827244605593335734884579681"))
    runSingleEncryptTest(BigInt("72288944587495486941983259800453398344"), BigInt("211293221096103359338422285306915607031"))
    runSingleEncryptTest(BigInt("72288944587495486941983259800453398344"), BigInt("247652739775902516336320499588737070328"), iv=BigInt("80320498414086321518080001653682548313"))
    runSingleEncryptTest(BigInt("65460306734637110742177602722417297233"), BigInt("131565652484860445099009298710384815044"))
    runSingleEncryptTest(BigInt("65460306734637110742177602722417297233"), BigInt("115125559065507668964563677617042321973"), iv=BigInt("135869005145324888045638359976411948151"))
    runSingleEncryptTest(BigInt("70896704846990912211783903892575181415"), BigInt("242240556012454415125725461384046528896"))
    runSingleEncryptTest(BigInt("70896704846990912211783903892575181415"), BigInt("198083326836927138804493392591911952980"), iv=BigInt("53394383831050051913097921091615741265"))
    setKey(BigInt("111994015269031136592359828842080254068"))
    runSingleEncryptTest(BigInt("146657078827959692372596569952670604335"), BigInt("308486197595366702835087491506253515850"))
    runSingleEncryptTest(BigInt("146657078827959692372596569952670604335"), BigInt("98437577556889106124435891839595513815"), iv=BigInt("143775845200900591552622811287376962088"))
    runSingleEncryptTest(BigInt("55080703223183421407022513996489971504"), BigInt("246123730723129563299236623825598070276"))
    runSingleEncryptTest(BigInt("55080703223183421407022513996489971504"), BigInt("69566497606709050987871732963550689724"), iv=BigInt("113198848628549888178079623485078906954"))
    runSingleEncryptTest(BigInt("90664712149722268428691982170953628500"), BigInt("253900476959412171761269748898634037224"))
    runSingleEncryptTest(BigInt("90664712149722268428691982170953628500"), BigInt("56821157857729324814060793128371839933"), iv=BigInt("77642086282861212854626708794471686503"))
    runSingleEncryptTest(BigInt("118474733895958769818867324513921497210"), BigInt("22529447966977729450869850686103198211"))
    runSingleEncryptTest(BigInt("118474733895958769818867324513921497210"), BigInt("188935618806905203014876903670610155202"), iv=BigInt("85461375795935211149580289450020848710"))
    runSingleEncryptTest(BigInt("83046940875501562582407989242623894080"), BigInt("262378166730248065198635370084478690319"))
    runSingleEncryptTest(BigInt("83046940875501562582407989242623894080"), BigInt("8432130280037807510337570174414331787"), iv=BigInt("117561193882484014531329053138459245931"))
    runSingleEncryptTest(BigInt("66763393087227360980921977276246812995"), BigInt("14513586706244427217085072070081793400"))
    runSingleEncryptTest(BigInt("66763393087227360980921977276246812995"), BigInt("136300811786112692094170701838240618585"), iv=BigInt("96334228664671239254314653794738646853"))
    runSingleEncryptTest(BigInt("133401979837743501488586213423924267637"), BigInt("197570711105380558319956788100301907615"))
    runSingleEncryptTest(BigInt("133401979837743501488586213423924267637"), BigInt("156420612108814165051669438910636828254"), iv=BigInt("83981105874392200304788414557180228713"))
    runSingleEncryptTest(BigInt("77480534652830493226410819197934326579"), BigInt("302091611418538227099164472972552211894"))
    runSingleEncryptTest(BigInt("77480534652830493226410819197934326579"), BigInt("184014656366940511651728318766090311665"), iv=BigInt("60320585622222224217567269234639978288"))
    runSingleEncryptTest(BigInt("57380725056817474135214440720040808290"), BigInt("277811159440043091464139761654627426633"))
    runSingleEncryptTest(BigInt("57380725056817474135214440720040808290"), BigInt("70271046786765517376024987823141476095"), iv=BigInt("50840341369742101735484634761702550139"))
    runSingleEncryptTest(BigInt("64319095565816915200461555537842040929"), BigInt("162433904302197721310322024268951781737"))
    runSingleEncryptTest(BigInt("64319095565816915200461555537842040929"), BigInt("59339923311547660219146116110910699956"), iv=BigInt("160095616018831564766597517440107620986"))
    setKey(BigInt("65335509227691950755253342708080779326"))
    runSingleEncryptTest(BigInt("72226034657482063194378654622694004596"), BigInt("18633994098734630257809055134561627699"))
    runSingleEncryptTest(BigInt("72226034657482063194378654622694004596"), BigInt("185005907208054481731750516414958934414"), iv=BigInt("78788693034080562243872170385630967141"))
    runSingleEncryptTest(BigInt("76110800477730581521940101764931929921"), BigInt("317352928810155578073031987713201390924"))
    runSingleEncryptTest(BigInt("76110800477730581521940101764931929921"), BigInt("115651798177725055690340163606604348930"), iv=BigInt("91992985984949171134499929654884461925"))
    runSingleEncryptTest(BigInt("92066184196946804087250374658333824637"), BigInt("323163915726333229714565528750106615407"))
    runSingleEncryptTest(BigInt("92066184196946804087250374658333824637"), BigInt("314912789710035965799874685804391644070"), iv=BigInt("123926356977306398759735644858905943609"))
    runSingleEncryptTest(BigInt("65356583701108751057018166573405382523"), BigInt("121520496704722700708175726843370175661"))
    runSingleEncryptTest(BigInt("65356583701108751057018166573405382523"), BigInt("261297953101808993533077080933576062306"), iv=BigInt("109440544130634783151934707045766624566"))
    runSingleEncryptTest(BigInt("53336269715191295173593655741019218224"), BigInt("222040194284886427156706301218250066733"))
    runSingleEncryptTest(BigInt("53336269715191295173593655741019218224"), BigInt("12894920958361989477769111931126466920"), iv=BigInt("144005136343309628149662852999081523049"))
    runSingleEncryptTest(BigInt("54920734176652338219690314357960684335"), BigInt("61511928506023179334485191227377204465"))
    runSingleEncryptTest(BigInt("54920734176652338219690314357960684335"), BigInt("132607004118375258147699015687995599113"), iv=BigInt("104174926113821471576372533557017664624"))
    runSingleEncryptTest(BigInt("158486413445734587853903741511524508508"), BigInt("132759537009905281428790941672864100118"))
    runSingleEncryptTest(BigInt("158486413445734587853903741511524508508"), BigInt("334570560589369757520722911022207609175"), iv=BigInt("56239272391486465564546281606211199611"))
    runSingleEncryptTest(BigInt("45455583925500959853109600483006955565"), BigInt("24689664526548759320921027574676297987"))
    runSingleEncryptTest(BigInt("45455583925500959853109600483006955565"), BigInt("71674452348348530560273487044110825196"), iv=BigInt("122919316864171973935418943591877852729"))
    runSingleEncryptTest(BigInt("85680425645983930467682080047028382334"), BigInt("69479349487605394382447049283821684221"))
    runSingleEncryptTest(BigInt("85680425645983930467682080047028382334"), BigInt("2931865051942311599485186172093136745"), iv=BigInt("129434815946915721996441302007799952485"))
    runSingleEncryptTest(BigInt("58720626417433707807053247923347276127"), BigInt("314971329074673246596482528794275843037"))
    runSingleEncryptTest(BigInt("58720626417433707807053247923347276127"), BigInt("259932986941202031547596923091070264975"), iv=BigInt("133194667550736640128115182063836484698"))
    setKey(BigInt("86827075270622593409819524343863859761"))
    runSingleEncryptTest(BigInt("58969592210743870063285156888865157723"), BigInt("34445959912195374720291194579163502738"))
    runSingleEncryptTest(BigInt("58969592210743870063285156888865157723"), BigInt("69130398036106899280699320475117573951"), iv=BigInt("113297811504676015438898247227970508370"))
    runSingleEncryptTest(BigInt("90965698820630213166994289669365519396"), BigInt("204326765483663107115405994780398329495"))
    runSingleEncryptTest(BigInt("90965698820630213166994289669365519396"), BigInt("321541266545999478803201861322376605213"), iv=BigInt("128094702975275155929937112909655730225"))
    runSingleEncryptTest(BigInt("74605240072561564204060370263150506580"), BigInt("114316182370891260659519907878684695684"))
    runSingleEncryptTest(BigInt("74605240072561564204060370263150506580"), BigInt("129416346144803868019166907674914641037"), iv=BigInt("164031622486103800548796609917051485256"))
    runSingleEncryptTest(BigInt("88234270445505063544773351946799499361"), BigInt("140819026982539376265949603485155741227"))
    runSingleEncryptTest(BigInt("88234270445505063544773351946799499361"), BigInt("77632782935796824482769233326957714641"), iv=BigInt("154421366743392535228447486155557658462"))
    runSingleEncryptTest(BigInt("44380334624219522542253740501960632661"), BigInt("288791642284250204713661254870252284592"))
    runSingleEncryptTest(BigInt("44380334624219522542253740501960632661"), BigInt("316804242608174920769766559842210722072"), iv=BigInt("105457722456344753191157455023958534718"))
    runSingleEncryptTest(BigInt("139995748177119672660211662608055747183"), BigInt("130035906473209420777267489690463285980"))
    runSingleEncryptTest(BigInt("139995748177119672660211662608055747183"), BigInt("182331948215564093165882028255428454358"), iv=BigInt("79017840441416716113368962294071642964"))
    runSingleEncryptTest(BigInt("49722757544526738644221644134196854879"), BigInt("92544765029102526621803542895474635053"))
    runSingleEncryptTest(BigInt("49722757544526738644221644134196854879"), BigInt("323266700259871211996968417109190452543"), iv=BigInt("70923656147317493635232955284148475429"))
    runSingleEncryptTest(BigInt("90555183315759195534198719963960793178"), BigInt("51227518762036690891411822881444235903"))
    runSingleEncryptTest(BigInt("90555183315759195534198719963960793178"), BigInt("172129719962259346122394412644426318634"), iv=BigInt("54843380405372014107929802967280660325"))
    runSingleEncryptTest(BigInt("64048871207477721583765611841108652908"), BigInt("270848234941166011063223421627685661043"))
    runSingleEncryptTest(BigInt("64048871207477721583765611841108652908"), BigInt("315641162556587499119058310994474702631"), iv=BigInt("52121945375215471456261131422868724015"))
    runSingleEncryptTest(BigInt("46949443533834829242817821549180321345"), BigInt("278978698474589186165084397859027925842"))
    runSingleEncryptTest(BigInt("46949443533834829242817821549180321345"), BigInt("327439949334307999693273371630060955698"), iv=BigInt("48367227229216044282357240439047084118"))
    setKey(BigInt("145073710499889515903589391959220699715"))
    runSingleEncryptTest(BigInt("118558114086105424063693440916297108806"), BigInt("222766975056746085558710973013271295757"))
    runSingleEncryptTest(BigInt("118558114086105424063693440916297108806"), BigInt("52078724034952849958530049747220475935"), iv=BigInt("85587133704463767980526619383913868907"))
    runSingleEncryptTest(BigInt("101205132835282183969052089563508077114"), BigInt("128363551350568186318909603982967642124"))
    runSingleEncryptTest(BigInt("101205132835282183969052089563508077114"), BigInt("8183447390651277247852762455179559841"), iv=BigInt("48098222872682107829121686505805535325"))
    runSingleEncryptTest(BigInt("116106966899812963825848681334617035369"), BigInt("6013778424976673419758654963537349487"))
    runSingleEncryptTest(BigInt("116106966899812963825848681334617035369"), BigInt("64887112073690181376024549059090311328"), iv=BigInt("92096725522724656564618218217154619203"))
    runSingleEncryptTest(BigInt("116100435249681158838289428360128592701"), BigInt("272774020786214218748131961458905996775"))
    runSingleEncryptTest(BigInt("116100435249681158838289428360128592701"), BigInt("124048653057363919563270914853178509538"), iv=BigInt("119928291965217740601032504450291228719"))
    runSingleEncryptTest(BigInt("82902350419730534914869321416170874488"), BigInt("30673710023723521543571791893727533619"))
    runSingleEncryptTest(BigInt("82902350419730534914869321416170874488"), BigInt("153507428440932190115882450186970303575"), iv=BigInt("150650077426825027067962485045999839852"))
    runSingleEncryptTest(BigInt("49526543760498454127656415991227039085"), BigInt("230773182515415264192381251920383614323"))
    runSingleEncryptTest(BigInt("49526543760498454127656415991227039085"), BigInt("39629048708667529715152525111564446105"), iv=BigInt("160163667384592196205640250503507884153"))
    runSingleEncryptTest(BigInt("161382431126769941799710483810157821559"), BigInt("207009268736714707804890037218375941490"))
    runSingleEncryptTest(BigInt("161382431126769941799710483810157821559"), BigInt("16566468028243249000361720605538088778"), iv=BigInt("140026514137366742681009856404946890295"))
    runSingleEncryptTest(BigInt("66889284965837463591075609439180445986"), BigInt("36676335155222094588048373007685381439"))
    runSingleEncryptTest(BigInt("66889284965837463591075609439180445986"), BigInt("13409057115595487548819884135245807929"), iv=BigInt("154488525658936537837706605038640053100"))
    runSingleEncryptTest(BigInt("130831368252686802948992976561958058580"), BigInt("117837775701166844826421225832727675189"))
    runSingleEncryptTest(BigInt("130831368252686802948992976561958058580"), BigInt("211753058416579184094207760022265766269"), iv=BigInt("138408263804049034615517341636609921143"))
    runSingleEncryptTest(BigInt("52397664623499573511462614000227086910"), BigInt("247268737662119261364321410779108028625"))
    runSingleEncryptTest(BigInt("52397664623499573511462614000227086910"), BigInt("31648102336010827272570357957627325398"), iv=BigInt("149321988335800431316839071525097121624"))

    setKey(BigInt("77480659682196824781536209242280568617"))
    runSingleDecryptTest(BigInt("108168270634000394736752434854797242083"), BigInt("141123105032041655060716409566795293791"))
    runSingleDecryptTest(BigInt("183741596611713424932424710302674779678"), BigInt("141123105032041655060716409566795293791"), iv=BigInt("82999517049282736278697283449288677672"))
    runSingleDecryptTest(BigInt("300612637423229317006463393945750264978"), BigInt("53533723263096188494879905935507858290"))
    runSingleDecryptTest(BigInt("191269884928480092850775886794089116221"), BigInt("53533723263096188494879905935507858290"), iv=BigInt("114569600669659166774737151663344146729"))
    runSingleDecryptTest(BigInt("103522583274007989084648569150893738254"), BigInt("78732626654880918153396673645234369074"))
    runSingleDecryptTest(BigInt("285620521974381805374183171356809032743"), BigInt("78732626654880918153396673645234369074"), iv=BigInt("147981112317427754652321488608020016728"))
    runSingleDecryptTest(BigInt("193102151738919742469920448191206198811"), BigInt("138531862892119456316820873688573960762"))
    runSingleDecryptTest(BigInt("173577793028898773428655398731547059119"), BigInt("138531862892119456316820873688573960762"), iv=BigInt("68078054275351338050152113982098793760"))
    runSingleDecryptTest(BigInt("49706086182423641475700416514958935121"), BigInt("86919746956773577147522875398327975231"))

    setKey(BigInt("86827075270622593409819524343863859761"))
    runSingleEncryptTest(BigInt("58969592210743870063285156888865157723"), BigInt("34445959912195374720291194579163502738"))
    runSingleEncryptTest(BigInt("58969592210743870063285156888865157723"), BigInt("69130398036106899280699320475117573951"), iv=BigInt("113297811504676015438898247227970508370"))
    runSingleEncryptTest(BigInt("90965698820630213166994289669365519396"), BigInt("204326765483663107115405994780398329495"))
    runSingleEncryptTest(BigInt("90965698820630213166994289669365519396"), BigInt("321541266545999478803201861322376605213"), iv=BigInt("128094702975275155929937112909655730225"))
    runSingleEncryptTest(BigInt("74605240072561564204060370263150506580"), BigInt("114316182370891260659519907878684695684"))
    runSingleEncryptTest(BigInt("74605240072561564204060370263150506580"), BigInt("129416346144803868019166907674914641037"), iv=BigInt("164031622486103800548796609917051485256"))
    runSingleEncryptTest(BigInt("88234270445505063544773351946799499361"), BigInt("140819026982539376265949603485155741227"))
    runSingleEncryptTest(BigInt("88234270445505063544773351946799499361"), BigInt("77632782935796824482769233326957714641"), iv=BigInt("154421366743392535228447486155557658462"))
    runSingleEncryptTest(BigInt("44380334624219522542253740501960632661"), BigInt("288791642284250204713661254870252284592"))
    runSingleEncryptTest(BigInt("44380334624219522542253740501960632661"), BigInt("316804242608174920769766559842210722072"), iv=BigInt("105457722456344753191157455023958534718"))
    runSingleEncryptTest(BigInt("139995748177119672660211662608055747183"), BigInt("130035906473209420777267489690463285980"))

}
